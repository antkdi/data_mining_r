{
    "contents" : "require(\"dplyr\")\n\naa <- tbl_df(read.csv(\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/201501-201502/201501-201502.csv\",header=F)) # 1,259?? row\ncolnames(aa) <- c(\"rec_idx\",\"date\",\"page\",\"ref\")\n\n# ??Ã¼ À¥?Î±? ?? ???? Á¶È¸?? ????\naa_recruit_sub1 <- aa[grep(\"http://www.saramin.co.kr/recruit/RecruitBbsSearch.php[:?:]method=NL&code=bbs_recruit&mode=view&idx\",aa$page,invert=F),]\naa_recruit_sub2 <- aa[grep(\"http://www.saramin.co.kr/zf_user/recruit/recruit-view[:?:]idx=\",aa$page,invert=F),]\naa_recruit_sub3 <- aa[grep(\"http://www.saramin.co.kr/zf_user/recruit/view/idx/\",aa$page,invert=F),]\n\n\n# ??Ä¡?? ??Á¤\naa_recruit <- rbind(aa_recruit_sub1, aa_recruit_sub2, aa_recruit_sub3)\n\n\n# Á¤Á¦ ??Á¤\naa_recruit_2 <- aa_recruit[grep(\"&\",aa_recruit$date,invert=T),] #??Â¥?? url ?Ö´? ???? ??Á¦\naa_recruit_3 <- aa_recruit_2[grep(\"list\",aa_recruit_2$ref),] # ????Æ®???? ??Àº Á¶È¸???? ????(rollup ?Ð¼???)\naa_recruit_4 <- aa_recruit_3[grep(\"saramin.co.kr\",aa_recruit_3$ref),] # ???? ???????? ???????? ???ì¸¸ ????\naa_recruit_5 <- aa_recruit_4[grep(\"[0-9]\",aa_recruit_4$rec_idx),] # ???? idx ?? ???????Î°Í¸? ????\naa_recruit_6 <- aa_recruit_5[grep(\"apply\",aa_recruit_5$page,invert=T),] # ?Ô»????? ?????? ??Á¦\naa_recruit_7 <- aa_recruit_6[grep(\"s_com&searchWord=%\",aa_recruit_6$ref,invert=T),] # ????Æ® ?? ?Ë»??? ?? È¸???? ?Ë»? ??Á¦(rollup ?Ð¼???)\n\n# Á¤Á¦ ?? droplevels ?? ?ç¼³Á¤\naa_recruit_7$rec_idx <- droplevels(aa_recruit_7$rec_idx)\naa_recruit_7$date <- droplevels(aa_recruit_7$date)\naa_recruit_7$page <- droplevels(aa_recruit_7$page)\naa_recruit_7$ref <- droplevels(aa_recruit_7$ref)\n\nrm(list=c('aa_recruit_sub1','aa_recruit_sub2','aa_recruit_sub3','aa_recruit','aa_recruit_2','aa_recruit_3','aa_recruit_4','aa_recruit_5','aa_recruit_6'))\n\n\n###############rollup ?????? ????###############\n\n# ????, ??Á¾ ?Î±? ????\nrollup_area_WL <- aa_recruit_7[grep(\"t_ref=area_recruit&t_ref_content=generic\",aa_recruit_7$page),]\nrollup_job_WL <- aa_recruit_7[grep(\"t_ref=jobcategory_recruit&t_ref_content=generic\",aa_recruit_7$page),]\n\n\n# order ?? ???? Á¤???? ???? \nrollup_area_WL_sub_1 <- rollup_area_WL[grep(\"order\", rollup_area_WL$ref,invert=T),]\nrollup_area_WL_sub_2 <- rollup_area_WL[grep(\"order/MD\", rollup_area_WL$ref,invert=F),]\n\nrollup_job_WL_sub_1 <- rollup_job_WL[grep(\"order\", rollup_job_WL$ref,invert=T),]\nrollup_job_WL_sub_2 <- rollup_job_WL[grep(\"order/MD\", rollup_job_WL$ref,invert=F),]\n\nrollup_area_WL_final<- rbind(rollup_area_WL_sub_1,rollup_area_WL_sub_2)\nrollup_job_WL_final<- rbind(rollup_job_WL_sub_1,rollup_job_WL_sub_2)\n\nrm(list=c('rollup_area_WL_sub_1','rollup_area_WL_sub_2','rollup_job_WL_sub_1','rollup_job_WL_sub_2'))\n\n#write.csv(rollup_area_WL_final, \"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/201501-201502/rollup_area_WL_1??Á¤Á¦.csv\")\n#write.csv(rollup_job_WL_final, \"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/201501-201502/rollup_job_WL_1??Á¤Á¦.csv\")\n\n#rollup_area_WL_final<-read.csv( \"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/201501-201502/rollup_area_WL_1??Á¤Á¦.csv\")\n#rollup_job_WL_final<-read.csv( \"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/201501-201502/rollup_job_WL_1??Á¤Á¦.csv\")\n\narea_raw<-rollup_area_WL_final\njob_raw<-rollup_job_WL_final\n\n\n################################################\n\n\nrec_idx_2015 <- tbl_df(read.csv(\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/201501-201502/CSVFile_2015-06-15T10_39_19(1?? 1?? ???? rec_idx?? ?????Ï±?À§??).csv\"))\nrec_idx_2015 <- rec_idx_2015 %>% filter(closing_dt != \"\")\n\nrec_idx_2015$opening_dt_new <- as.POSIXct(rec_idx_2015$opening_dt)\nrec_idx_2015$closing_dt_new <- as.POSIXct(rec_idx_2015$closing_dt)\n\nrec_idx_0102<-rec_idx_2015[rec_idx_2015$opening_dt_new >= '2015-01-01',]\n\nrollup_area_WL_final_2 <- area_raw\nrollup_area_WL_final_2$rec_idx <- as.numeric(levels(rollup_area_WL_final_2$rec_idx))[rollup_area_WL_final_2$rec_idx]\n\nrollup_job_WL_final_2 <- job_raw\nrollup_job_WL_final_2$rec_idx <- as.numeric(levels(rollup_job_WL_final_2$rec_idx))[rollup_job_WL_final_2$rec_idx]\n\n\narea_raw_final_2 <- left_join(area_raw, rec_idx_0102)\njob_raw_final_2 <- left_join(job_raw, rec_idx_0102)\n\narea_recruit_sub <- area_raw_final_2[is.na(area_raw_final_2$closing_dt_new)==F,]\njob_recruit_sub <- job_raw_final_2[is.na(job_raw_final_2$closing_dt_new)==F,]\n\narea_recruit_sub <- area_recruit_sub %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% summarise(count=n()) %>% select(-count)\njob_recruit_sub <- job_recruit_sub %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% summarise(count=n()) %>% select(-count)\n\n\n\n\n\narea_raw_101000<-area_raw[grep(\"101[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_102000<-area_raw[grep(\"102[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_103000<-area_raw[grep(\"103[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_104000<-area_raw[grep(\"104[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_105000<-area_raw[grep(\"105[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_106000<-area_raw[grep(\"106[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_107000<-area_raw[grep(\"107[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_108000<-area_raw[grep(\"108[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_109000<-area_raw[grep(\"109[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_110000<-area_raw[grep(\"110[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_111000<-area_raw[grep(\"111[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_112000<-area_raw[grep(\"112[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_113000<-area_raw[grep(\"113[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_114000<-area_raw[grep(\"114[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_115000<-area_raw[grep(\"115[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_116000<-area_raw[grep(\"116[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_117000<-area_raw[grep(\"117[0-9][0-9][0-9]\",area_raw$ref),]\narea_raw_118000<-area_raw[grep(\"118[0-9][0-9][0-9]\",area_raw$ref),]\n\n\njob_raw_7C1 <-job_raw[grep(\"9%7C1\",job_raw$ref),]\njob_raw_7C2 <-job_raw[grep(\"9%7C2\",job_raw$ref),]\njob_raw_7C3 <-job_raw[grep(\"9%7C3\",job_raw$ref),]\njob_raw_7C4 <-job_raw[grep(\"9%7C4\",job_raw$ref),]\njob_raw_7C5 <-job_raw[grep(\"9%7C5\",job_raw$ref),]\njob_raw_7C6 <-job_raw[grep(\"9%7C6\",job_raw$ref),]\njob_raw_7C7 <-job_raw[grep(\"9%7C7\",job_raw$ref),]\njob_raw_7C8 <-job_raw[grep(\"9%7C8\",job_raw$ref),]\njob_raw_7C9 <-job_raw[grep(\"9%7C9\",job_raw$ref),]\njob_raw_7C10 <-job_raw[grep(\"9%7C10\",job_raw$ref),]\njob_raw_7C11 <-job_raw[grep(\"9%7C11\",job_raw$ref),]\njob_raw_7C12 <-job_raw[grep(\"9%7C12\",job_raw$ref),]\njob_raw_7C13 <-job_raw[grep(\"9%7C13\",job_raw$ref),]\n\n\n##############################################################################################################################\n# ??????(????, ??Á¾)                                                                                                         #\n#                                                                                                                            #\n#             ?Ã°??ëº°(???? 12?Ã°?, ?Ñ¾?) Á¶È¸?? ?? ?Ñ¾??â°£ Á¶È¸?? ????, ???? 12?Ã°? ???? ?Ñ¾? Á¶È¸?? ??À² ????             #                                                                                                                            #\n#                                                                                                                            #\n#      1. ???? ?????Ã°? data & Á¤Á¦ ?? 1depth ????À¸?? ?????? ????À» join                                                    #\n#      2. (diff = data_new - opening_dt_new) ?? ???Ï¿? Á¶È¸???? ?ß»??? ??Á¡ È®?? (diff<0?? ???Ì½? Á¦??)                      #\n#      3. ???????? ????(roll1), ???Äµ??? ????(roll2)?? ???? (???????? ????=?Ñ¾? 3??, ???Äµ??? ????=?Ñ¾? 2??)                 #\n#      4. ?Ñ¾? È¿?? ?Ð¼??? ?Ê¿??? ???? ????                                                                                  #\n#         ???? 12?Ã°? Á¶È¸??(h12), 24?Ã°?(h24), 36?Ã°?(h36), 48?Ã°?(h48), ??????(etc),                                       #\n#         ?Ñ¾? ?????? Á¶È¸??(rollup_total), ?Ñ¾? ?â°£?? ??Àº Á¶È¸?? ????(mean),                                              #\n#         ???? 12?Ã°? ???? ?Ñ¾??â°£ ??Àº Á¶È¸?? ??À²(rate)                                                                   #\n#                                                                                                                            #\n##############################################################################################################################\n\n##############################################################################################################################\n#                                                        ????(area)                                                          #\n##############################################################################################################################\n\n\narea_raw_101000_2<- left_join(area_raw_101000, area_recruit_sub )\n\narea_raw_101000_2$date_new <- as.POSIXct(area_raw_101000_2$date)\n\narea_raw_101000_2$diff <- (area_raw_101000_2$date_new - area_raw_101000_2$opening_dt_new)\narea_raw_101000_2 <- area_raw_101000_2 %>% filter(!(diff<0))\n\n##### ????, ???Äµ??? ???? ????\n\nas <-area_raw_101000_2$opening_dt_new\narea_raw_101000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_101000_roll2<- area_raw_101000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_101000_roll1<- area_raw_101000_2 %>% filter(dtparts<\"12:00:00\")\n\n##### ?Ñ¾? È¿?? ?Ð¼??? ?Ê¿??? ???? ????\n# roll 1\narea_raw_101000_roll1_1 <- area_raw_101000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_101000_roll1_h12 <- area_raw_101000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_101000_roll1_1 <- left_join(area_raw_101000_roll1_1, area_raw_101000_roll1_h12)\narea_raw_101000_roll1_h24 <- area_raw_101000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_101000_roll1_1 <- left_join(area_raw_101000_roll1_1, area_raw_101000_roll1_h24)\narea_raw_101000_roll1_h36 <- area_raw_101000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_101000_roll1_1 <- left_join(area_raw_101000_roll1_1, area_raw_101000_roll1_h36)\narea_raw_101000_roll1_h48 <- area_raw_101000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_101000_roll1_1 <- left_join(area_raw_101000_roll1_1, area_raw_101000_roll1_h48)\narea_raw_101000_roll1_etc <- area_raw_101000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_101000_roll1_1 <- left_join(area_raw_101000_roll1_1, area_raw_101000_roll1_etc)\n\narea_raw_101000_roll1_1$h12[is.na(area_raw_101000_roll1_1$h12)] <- 0\narea_raw_101000_roll1_1$h24[is.na(area_raw_101000_roll1_1$h24)] <- 0\narea_raw_101000_roll1_1$h36[is.na(area_raw_101000_roll1_1$h36)] <- 0\narea_raw_101000_roll1_1$h48[is.na(area_raw_101000_roll1_1$h48)] <- 0\narea_raw_101000_roll1_1$etc[is.na(area_raw_101000_roll1_1$etc)] <- 0\n\narea_raw_101000_roll1_h2436 <- area_raw_101000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_101000_roll1_1<-left_join(area_raw_101000_roll1_1, area_raw_101000_roll1_h2436)\narea_raw_101000_roll1_h3648 <- area_raw_101000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_101000_roll1_1<-left_join(area_raw_101000_roll1_1, area_raw_101000_roll1_h3648)\narea_raw_101000_roll1_h2448 <- area_raw_101000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_101000_roll1_1<-left_join(area_raw_101000_roll1_1, area_raw_101000_roll1_h2448)\n\narea_raw_101000_roll1_mean <- area_raw_101000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_101000_roll1_1<-left_join(area_raw_101000_roll1_1, area_raw_101000_roll1_mean)\n\narea_raw_101000_roll1_rate <- area_raw_101000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_101000_roll1_1<-left_join(area_raw_101000_roll1_1, area_raw_101000_roll1_rate)\n\narea_raw_101000_roll1_1$rate[is.nan(area_raw_101000_roll1_1$rate) | is.infinite(area_raw_101000_roll1_1$rate)] <- 0\n\n\narea_raw_101000_roll1_opening<-area_raw_101000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new,closing_dt_new)\n\narea_raw_101000_roll1_final <- left_join(area_raw_101000_roll1_opening, area_raw_101000_roll1_1)\narea_raw_101000_roll1_final<-unique(area_raw_101000_roll1_final)\n\nrm(list=c('area_raw_101000_roll1_1','area_raw_101000_roll1_h12','area_raw_101000_roll1_h24','area_raw_101000_roll1_h36','area_raw_101000_roll1_h48','area_raw_101000_roll1_h2436','area_raw_101000_roll1_h3648','area_raw_101000_roll1_h2448',\n          'area_raw_101000_roll1_mean','area_raw_101000_roll1_rate','area_raw_101000_roll1_opening'))\n\nwrite.csv(area_raw_101000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_101000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_101000_roll2_1 <- area_raw_101000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n()) \n\narea_raw_101000_roll2_h12 <- area_raw_101000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_101000_roll2_1 <- left_join(area_raw_101000_roll2_1, area_raw_101000_roll2_h12)\narea_raw_101000_roll2_h24 <- area_raw_101000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_101000_roll2_1 <- left_join(area_raw_101000_roll2_1, area_raw_101000_roll2_h24)\narea_raw_101000_roll2_h36 <- area_raw_101000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_101000_roll2_1 <- left_join(area_raw_101000_roll2_1, area_raw_101000_roll2_h36)\narea_raw_101000_roll2_h48 <- area_raw_101000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_101000_roll2_1 <- left_join(area_raw_101000_roll2_1, area_raw_101000_roll2_h48)\narea_raw_101000_roll2_etc <- area_raw_101000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_101000_roll2_1 <- left_join(area_raw_101000_roll2_1, area_raw_101000_roll2_etc)\n\narea_raw_101000_roll2_1$h12[is.na(area_raw_101000_roll2_1$h12)] <- 0\narea_raw_101000_roll2_1$h24[is.na(area_raw_101000_roll2_1$h24)] <- 0\narea_raw_101000_roll2_1$h36[is.na(area_raw_101000_roll2_1$h36)] <- 0\narea_raw_101000_roll2_1$h48[is.na(area_raw_101000_roll2_1$h48)] <- 0\narea_raw_101000_roll2_1$etc[is.na(area_raw_101000_roll2_1$etc)] <- 0\n\narea_raw_101000_roll2_h2436 <- area_raw_101000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_101000_roll2_1<-left_join(area_raw_101000_roll2_1, area_raw_101000_roll2_h2436)\narea_raw_101000_roll2_h3648 <- area_raw_101000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_101000_roll2_1<-left_join(area_raw_101000_roll2_1, area_raw_101000_roll2_h3648)\narea_raw_101000_roll2_h2448 <- area_raw_101000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_101000_roll2_1<-left_join(area_raw_101000_roll2_1, area_raw_101000_roll2_h2448)\n\narea_raw_101000_roll2_mean <- area_raw_101000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_101000_roll2_1<-left_join(area_raw_101000_roll2_1, area_raw_101000_roll2_mean)\n\narea_raw_101000_roll2_rate <- area_raw_101000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_101000_roll2_1<-left_join(area_raw_101000_roll2_1, area_raw_101000_roll2_rate)\n\narea_raw_101000_roll2_1$rate[is.nan(area_raw_101000_roll2_1$rate) | is.infinite(area_raw_101000_roll2_1$rate)] <- 0\n\narea_raw_101000_roll2_opening<-area_raw_101000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_101000_roll2_final <- left_join(area_raw_101000_roll2_opening, area_raw_101000_roll2_1)\narea_raw_101000_roll2_final<-unique(area_raw_101000_roll2_final)\n\nrm(list=c('area_raw_101000_roll2_1','area_raw_101000_roll2_h12','area_raw_101000_roll2_h24','area_raw_101000_roll2_h36','area_raw_101000_roll2_h48','area_raw_101000_roll2_h2436','area_raw_101000_roll2_h3648','area_raw_101000_roll2_h2448',\n          'area_raw_101000_roll2_mean','area_raw_101000_roll2_rate','area_raw_101000_roll2_opening'))\n\nwrite.csv(area_raw_101000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_101000_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\narea_raw_102000_2<- left_join(area_raw_102000, area_recruit_sub)\n\narea_raw_102000_2$date_new <- as.POSIXct(area_raw_102000_2$date)\n\narea_raw_102000_2$diff <- (area_raw_102000_2$date_new - area_raw_102000_2$opening_dt_new)\narea_raw_102000_2 <- area_raw_102000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_102000_2$opening_dt_new\narea_raw_102000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_102000_roll2<- area_raw_102000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_102000_roll1<- area_raw_102000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_102000_roll1_1 <- area_raw_102000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_102000_roll1_h12 <- area_raw_102000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_102000_roll1_1 <- left_join(area_raw_102000_roll1_1, area_raw_102000_roll1_h12)\narea_raw_102000_roll1_h24 <- area_raw_102000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_102000_roll1_1 <- left_join(area_raw_102000_roll1_1, area_raw_102000_roll1_h24)\narea_raw_102000_roll1_h36 <- area_raw_102000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_102000_roll1_1 <- left_join(area_raw_102000_roll1_1, area_raw_102000_roll1_h36)\narea_raw_102000_roll1_h48 <- area_raw_102000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_102000_roll1_1 <- left_join(area_raw_102000_roll1_1, area_raw_102000_roll1_h48)\narea_raw_102000_roll1_etc <- area_raw_102000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_102000_roll1_1 <- left_join(area_raw_102000_roll1_1, area_raw_102000_roll1_etc)\n\narea_raw_102000_roll1_1$h12[is.na(area_raw_102000_roll1_1$h12)] <- 0\narea_raw_102000_roll1_1$h24[is.na(area_raw_102000_roll1_1$h24)] <- 0\narea_raw_102000_roll1_1$h36[is.na(area_raw_102000_roll1_1$h36)] <- 0\narea_raw_102000_roll1_1$h48[is.na(area_raw_102000_roll1_1$h48)] <- 0\narea_raw_102000_roll1_1$etc[is.na(area_raw_102000_roll1_1$etc)] <- 0\n\narea_raw_102000_roll1_h2436 <- area_raw_102000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_102000_roll1_1<-left_join(area_raw_102000_roll1_1, area_raw_102000_roll1_h2436)\narea_raw_102000_roll1_h3648 <- area_raw_102000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_102000_roll1_1<-left_join(area_raw_102000_roll1_1, area_raw_102000_roll1_h3648)\narea_raw_102000_roll1_h2448 <- area_raw_102000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_102000_roll1_1<-left_join(area_raw_102000_roll1_1, area_raw_102000_roll1_h2448)\n\narea_raw_102000_roll1_mean <- area_raw_102000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_102000_roll1_1<-left_join(area_raw_102000_roll1_1, area_raw_102000_roll1_mean)\n\narea_raw_102000_roll1_rate <- area_raw_102000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_102000_roll1_1<-left_join(area_raw_102000_roll1_1, area_raw_102000_roll1_rate)\n\narea_raw_102000_roll1_1$rate[is.nan(area_raw_102000_roll1_1$rate) | is.infinite(area_raw_102000_roll1_1$rate)] <- 0\n\n\narea_raw_102000_roll1_opening<-area_raw_102000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_102000_roll1_final <- left_join(area_raw_102000_roll1_opening, area_raw_102000_roll1_1)\narea_raw_102000_roll1_final<-unique(area_raw_102000_roll1_final)\n\nrm(list=c('area_raw_102000_roll1_1','area_raw_102000_roll1_h12','area_raw_102000_roll1_h24','area_raw_102000_roll1_h36','area_raw_102000_roll1_h48','area_raw_102000_roll1_h2436','area_raw_102000_roll1_h3648','area_raw_102000_roll1_h2448',\n          'area_raw_102000_roll1_mean','area_raw_102000_roll1_rate','area_raw_102000_roll1_opening'))\n\nwrite.csv(area_raw_102000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_102000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_102000_roll2_1 <- area_raw_102000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n()) \n\narea_raw_102000_roll2_h12 <- area_raw_102000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_102000_roll2_1 <- left_join(area_raw_102000_roll2_1, area_raw_102000_roll2_h12)\narea_raw_102000_roll2_h24 <- area_raw_102000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_102000_roll2_1 <- left_join(area_raw_102000_roll2_1, area_raw_102000_roll2_h24)\narea_raw_102000_roll2_h36 <- area_raw_102000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_102000_roll2_1 <- left_join(area_raw_102000_roll2_1, area_raw_102000_roll2_h36)\narea_raw_102000_roll2_h48 <- area_raw_102000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_102000_roll2_1 <- left_join(area_raw_102000_roll2_1, area_raw_102000_roll2_h48)\narea_raw_102000_roll2_etc <- area_raw_102000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_102000_roll2_1 <- left_join(area_raw_102000_roll2_1, area_raw_102000_roll2_etc)\n\narea_raw_102000_roll2_1$h12[is.na(area_raw_102000_roll2_1$h12)] <- 0\narea_raw_102000_roll2_1$h24[is.na(area_raw_102000_roll2_1$h24)] <- 0\narea_raw_102000_roll2_1$h36[is.na(area_raw_102000_roll2_1$h36)] <- 0\narea_raw_102000_roll2_1$h48[is.na(area_raw_102000_roll2_1$h48)] <- 0\narea_raw_102000_roll2_1$etc[is.na(area_raw_102000_roll2_1$etc)] <- 0\n\narea_raw_102000_roll2_h2436 <- area_raw_102000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_102000_roll2_1<-left_join(area_raw_102000_roll2_1, area_raw_102000_roll2_h2436)\narea_raw_102000_roll2_h3648 <- area_raw_102000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_102000_roll2_1<-left_join(area_raw_102000_roll2_1, area_raw_102000_roll2_h3648)\narea_raw_102000_roll2_h2448 <- area_raw_102000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_102000_roll2_1<-left_join(area_raw_102000_roll2_1, area_raw_102000_roll2_h2448)\n\narea_raw_102000_roll2_mean <- area_raw_102000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_102000_roll2_1<-left_join(area_raw_102000_roll2_1, area_raw_102000_roll2_mean)\n\narea_raw_102000_roll2_rate <- area_raw_102000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_102000_roll2_1<-left_join(area_raw_102000_roll2_1, area_raw_102000_roll2_rate)\n\narea_raw_102000_roll2_1$rate[is.nan(area_raw_102000_roll2_1$rate) | is.infinite(area_raw_102000_roll2_1$rate)] <- 0\n\narea_raw_102000_roll2_opening<-area_raw_102000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_102000_roll2_final <- left_join(area_raw_102000_roll2_opening, area_raw_102000_roll2_1)\narea_raw_102000_roll2_final<-unique(area_raw_102000_roll2_final)\n\nrm(list=c('area_raw_102000_roll2_1','area_raw_102000_roll2_h12','area_raw_102000_roll2_h24','area_raw_102000_roll2_h36','area_raw_102000_roll2_h48','area_raw_102000_roll2_h2436','area_raw_102000_roll2_h3648','area_raw_102000_roll2_h2448',\n          'area_raw_102000_roll2_mean','area_raw_102000_roll2_rate','area_raw_102000_roll2_opening'))\n\n\nwrite.csv(area_raw_102000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_102000_roll2_final.csv\")     \n\n\n##############################################################################################################################\n\narea_raw_103000_2<- left_join(area_raw_103000, area_recruit_sub)\n\narea_raw_103000_2$date_new <- as.POSIXct(area_raw_103000_2$date)\n\narea_raw_103000_2$diff <- (area_raw_103000_2$date_new - area_raw_103000_2$opening_dt_new)*60\narea_raw_103000_2 <- area_raw_103000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_103000_2$opening_dt_new\narea_raw_103000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_103000_roll2<- area_raw_103000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_103000_roll1<- area_raw_103000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_103000_roll1_1 <- area_raw_103000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_103000_roll1_h12 <- area_raw_103000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_103000_roll1_1 <- left_join(area_raw_103000_roll1_1, area_raw_103000_roll1_h12)\narea_raw_103000_roll1_h24 <- area_raw_103000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_103000_roll1_1 <- left_join(area_raw_103000_roll1_1, area_raw_103000_roll1_h24)\narea_raw_103000_roll1_h36 <- area_raw_103000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_103000_roll1_1 <- left_join(area_raw_103000_roll1_1, area_raw_103000_roll1_h36)\narea_raw_103000_roll1_h48 <- area_raw_103000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_103000_roll1_1 <- left_join(area_raw_103000_roll1_1, area_raw_103000_roll1_h48)\narea_raw_103000_roll1_etc <- area_raw_103000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_103000_roll1_1 <- left_join(area_raw_103000_roll1_1, area_raw_103000_roll1_etc)\n\narea_raw_103000_roll1_1$h12[is.na(area_raw_103000_roll1_1$h12)] <- 0\narea_raw_103000_roll1_1$h24[is.na(area_raw_103000_roll1_1$h24)] <- 0\narea_raw_103000_roll1_1$h36[is.na(area_raw_103000_roll1_1$h36)] <- 0\narea_raw_103000_roll1_1$h48[is.na(area_raw_103000_roll1_1$h48)] <- 0\narea_raw_103000_roll1_1$etc[is.na(area_raw_103000_roll1_1$etc)] <- 0\n\narea_raw_103000_roll1_h2436 <- area_raw_103000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_103000_roll1_1<-left_join(area_raw_103000_roll1_1, area_raw_103000_roll1_h2436)\narea_raw_103000_roll1_h3648 <- area_raw_103000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_103000_roll1_1<-left_join(area_raw_103000_roll1_1, area_raw_103000_roll1_h3648)\narea_raw_103000_roll1_h2448 <- area_raw_103000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_103000_roll1_1<-left_join(area_raw_103000_roll1_1, area_raw_103000_roll1_h2448)\n\narea_raw_103000_roll1_mean <- area_raw_103000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_103000_roll1_1<-left_join(area_raw_103000_roll1_1, area_raw_103000_roll1_mean)\n\narea_raw_103000_roll1_rate <- area_raw_103000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_103000_roll1_1<-left_join(area_raw_103000_roll1_1, area_raw_103000_roll1_rate)\n\narea_raw_103000_roll1_1$rate[is.nan(area_raw_103000_roll1_1$rate) | is.infinite(area_raw_103000_roll1_1$rate)] <- 0\n\n\narea_raw_103000_roll1_opening<-area_raw_103000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_103000_roll1_final <- left_join(area_raw_103000_roll1_opening, area_raw_103000_roll1_1)\narea_raw_103000_roll1_final<-unique(area_raw_103000_roll1_final)\n\nrm(list=c('area_raw_103000_roll1_1','area_raw_103000_roll1_h12','area_raw_103000_roll1_h24','area_raw_103000_roll1_h36','area_raw_103000_roll1_h48','area_raw_103000_roll1_h2436','area_raw_103000_roll1_h3648','area_raw_103000_roll1_h2448',\n          'area_raw_103000_roll1_mean','area_raw_103000_roll1_rate','area_raw_103000_roll1_opening'))\n\nwrite.csv(area_raw_103000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_103000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_103000_roll2_1 <- area_raw_103000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_103000_roll2_h12 <- area_raw_103000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_103000_roll2_1 <- left_join(area_raw_103000_roll2_1, area_raw_103000_roll2_h12)\narea_raw_103000_roll2_h24 <- area_raw_103000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_103000_roll2_1 <- left_join(area_raw_103000_roll2_1, area_raw_103000_roll2_h24)\narea_raw_103000_roll2_h36 <- area_raw_103000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_103000_roll2_1 <- left_join(area_raw_103000_roll2_1, area_raw_103000_roll2_h36)\narea_raw_103000_roll2_h48 <- area_raw_103000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_103000_roll2_1 <- left_join(area_raw_103000_roll2_1, area_raw_103000_roll2_h48)\narea_raw_103000_roll2_etc <- area_raw_103000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_103000_roll2_1 <- left_join(area_raw_103000_roll2_1, area_raw_103000_roll2_etc)\n\narea_raw_103000_roll2_1$h12[is.na(area_raw_103000_roll2_1$h12)] <- 0\narea_raw_103000_roll2_1$h24[is.na(area_raw_103000_roll2_1$h24)] <- 0\narea_raw_103000_roll2_1$h36[is.na(area_raw_103000_roll2_1$h36)] <- 0\narea_raw_103000_roll2_1$h48[is.na(area_raw_103000_roll2_1$h48)] <- 0\narea_raw_103000_roll2_1$etc[is.na(area_raw_103000_roll2_1$etc)] <- 0\n\narea_raw_103000_roll2_h2436 <- area_raw_103000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_103000_roll2_1<-left_join(area_raw_103000_roll2_1, area_raw_103000_roll2_h2436)\narea_raw_103000_roll2_h3648 <- area_raw_103000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_103000_roll2_1<-left_join(area_raw_103000_roll2_1, area_raw_103000_roll2_h3648)\narea_raw_103000_roll2_h2448 <- area_raw_103000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_103000_roll2_1<-left_join(area_raw_103000_roll2_1, area_raw_103000_roll2_h2448)\n\narea_raw_103000_roll2_mean <- area_raw_103000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_103000_roll2_1<-left_join(area_raw_103000_roll2_1, area_raw_103000_roll2_mean)\n\narea_raw_103000_roll2_rate <- area_raw_103000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_103000_roll2_1<-left_join(area_raw_103000_roll2_1, area_raw_103000_roll2_rate)\n\narea_raw_103000_roll2_1$rate[is.nan(area_raw_103000_roll2_1$rate) | is.infinite(area_raw_103000_roll2_1$rate)] <- 0\n\narea_raw_103000_roll2_opening<-area_raw_103000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_103000_roll2_final <- left_join(area_raw_103000_roll2_opening, area_raw_103000_roll2_1)\narea_raw_103000_roll2_final<-unique(area_raw_103000_roll2_final)\n\nrm(list=c('area_raw_103000_roll2_1','area_raw_103000_roll2_h12','area_raw_103000_roll2_h24','area_raw_103000_roll2_h36','area_raw_103000_roll2_h48','area_raw_103000_roll2_h2436','area_raw_103000_roll2_h3648','area_raw_103000_roll2_h2448',\n          'area_raw_103000_roll2_mean','area_raw_103000_roll2_rate','area_raw_103000_roll2_opening'))\n\nwrite.csv(area_raw_103000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_103000_roll2_final.csv\")     \n\n\n##############################################################################################################################\n\n\narea_raw_104000_2<- left_join(area_raw_104000, area_recruit_sub)\n\narea_raw_104000_2$date_new <- as.POSIXct(area_raw_104000_2$date)\n\narea_raw_104000_2$diff <- (area_raw_104000_2$date_new - area_raw_104000_2$opening_dt_new)\narea_raw_104000_2 <- area_raw_104000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_104000_2$opening_dt_new\narea_raw_104000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_104000_roll2<- area_raw_104000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_104000_roll1<- area_raw_104000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_104000_roll1_1 <- area_raw_104000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_104000_roll1_h12 <- area_raw_104000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_104000_roll1_1 <- left_join(area_raw_104000_roll1_1, area_raw_104000_roll1_h12)\narea_raw_104000_roll1_h24 <- area_raw_104000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_104000_roll1_1 <- left_join(area_raw_104000_roll1_1, area_raw_104000_roll1_h24)\narea_raw_104000_roll1_h36 <- area_raw_104000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_104000_roll1_1 <- left_join(area_raw_104000_roll1_1, area_raw_104000_roll1_h36)\narea_raw_104000_roll1_h48 <- area_raw_104000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_104000_roll1_1 <- left_join(area_raw_104000_roll1_1, area_raw_104000_roll1_h48)\narea_raw_104000_roll1_etc <- area_raw_104000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_104000_roll1_1 <- left_join(area_raw_104000_roll1_1, area_raw_104000_roll1_etc)\n\narea_raw_104000_roll1_1$h12[is.na(area_raw_104000_roll1_1$h12)] <- 0\narea_raw_104000_roll1_1$h24[is.na(area_raw_104000_roll1_1$h24)] <- 0\narea_raw_104000_roll1_1$h36[is.na(area_raw_104000_roll1_1$h36)] <- 0\narea_raw_104000_roll1_1$h48[is.na(area_raw_104000_roll1_1$h48)] <- 0\narea_raw_104000_roll1_1$etc[is.na(area_raw_104000_roll1_1$etc)] <- 0\n\narea_raw_104000_roll1_h2436 <- area_raw_104000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_104000_roll1_1<-left_join(area_raw_104000_roll1_1, area_raw_104000_roll1_h2436)\narea_raw_104000_roll1_h3648 <- area_raw_104000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_104000_roll1_1<-left_join(area_raw_104000_roll1_1, area_raw_104000_roll1_h3648)\narea_raw_104000_roll1_h2448 <- area_raw_104000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_104000_roll1_1<-left_join(area_raw_104000_roll1_1, area_raw_104000_roll1_h2448)\n\narea_raw_104000_roll1_mean <- area_raw_104000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_104000_roll1_1<-left_join(area_raw_104000_roll1_1, area_raw_104000_roll1_mean)\n\narea_raw_104000_roll1_rate <- area_raw_104000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_104000_roll1_1<-left_join(area_raw_104000_roll1_1, area_raw_104000_roll1_rate)\n\narea_raw_104000_roll1_1$rate[is.nan(area_raw_104000_roll1_1$rate) | is.infinite(area_raw_104000_roll1_1$rate)] <- 0\n\n\narea_raw_104000_roll1_opening<-area_raw_104000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_104000_roll1_final <- left_join(area_raw_104000_roll1_opening, area_raw_104000_roll1_1)\narea_raw_104000_roll1_final<-unique(area_raw_104000_roll1_final)\n\nrm(list=c('area_raw_104000_roll1_1','area_raw_104000_roll1_h12','area_raw_104000_roll1_h24','area_raw_104000_roll1_h36','area_raw_104000_roll1_h48','area_raw_104000_roll1_h2436','area_raw_104000_roll1_h3648','area_raw_104000_roll1_h2448',\n          'area_raw_104000_roll1_mean','area_raw_104000_roll1_rate','area_raw_104000_roll1_opening'))\n\nwrite.csv(area_raw_104000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_104000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_104000_roll2_1 <- area_raw_104000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_104000_roll2_h12 <- area_raw_104000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_104000_roll2_1 <- left_join(area_raw_104000_roll2_1, area_raw_104000_roll2_h12)\narea_raw_104000_roll2_h24 <- area_raw_104000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_104000_roll2_1 <- left_join(area_raw_104000_roll2_1, area_raw_104000_roll2_h24)\narea_raw_104000_roll2_h36 <- area_raw_104000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_104000_roll2_1 <- left_join(area_raw_104000_roll2_1, area_raw_104000_roll2_h36)\narea_raw_104000_roll2_h48 <- area_raw_104000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_104000_roll2_1 <- left_join(area_raw_104000_roll2_1, area_raw_104000_roll2_h48)\narea_raw_104000_roll2_etc <- area_raw_104000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_104000_roll2_1 <- left_join(area_raw_104000_roll2_1, area_raw_104000_roll2_etc)\n\narea_raw_104000_roll2_1$h12[is.na(area_raw_104000_roll2_1$h12)] <- 0\narea_raw_104000_roll2_1$h24[is.na(area_raw_104000_roll2_1$h24)] <- 0\narea_raw_104000_roll2_1$h36[is.na(area_raw_104000_roll2_1$h36)] <- 0\narea_raw_104000_roll2_1$h48[is.na(area_raw_104000_roll2_1$h48)] <- 0\narea_raw_104000_roll2_1$etc[is.na(area_raw_104000_roll2_1$etc)] <- 0\n\narea_raw_104000_roll2_h2436 <- area_raw_104000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_104000_roll2_1<-left_join(area_raw_104000_roll2_1, area_raw_104000_roll2_h2436)\narea_raw_104000_roll2_h3648 <- area_raw_104000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_104000_roll2_1<-left_join(area_raw_104000_roll2_1, area_raw_104000_roll2_h3648)\narea_raw_104000_roll2_h2448 <- area_raw_104000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_104000_roll2_1<-left_join(area_raw_104000_roll2_1, area_raw_104000_roll2_h2448)\n\narea_raw_104000_roll2_mean <- area_raw_104000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_104000_roll2_1<-left_join(area_raw_104000_roll2_1, area_raw_104000_roll2_mean)\n\narea_raw_104000_roll2_rate <- area_raw_104000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_104000_roll2_1<-left_join(area_raw_104000_roll2_1, area_raw_104000_roll2_rate)\n\narea_raw_104000_roll2_1$rate[is.nan(area_raw_104000_roll2_1$rate) | is.infinite(area_raw_104000_roll2_1$rate)] <- 0\n\narea_raw_104000_roll2_opening<-area_raw_104000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_104000_roll2_final <- left_join(area_raw_104000_roll2_opening, area_raw_104000_roll2_1)\narea_raw_104000_roll2_final<-unique(area_raw_104000_roll2_final)\n\nrm(list=c('area_raw_104000_roll2_1','area_raw_104000_roll2_h12','area_raw_104000_roll2_h24','area_raw_104000_roll2_h36','area_raw_104000_roll2_h48','area_raw_104000_roll2_h2436','area_raw_104000_roll2_h3648','area_raw_104000_roll2_h2448',\n          'area_raw_104000_roll2_mean','area_raw_104000_roll2_rate','area_raw_104000_roll2_opening'))\n\nwrite.csv(area_raw_104000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_104000_roll2_final.csv\")     \n\n##############################################################################################################################\n\narea_raw_105000_2<- left_join(area_raw_105000, area_recruit_sub)\n\narea_raw_105000_2$date_new <- as.POSIXct(area_raw_105000_2$date)\n\narea_raw_105000_2$diff <- (area_raw_105000_2$date_new - area_raw_105000_2$opening_dt_new)\narea_raw_105000_2 <- area_raw_105000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_105000_2$opening_dt_new\narea_raw_105000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_105000_roll2<- area_raw_105000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_105000_roll1<- area_raw_105000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_105000_roll1_1 <- area_raw_105000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_105000_roll1_h12 <- area_raw_105000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_105000_roll1_1 <- left_join(area_raw_105000_roll1_1, area_raw_105000_roll1_h12)\narea_raw_105000_roll1_h24 <- area_raw_105000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_105000_roll1_1 <- left_join(area_raw_105000_roll1_1, area_raw_105000_roll1_h24)\narea_raw_105000_roll1_h36 <- area_raw_105000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_105000_roll1_1 <- left_join(area_raw_105000_roll1_1, area_raw_105000_roll1_h36)\narea_raw_105000_roll1_h48 <- area_raw_105000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_105000_roll1_1 <- left_join(area_raw_105000_roll1_1, area_raw_105000_roll1_h48)\narea_raw_105000_roll1_etc <- area_raw_105000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_105000_roll1_1 <- left_join(area_raw_105000_roll1_1, area_raw_105000_roll1_etc)\n\narea_raw_105000_roll1_1$h12[is.na(area_raw_105000_roll1_1$h12)] <- 0\narea_raw_105000_roll1_1$h24[is.na(area_raw_105000_roll1_1$h24)] <- 0\narea_raw_105000_roll1_1$h36[is.na(area_raw_105000_roll1_1$h36)] <- 0\narea_raw_105000_roll1_1$h48[is.na(area_raw_105000_roll1_1$h48)] <- 0\narea_raw_105000_roll1_1$etc[is.na(area_raw_105000_roll1_1$etc)] <- 0\n\narea_raw_105000_roll1_h2436 <- area_raw_105000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_105000_roll1_1<-left_join(area_raw_105000_roll1_1, area_raw_105000_roll1_h2436)\narea_raw_105000_roll1_h3648 <- area_raw_105000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_105000_roll1_1<-left_join(area_raw_105000_roll1_1, area_raw_105000_roll1_h3648)\narea_raw_105000_roll1_h2448 <- area_raw_105000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_105000_roll1_1<-left_join(area_raw_105000_roll1_1, area_raw_105000_roll1_h2448)\n\narea_raw_105000_roll1_mean <- area_raw_105000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_105000_roll1_1<-left_join(area_raw_105000_roll1_1, area_raw_105000_roll1_mean)\n\narea_raw_105000_roll1_rate <- area_raw_105000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_105000_roll1_1<-left_join(area_raw_105000_roll1_1, area_raw_105000_roll1_rate)\n\narea_raw_105000_roll1_1$rate[is.nan(area_raw_105000_roll1_1$rate) | is.infinite(area_raw_105000_roll1_1$rate)] <- 0\n\n\narea_raw_105000_roll1_opening<-area_raw_105000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_105000_roll1_final <- left_join(area_raw_105000_roll1_opening, area_raw_105000_roll1_1)\narea_raw_105000_roll1_final<-unique(area_raw_105000_roll1_final)\n\nrm(list=c('area_raw_105000_roll1_1','area_raw_105000_roll1_h12','area_raw_105000_roll1_h24','area_raw_105000_roll1_h36','area_raw_105000_roll1_h48','area_raw_105000_roll1_h2436','area_raw_105000_roll1_h3648','area_raw_105000_roll1_h2448',\n          'area_raw_105000_roll1_mean','area_raw_105000_roll1_rate','area_raw_105000_roll1_opening'))\n\nwrite.csv(area_raw_105000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_105000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_105000_roll2_1 <- area_raw_105000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_105000_roll2_h12 <- area_raw_105000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_105000_roll2_1 <- left_join(area_raw_105000_roll2_1, area_raw_105000_roll2_h12)\narea_raw_105000_roll2_h24 <- area_raw_105000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_105000_roll2_1 <- left_join(area_raw_105000_roll2_1, area_raw_105000_roll2_h24)\narea_raw_105000_roll2_h36 <- area_raw_105000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_105000_roll2_1 <- left_join(area_raw_105000_roll2_1, area_raw_105000_roll2_h36)\narea_raw_105000_roll2_h48 <- area_raw_105000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_105000_roll2_1 <- left_join(area_raw_105000_roll2_1, area_raw_105000_roll2_h48)\narea_raw_105000_roll2_etc <- area_raw_105000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_105000_roll2_1 <- left_join(area_raw_105000_roll2_1, area_raw_105000_roll2_etc)\n\n\narea_raw_105000_roll2_1$h12[is.na(area_raw_105000_roll2_1$h12)] <- 0\narea_raw_105000_roll2_1$h24[is.na(area_raw_105000_roll2_1$h24)] <- 0\narea_raw_105000_roll2_1$h36[is.na(area_raw_105000_roll2_1$h36)] <- 0\narea_raw_105000_roll2_1$h48[is.na(area_raw_105000_roll2_1$h48)] <- 0\narea_raw_105000_roll2_1$etc[is.na(area_raw_105000_roll2_1$etc)] <- 0\n\narea_raw_105000_roll2_h2436 <- area_raw_105000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_105000_roll2_1<-left_join(area_raw_105000_roll2_1, area_raw_105000_roll2_h2436)\narea_raw_105000_roll2_h3648 <- area_raw_105000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_105000_roll2_1<-left_join(area_raw_105000_roll2_1, area_raw_105000_roll2_h3648)\narea_raw_105000_roll2_h2448 <- area_raw_105000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_105000_roll2_1<-left_join(area_raw_105000_roll2_1, area_raw_105000_roll2_h2448)\n\narea_raw_105000_roll2_mean <- area_raw_105000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_105000_roll2_1<-left_join(area_raw_105000_roll2_1, area_raw_105000_roll2_mean)\n\narea_raw_105000_roll2_rate <- area_raw_105000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_105000_roll2_1<-left_join(area_raw_105000_roll2_1, area_raw_105000_roll2_rate)\n\narea_raw_105000_roll2_1$rate[is.nan(area_raw_105000_roll2_1$rate) | is.infinite(area_raw_105000_roll2_1$rate)] <- 0\n\narea_raw_105000_roll2_opening<-area_raw_105000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_105000_roll2_final <- left_join(area_raw_105000_roll2_opening, area_raw_105000_roll2_1)\narea_raw_105000_roll2_final<-unique(area_raw_105000_roll2_final)\n\nrm(list=c('area_raw_105000_roll2_1','area_raw_105000_roll2_h12','area_raw_105000_roll2_h24','area_raw_105000_roll2_h36','area_raw_105000_roll2_h48','area_raw_105000_roll2_h2436','area_raw_105000_roll2_h3648','area_raw_105000_roll2_h2448',\n          'area_raw_105000_roll2_mean','area_raw_105000_roll2_rate','area_raw_105000_roll2_opening'))\n\nwrite.csv(area_raw_105000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_105000_roll2_final.csv\")     \n\n##############################################################################################################################\n\narea_raw_106000_2<- left_join(area_raw_106000, area_recruit_sub)\n\narea_raw_106000_2$date_new <- as.POSIXct(area_raw_106000_2$date)\n\narea_raw_106000_2$diff <- (area_raw_106000_2$date_new - area_raw_106000_2$opening_dt_new)\narea_raw_106000_2 <- area_raw_106000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_106000_2$opening_dt_new\narea_raw_106000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_106000_roll2<- area_raw_106000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_106000_roll1<- area_raw_106000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_106000_roll1_1 <- area_raw_106000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_106000_roll1_h12 <- area_raw_106000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_106000_roll1_1 <- left_join(area_raw_106000_roll1_1, area_raw_106000_roll1_h12)\narea_raw_106000_roll1_h24 <- area_raw_106000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_106000_roll1_1 <- left_join(area_raw_106000_roll1_1, area_raw_106000_roll1_h24)\narea_raw_106000_roll1_h36 <- area_raw_106000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_106000_roll1_1 <- left_join(area_raw_106000_roll1_1, area_raw_106000_roll1_h36)\narea_raw_106000_roll1_h48 <- area_raw_106000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_106000_roll1_1 <- left_join(area_raw_106000_roll1_1, area_raw_106000_roll1_h48)\narea_raw_106000_roll1_etc <- area_raw_106000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_106000_roll1_1 <- left_join(area_raw_106000_roll1_1, area_raw_106000_roll1_etc)\n\n\narea_raw_106000_roll1_1$h12[is.na(area_raw_106000_roll1_1$h12)] <- 0\narea_raw_106000_roll1_1$h24[is.na(area_raw_106000_roll1_1$h24)] <- 0\narea_raw_106000_roll1_1$h36[is.na(area_raw_106000_roll1_1$h36)] <- 0\narea_raw_106000_roll1_1$h48[is.na(area_raw_106000_roll1_1$h48)] <- 0\narea_raw_106000_roll1_1$etc[is.na(area_raw_106000_roll1_1$etc)] <- 0\n\narea_raw_106000_roll1_h2436 <- area_raw_106000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_106000_roll1_1<-left_join(area_raw_106000_roll1_1, area_raw_106000_roll1_h2436)\narea_raw_106000_roll1_h3648 <- area_raw_106000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_106000_roll1_1<-left_join(area_raw_106000_roll1_1, area_raw_106000_roll1_h3648)\narea_raw_106000_roll1_h2448 <- area_raw_106000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_106000_roll1_1<-left_join(area_raw_106000_roll1_1, area_raw_106000_roll1_h2448)\n\narea_raw_106000_roll1_mean <- area_raw_106000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_106000_roll1_1<-left_join(area_raw_106000_roll1_1, area_raw_106000_roll1_mean)\n\narea_raw_106000_roll1_rate <- area_raw_106000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_106000_roll1_1<-left_join(area_raw_106000_roll1_1, area_raw_106000_roll1_rate)\n\narea_raw_106000_roll1_1$rate[is.nan(area_raw_106000_roll1_1$rate) | is.infinite(area_raw_106000_roll1_1$rate)] <- 0\n\n\narea_raw_106000_roll1_opening<-area_raw_106000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_106000_roll1_final <- left_join(area_raw_106000_roll1_opening, area_raw_106000_roll1_1)\narea_raw_106000_roll1_final<-unique(area_raw_106000_roll1_final)\n\nrm(list=c('area_raw_106000_roll1_1','area_raw_106000_roll1_h12','area_raw_106000_roll1_h24','area_raw_106000_roll1_h36','area_raw_106000_roll1_h48','area_raw_106000_roll1_h2436','area_raw_106000_roll1_h3648','area_raw_106000_roll1_h2448',\n          'area_raw_106000_roll1_mean','area_raw_106000_roll1_rate','area_raw_106000_roll1_opening'))\n\nwrite.csv(area_raw_106000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_106000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_106000_roll2_1 <- area_raw_106000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_106000_roll2_h12 <- area_raw_106000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_106000_roll2_1 <- left_join(area_raw_106000_roll2_1, area_raw_106000_roll2_h12)\narea_raw_106000_roll2_h24 <- area_raw_106000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_106000_roll2_1 <- left_join(area_raw_106000_roll2_1, area_raw_106000_roll2_h24)\narea_raw_106000_roll2_h36 <- area_raw_106000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_106000_roll2_1 <- left_join(area_raw_106000_roll2_1, area_raw_106000_roll2_h36)\narea_raw_106000_roll2_h48 <- area_raw_106000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_106000_roll2_1 <- left_join(area_raw_106000_roll2_1, area_raw_106000_roll2_h48)\narea_raw_106000_roll2_etc <- area_raw_106000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_106000_roll2_1 <- left_join(area_raw_106000_roll2_1, area_raw_106000_roll2_etc)\n\narea_raw_106000_roll2_1$h12[is.na(area_raw_106000_roll2_1$h12)] <- 0\narea_raw_106000_roll2_1$h24[is.na(area_raw_106000_roll2_1$h24)] <- 0\narea_raw_106000_roll2_1$h36[is.na(area_raw_106000_roll2_1$h36)] <- 0\narea_raw_106000_roll2_1$h48[is.na(area_raw_106000_roll2_1$h48)] <- 0\narea_raw_106000_roll2_1$etc[is.na(area_raw_106000_roll2_1$etc)] <- 0\n\narea_raw_106000_roll2_h2436 <- area_raw_106000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_106000_roll2_1<-left_join(area_raw_106000_roll2_1, area_raw_106000_roll2_h2436)\narea_raw_106000_roll2_h3648 <- area_raw_106000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_106000_roll2_1<-left_join(area_raw_106000_roll2_1, area_raw_106000_roll2_h3648)\narea_raw_106000_roll2_h2448 <- area_raw_106000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_106000_roll2_1<-left_join(area_raw_106000_roll2_1, area_raw_106000_roll2_h2448)\n\narea_raw_106000_roll2_mean <- area_raw_106000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_106000_roll2_1<-left_join(area_raw_106000_roll2_1, area_raw_106000_roll2_mean)\n\narea_raw_106000_roll2_rate <- area_raw_106000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_106000_roll2_1<-left_join(area_raw_106000_roll2_1, area_raw_106000_roll2_rate)\n\narea_raw_106000_roll2_1$rate[is.nan(area_raw_106000_roll2_1$rate) | is.infinite(area_raw_106000_roll2_1$rate)] <- 0\n\narea_raw_106000_roll2_opening<-area_raw_106000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_106000_roll2_final <- left_join(area_raw_106000_roll2_opening, area_raw_106000_roll2_1)\narea_raw_106000_roll2_final<-unique(area_raw_106000_roll2_final)\n\nrm(list=c('area_raw_106000_roll2_1','area_raw_106000_roll2_h12','area_raw_106000_roll2_h24','area_raw_106000_roll2_h36','area_raw_106000_roll2_h48','area_raw_106000_roll2_h2436','area_raw_106000_roll2_h3648','area_raw_106000_roll2_h2448',\n          'area_raw_106000_roll2_mean','area_raw_106000_roll2_rate','area_raw_106000_roll2_opening'))\n\nwrite.csv(area_raw_106000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_106000_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\narea_raw_107000_2<- left_join(area_raw_107000, area_recruit_sub)\n\narea_raw_107000_2$date_new <- as.POSIXct(area_raw_107000_2$date)\n\narea_raw_107000_2$diff <- (area_raw_107000_2$date_new - area_raw_107000_2$opening_dt_new)\narea_raw_107000_2 <- area_raw_107000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_107000_2$opening_dt_new\narea_raw_107000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_107000_roll2<- area_raw_107000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_107000_roll1<- area_raw_107000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_107000_roll1_1 <- area_raw_107000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_107000_roll1_h12 <- area_raw_107000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_107000_roll1_1 <- left_join(area_raw_107000_roll1_1, area_raw_107000_roll1_h12)\narea_raw_107000_roll1_h24 <- area_raw_107000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_107000_roll1_1 <- left_join(area_raw_107000_roll1_1, area_raw_107000_roll1_h24)\narea_raw_107000_roll1_h36 <- area_raw_107000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_107000_roll1_1 <- left_join(area_raw_107000_roll1_1, area_raw_107000_roll1_h36)\narea_raw_107000_roll1_h48 <- area_raw_107000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_107000_roll1_1 <- left_join(area_raw_107000_roll1_1, area_raw_107000_roll1_h48)\narea_raw_107000_roll1_etc <- area_raw_107000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_107000_roll1_1 <- left_join(area_raw_107000_roll1_1, area_raw_107000_roll1_etc)\n\narea_raw_107000_roll1_1$h12[is.na(area_raw_107000_roll1_1$h12)] <- 0\narea_raw_107000_roll1_1$h24[is.na(area_raw_107000_roll1_1$h24)] <- 0\narea_raw_107000_roll1_1$h36[is.na(area_raw_107000_roll1_1$h36)] <- 0\narea_raw_107000_roll1_1$h48[is.na(area_raw_107000_roll1_1$h48)] <- 0\narea_raw_107000_roll1_1$etc[is.na(area_raw_107000_roll1_1$etc)] <- 0\n\narea_raw_107000_roll1_h2436 <- area_raw_107000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_107000_roll1_1<-left_join(area_raw_107000_roll1_1, area_raw_107000_roll1_h2436)\narea_raw_107000_roll1_h3648 <- area_raw_107000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_107000_roll1_1<-left_join(area_raw_107000_roll1_1, area_raw_107000_roll1_h3648)\narea_raw_107000_roll1_h2448 <- area_raw_107000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_107000_roll1_1<-left_join(area_raw_107000_roll1_1, area_raw_107000_roll1_h2448)\n\narea_raw_107000_roll1_mean <- area_raw_107000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_107000_roll1_1<-left_join(area_raw_107000_roll1_1, area_raw_107000_roll1_mean)\n\narea_raw_107000_roll1_rate <- area_raw_107000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_107000_roll1_1<-left_join(area_raw_107000_roll1_1, area_raw_107000_roll1_rate)\n\narea_raw_107000_roll1_1$rate[is.nan(area_raw_107000_roll1_1$rate) | is.infinite(area_raw_107000_roll1_1$rate)] <- 0\n\n\narea_raw_107000_roll1_opening<-area_raw_107000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_107000_roll1_final <- left_join(area_raw_107000_roll1_opening, area_raw_107000_roll1_1)\narea_raw_107000_roll1_final<-unique(area_raw_107000_roll1_final)\n\nrm(list=c('area_raw_107000_roll1_1','area_raw_107000_roll1_h12','area_raw_107000_roll1_h24','area_raw_107000_roll1_h36','area_raw_107000_roll1_h48','area_raw_107000_roll1_h2436','area_raw_107000_roll1_h3648','area_raw_107000_roll1_h2448',\n          'area_raw_107000_roll1_mean','area_raw_107000_roll1_rate','area_raw_107000_roll1_opening'))\n\nwrite.csv(area_raw_107000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_107000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_107000_roll2_1 <- area_raw_107000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_107000_roll2_h12 <- area_raw_107000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_107000_roll2_1 <- left_join(area_raw_107000_roll2_1, area_raw_107000_roll2_h12)\narea_raw_107000_roll2_h24 <- area_raw_107000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_107000_roll2_1 <- left_join(area_raw_107000_roll2_1, area_raw_107000_roll2_h24)\narea_raw_107000_roll2_h36 <- area_raw_107000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_107000_roll2_1 <- left_join(area_raw_107000_roll2_1, area_raw_107000_roll2_h36)\narea_raw_107000_roll2_h48 <- area_raw_107000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_107000_roll2_1 <- left_join(area_raw_107000_roll2_1, area_raw_107000_roll2_h48)\narea_raw_107000_roll2_etc <- area_raw_107000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_107000_roll2_1 <- left_join(area_raw_107000_roll2_1, area_raw_107000_roll2_etc)\n\narea_raw_107000_roll2_1$h12[is.na(area_raw_107000_roll2_1$h12)] <- 0\narea_raw_107000_roll2_1$h24[is.na(area_raw_107000_roll2_1$h24)] <- 0\narea_raw_107000_roll2_1$h36[is.na(area_raw_107000_roll2_1$h36)] <- 0\narea_raw_107000_roll2_1$h48[is.na(area_raw_107000_roll2_1$h48)] <- 0\narea_raw_107000_roll2_1$etc[is.na(area_raw_107000_roll2_1$etc)] <- 0\n\narea_raw_107000_roll2_h2436 <- area_raw_107000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_107000_roll2_1<-left_join(area_raw_107000_roll2_1, area_raw_107000_roll2_h2436)\narea_raw_107000_roll2_h3648 <- area_raw_107000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_107000_roll2_1<-left_join(area_raw_107000_roll2_1, area_raw_107000_roll2_h3648)\narea_raw_107000_roll2_h2448 <- area_raw_107000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_107000_roll2_1<-left_join(area_raw_107000_roll2_1, area_raw_107000_roll2_h2448)\n\narea_raw_107000_roll2_mean <- area_raw_107000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_107000_roll2_1<-left_join(area_raw_107000_roll2_1, area_raw_107000_roll2_mean)\n\narea_raw_107000_roll2_rate <- area_raw_107000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_107000_roll2_1<-left_join(area_raw_107000_roll2_1, area_raw_107000_roll2_rate)\n\narea_raw_107000_roll2_1$rate[is.nan(area_raw_107000_roll2_1$rate) | is.infinite(area_raw_107000_roll2_1$rate)] <- 0\n\narea_raw_107000_roll2_opening<-area_raw_107000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_107000_roll2_final <- left_join(area_raw_107000_roll2_opening, area_raw_107000_roll2_1)\narea_raw_107000_roll2_final<-unique(area_raw_107000_roll2_final)\n\nrm(list=c('area_raw_107000_roll2_1','area_raw_107000_roll2_h12','area_raw_107000_roll2_h24','area_raw_107000_roll2_h36','area_raw_107000_roll2_h48','area_raw_107000_roll2_h2436','area_raw_107000_roll2_h3648','area_raw_107000_roll2_h2448',\n          'area_raw_107000_roll2_mean','area_raw_107000_roll2_rate','area_raw_107000_roll2_opening'))\n\nwrite.csv(area_raw_107000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_107000_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\narea_raw_108000_2<- left_join(area_raw_108000, area_recruit_sub)\n\narea_raw_108000_2$date_new <- as.POSIXct(area_raw_108000_2$date)\n\narea_raw_108000_2$diff <- (area_raw_108000_2$date_new - area_raw_108000_2$opening_dt_new)\narea_raw_108000_2 <- area_raw_108000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_108000_2$opening_dt_new\narea_raw_108000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_108000_roll2<- area_raw_108000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_108000_roll1<- area_raw_108000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_108000_roll1_1 <- area_raw_108000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_108000_roll1_h12 <- area_raw_108000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_108000_roll1_1 <- left_join(area_raw_108000_roll1_1, area_raw_108000_roll1_h12)\narea_raw_108000_roll1_h24 <- area_raw_108000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_108000_roll1_1 <- left_join(area_raw_108000_roll1_1, area_raw_108000_roll1_h24)\narea_raw_108000_roll1_h36 <- area_raw_108000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_108000_roll1_1 <- left_join(area_raw_108000_roll1_1, area_raw_108000_roll1_h36)\narea_raw_108000_roll1_h48 <- area_raw_108000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_108000_roll1_1 <- left_join(area_raw_108000_roll1_1, area_raw_108000_roll1_h48)\narea_raw_108000_roll1_etc <- area_raw_108000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_108000_roll1_1 <- left_join(area_raw_108000_roll1_1, area_raw_108000_roll1_etc)\n\narea_raw_108000_roll1_1$h12[is.na(area_raw_108000_roll1_1$h12)] <- 0\narea_raw_108000_roll1_1$h24[is.na(area_raw_108000_roll1_1$h24)] <- 0\narea_raw_108000_roll1_1$h36[is.na(area_raw_108000_roll1_1$h36)] <- 0\narea_raw_108000_roll1_1$h48[is.na(area_raw_108000_roll1_1$h48)] <- 0\narea_raw_108000_roll1_1$etc[is.na(area_raw_108000_roll1_1$etc)] <- 0\n\narea_raw_108000_roll1_h2436 <- area_raw_108000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_108000_roll1_1<-left_join(area_raw_108000_roll1_1, area_raw_108000_roll1_h2436)\narea_raw_108000_roll1_h3648 <- area_raw_108000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_108000_roll1_1<-left_join(area_raw_108000_roll1_1, area_raw_108000_roll1_h3648)\narea_raw_108000_roll1_h2448 <- area_raw_108000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_108000_roll1_1<-left_join(area_raw_108000_roll1_1, area_raw_108000_roll1_h2448)\n\narea_raw_108000_roll1_mean <- area_raw_108000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_108000_roll1_1<-left_join(area_raw_108000_roll1_1, area_raw_108000_roll1_mean)\n\narea_raw_108000_roll1_rate <- area_raw_108000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_108000_roll1_1<-left_join(area_raw_108000_roll1_1, area_raw_108000_roll1_rate)\n\narea_raw_108000_roll1_1$rate[is.nan(area_raw_108000_roll1_1$rate) | is.infinite(area_raw_108000_roll1_1$rate)] <- 0\n\n\narea_raw_108000_roll1_opening<-area_raw_108000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_108000_roll1_final <- left_join(area_raw_108000_roll1_opening, area_raw_108000_roll1_1)\narea_raw_108000_roll1_final<-unique(area_raw_108000_roll1_final)\n\nrm(list=c('area_raw_108000_roll1_1','area_raw_108000_roll1_h12','area_raw_108000_roll1_h24','area_raw_108000_roll1_h36','area_raw_108000_roll1_h48','area_raw_108000_roll1_h2436','area_raw_108000_roll1_h3648','area_raw_108000_roll1_h2448',\n          'area_raw_108000_roll1_mean','area_raw_108000_roll1_rate','area_raw_108000_roll1_opening'))\n\nwrite.csv(area_raw_108000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_108000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_108000_roll2_1 <- area_raw_108000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_108000_roll2_h12 <- area_raw_108000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_108000_roll2_1 <- left_join(area_raw_108000_roll2_1, area_raw_108000_roll2_h12)\narea_raw_108000_roll2_h24 <- area_raw_108000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_108000_roll2_1 <- left_join(area_raw_108000_roll2_1, area_raw_108000_roll2_h24)\narea_raw_108000_roll2_h36 <- area_raw_108000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_108000_roll2_1 <- left_join(area_raw_108000_roll2_1, area_raw_108000_roll2_h36)\narea_raw_108000_roll2_h48 <- area_raw_108000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_108000_roll2_1 <- left_join(area_raw_108000_roll2_1, area_raw_108000_roll2_h48)\narea_raw_108000_roll2_etc <- area_raw_108000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_108000_roll2_1 <- left_join(area_raw_108000_roll2_1, area_raw_108000_roll2_etc)\n\narea_raw_108000_roll2_1$h12[is.na(area_raw_108000_roll2_1$h12)] <- 0\narea_raw_108000_roll2_1$h24[is.na(area_raw_108000_roll2_1$h24)] <- 0\narea_raw_108000_roll2_1$h36[is.na(area_raw_108000_roll2_1$h36)] <- 0\narea_raw_108000_roll2_1$h48[is.na(area_raw_108000_roll2_1$h48)] <- 0\narea_raw_108000_roll2_1$etc[is.na(area_raw_108000_roll2_1$etc)] <- 0\n\narea_raw_108000_roll2_h2436 <- area_raw_108000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_108000_roll2_1<-left_join(area_raw_108000_roll2_1, area_raw_108000_roll2_h2436)\narea_raw_108000_roll2_h3648 <- area_raw_108000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_108000_roll2_1<-left_join(area_raw_108000_roll2_1, area_raw_108000_roll2_h3648)\narea_raw_108000_roll2_h2448 <- area_raw_108000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_108000_roll2_1<-left_join(area_raw_108000_roll2_1, area_raw_108000_roll2_h2448)\n\narea_raw_108000_roll2_mean <- area_raw_108000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_108000_roll2_1<-left_join(area_raw_108000_roll2_1, area_raw_108000_roll2_mean)\n\narea_raw_108000_roll2_rate <- area_raw_108000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_108000_roll2_1<-left_join(area_raw_108000_roll2_1, area_raw_108000_roll2_rate)\n\narea_raw_108000_roll2_1$rate[is.nan(area_raw_108000_roll2_1$rate) | is.infinite(area_raw_108000_roll2_1$rate)] <- 0\n\narea_raw_108000_roll2_opening<-area_raw_108000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_108000_roll2_final <- left_join(area_raw_108000_roll2_opening, area_raw_108000_roll2_1)\narea_raw_108000_roll2_final<-unique(area_raw_108000_roll2_final)\n\nrm(list=c('area_raw_108000_roll2_1','area_raw_108000_roll2_h12','area_raw_108000_roll2_h24','area_raw_108000_roll2_h36','area_raw_108000_roll2_h48','area_raw_108000_roll2_h2436','area_raw_108000_roll2_h3648','area_raw_108000_roll2_h2448',\n          'area_raw_108000_roll2_mean','area_raw_108000_roll2_rate','area_raw_108000_roll2_opening'))\n\nwrite.csv(area_raw_108000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_108000_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\narea_raw_109000_2<- left_join(area_raw_109000, area_recruit_sub)\n\narea_raw_109000_2$date_new <- as.POSIXct(area_raw_109000_2$date)\n\narea_raw_109000_2$diff <- (area_raw_109000_2$date_new - area_raw_109000_2$opening_dt_new)\narea_raw_109000_2 <- area_raw_109000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_109000_2$opening_dt_new\narea_raw_109000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_109000_roll2<- area_raw_109000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_109000_roll1<- area_raw_109000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_109000_roll1_1 <- area_raw_109000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_109000_roll1_h12 <- area_raw_109000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_109000_roll1_1 <- left_join(area_raw_109000_roll1_1, area_raw_109000_roll1_h12)\narea_raw_109000_roll1_h24 <- area_raw_109000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_109000_roll1_1 <- left_join(area_raw_109000_roll1_1, area_raw_109000_roll1_h24)\narea_raw_109000_roll1_h36 <- area_raw_109000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_109000_roll1_1 <- left_join(area_raw_109000_roll1_1, area_raw_109000_roll1_h36)\narea_raw_109000_roll1_h48 <- area_raw_109000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_109000_roll1_1 <- left_join(area_raw_109000_roll1_1, area_raw_109000_roll1_h48)\narea_raw_109000_roll1_etc <- area_raw_109000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_109000_roll1_1 <- left_join(area_raw_109000_roll1_1, area_raw_109000_roll1_etc)\n\narea_raw_109000_roll1_1$h12[is.na(area_raw_109000_roll1_1$h12)] <- 0\narea_raw_109000_roll1_1$h24[is.na(area_raw_109000_roll1_1$h24)] <- 0\narea_raw_109000_roll1_1$h36[is.na(area_raw_109000_roll1_1$h36)] <- 0\narea_raw_109000_roll1_1$h48[is.na(area_raw_109000_roll1_1$h48)] <- 0\narea_raw_109000_roll1_1$etc[is.na(area_raw_109000_roll1_1$etc)] <- 0\n\narea_raw_109000_roll1_h2436 <- area_raw_109000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_109000_roll1_1<-left_join(area_raw_109000_roll1_1, area_raw_109000_roll1_h2436)\narea_raw_109000_roll1_h3648 <- area_raw_109000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_109000_roll1_1<-left_join(area_raw_109000_roll1_1, area_raw_109000_roll1_h3648)\narea_raw_109000_roll1_h2448 <- area_raw_109000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_109000_roll1_1<-left_join(area_raw_109000_roll1_1, area_raw_109000_roll1_h2448)\n\narea_raw_109000_roll1_mean <- area_raw_109000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_109000_roll1_1<-left_join(area_raw_109000_roll1_1, area_raw_109000_roll1_mean)\n\narea_raw_109000_roll1_rate <- area_raw_109000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_109000_roll1_1<-left_join(area_raw_109000_roll1_1, area_raw_109000_roll1_rate)\n\narea_raw_109000_roll1_1$rate[is.nan(area_raw_109000_roll1_1$rate) | is.infinite(area_raw_109000_roll1_1$rate)] <- 0\n\n\narea_raw_109000_roll1_opening<-area_raw_109000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_109000_roll1_final <- left_join(area_raw_109000_roll1_opening, area_raw_109000_roll1_1)\narea_raw_109000_roll1_final<-unique(area_raw_109000_roll1_final)\n\nrm(list=c('area_raw_109000_roll1_1','area_raw_109000_roll1_h12','area_raw_109000_roll1_h24','area_raw_109000_roll1_h36','area_raw_109000_roll1_h48','area_raw_109000_roll1_h2436','area_raw_109000_roll1_h3648','area_raw_109000_roll1_h2448',\n          'area_raw_109000_roll1_mean','area_raw_109000_roll1_rate','area_raw_109000_roll1_opening'))\n\nwrite.csv(area_raw_109000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_109000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_109000_roll2_1 <- area_raw_109000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_109000_roll2_h12 <- area_raw_109000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_109000_roll2_1 <- left_join(area_raw_109000_roll2_1, area_raw_109000_roll2_h12)\narea_raw_109000_roll2_h24 <- area_raw_109000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_109000_roll2_1 <- left_join(area_raw_109000_roll2_1, area_raw_109000_roll2_h24)\narea_raw_109000_roll2_h36 <- area_raw_109000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_109000_roll2_1 <- left_join(area_raw_109000_roll2_1, area_raw_109000_roll2_h36)\narea_raw_109000_roll2_h48 <- area_raw_109000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_109000_roll2_1 <- left_join(area_raw_109000_roll2_1, area_raw_109000_roll2_h48)\narea_raw_109000_roll2_etc <- area_raw_109000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_109000_roll2_1 <- left_join(area_raw_109000_roll2_1, area_raw_109000_roll2_etc)\n\narea_raw_109000_roll2_1$h12[is.na(area_raw_109000_roll2_1$h12)] <- 0\narea_raw_109000_roll2_1$h24[is.na(area_raw_109000_roll2_1$h24)] <- 0\narea_raw_109000_roll2_1$h36[is.na(area_raw_109000_roll2_1$h36)] <- 0\narea_raw_109000_roll2_1$h48[is.na(area_raw_109000_roll2_1$h48)] <- 0\narea_raw_109000_roll2_1$etc[is.na(area_raw_109000_roll2_1$etc)] <- 0\n\narea_raw_109000_roll2_h2436 <- area_raw_109000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_109000_roll2_1<-left_join(area_raw_109000_roll2_1, area_raw_109000_roll2_h2436)\narea_raw_109000_roll2_h3648 <- area_raw_109000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_109000_roll2_1<-left_join(area_raw_109000_roll2_1, area_raw_109000_roll2_h3648)\narea_raw_109000_roll2_h2448 <- area_raw_109000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_109000_roll2_1<-left_join(area_raw_109000_roll2_1, area_raw_109000_roll2_h2448)\n\narea_raw_109000_roll2_mean <- area_raw_109000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_109000_roll2_1<-left_join(area_raw_109000_roll2_1, area_raw_109000_roll2_mean)\n\narea_raw_109000_roll2_rate <- area_raw_109000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_109000_roll2_1<-left_join(area_raw_109000_roll2_1, area_raw_109000_roll2_rate)\n\narea_raw_109000_roll2_1$rate[is.nan(area_raw_109000_roll2_1$rate) | is.infinite(area_raw_109000_roll2_1$rate)] <- 0\n\narea_raw_109000_roll2_opening<-area_raw_109000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_109000_roll2_final <- left_join(area_raw_109000_roll2_opening, area_raw_109000_roll2_1)\narea_raw_109000_roll2_final<-unique(area_raw_109000_roll2_final)\n\nrm(list=c('area_raw_109000_roll2_1','area_raw_109000_roll2_h12','area_raw_109000_roll2_h24','area_raw_109000_roll2_h36','area_raw_109000_roll2_h48','area_raw_109000_roll2_h2436','area_raw_109000_roll2_h3648','area_raw_109000_roll2_h2448',\n          'area_raw_109000_roll2_mean','area_raw_109000_roll2_rate','area_raw_109000_roll2_opening'))\n\nwrite.csv(area_raw_109000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_109000_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\narea_raw_110000_2<- left_join(area_raw_110000, area_recruit_sub)\n\narea_raw_110000_2$date_new <- as.POSIXct(area_raw_110000_2$date)\n\narea_raw_110000_2$diff <- (area_raw_110000_2$date_new - area_raw_110000_2$opening_dt_new)\narea_raw_110000_2 <- area_raw_110000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_110000_2$opening_dt_new\narea_raw_110000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_110000_roll2<- area_raw_110000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_110000_roll1<- area_raw_110000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_110000_roll1_1 <- area_raw_110000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_110000_roll1_h12 <- area_raw_110000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_110000_roll1_1 <- left_join(area_raw_110000_roll1_1, area_raw_110000_roll1_h12)\narea_raw_110000_roll1_h24 <- area_raw_110000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_110000_roll1_1 <- left_join(area_raw_110000_roll1_1, area_raw_110000_roll1_h24)\narea_raw_110000_roll1_h36 <- area_raw_110000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_110000_roll1_1 <- left_join(area_raw_110000_roll1_1, area_raw_110000_roll1_h36)\narea_raw_110000_roll1_h48 <- area_raw_110000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_110000_roll1_1 <- left_join(area_raw_110000_roll1_1, area_raw_110000_roll1_h48)\narea_raw_110000_roll1_etc <- area_raw_110000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_110000_roll1_1 <- left_join(area_raw_110000_roll1_1, area_raw_110000_roll1_etc)\n\narea_raw_110000_roll1_1$h12[is.na(area_raw_110000_roll1_1$h12)] <- 0\narea_raw_110000_roll1_1$h24[is.na(area_raw_110000_roll1_1$h24)] <- 0\narea_raw_110000_roll1_1$h36[is.na(area_raw_110000_roll1_1$h36)] <- 0\narea_raw_110000_roll1_1$h48[is.na(area_raw_110000_roll1_1$h48)] <- 0\narea_raw_110000_roll1_1$etc[is.na(area_raw_110000_roll1_1$etc)] <- 0\n\narea_raw_110000_roll1_h2436 <- area_raw_110000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_110000_roll1_1<-left_join(area_raw_110000_roll1_1, area_raw_110000_roll1_h2436)\narea_raw_110000_roll1_h3648 <- area_raw_110000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_110000_roll1_1<-left_join(area_raw_110000_roll1_1, area_raw_110000_roll1_h3648)\narea_raw_110000_roll1_h2448 <- area_raw_110000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_110000_roll1_1<-left_join(area_raw_110000_roll1_1, area_raw_110000_roll1_h2448)\n\narea_raw_110000_roll1_mean <- area_raw_110000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_110000_roll1_1<-left_join(area_raw_110000_roll1_1, area_raw_110000_roll1_mean)\n\narea_raw_110000_roll1_rate <- area_raw_110000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_110000_roll1_1<-left_join(area_raw_110000_roll1_1, area_raw_110000_roll1_rate)\n\narea_raw_110000_roll1_1$rate[is.nan(area_raw_110000_roll1_1$rate) | is.infinite(area_raw_110000_roll1_1$rate)] <- 0\n\n\narea_raw_110000_roll1_opening<-area_raw_110000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_110000_roll1_final <- left_join(area_raw_110000_roll1_opening, area_raw_110000_roll1_1)\narea_raw_110000_roll1_final<-unique(area_raw_110000_roll1_final)\n\nrm(list=c('area_raw_110000_roll1_1','area_raw_110000_roll1_h12','area_raw_110000_roll1_h24','area_raw_110000_roll1_h36','area_raw_110000_roll1_h48','area_raw_110000_roll1_h2436','area_raw_110000_roll1_h3648','area_raw_110000_roll1_h2448',\n          'area_raw_110000_roll1_mean','area_raw_110000_roll1_rate','area_raw_110000_roll1_opening'))\n\nwrite.csv(area_raw_110000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_110000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_110000_roll2_1 <- area_raw_110000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_110000_roll2_h12 <- area_raw_110000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_110000_roll2_1 <- left_join(area_raw_110000_roll2_1, area_raw_110000_roll2_h12)\narea_raw_110000_roll2_h24 <- area_raw_110000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_110000_roll2_1 <- left_join(area_raw_110000_roll2_1, area_raw_110000_roll2_h24)\narea_raw_110000_roll2_h36 <- area_raw_110000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_110000_roll2_1 <- left_join(area_raw_110000_roll2_1, area_raw_110000_roll2_h36)\narea_raw_110000_roll2_h48 <- area_raw_110000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_110000_roll2_1 <- left_join(area_raw_110000_roll2_1, area_raw_110000_roll2_h48)\narea_raw_110000_roll2_etc <- area_raw_110000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_110000_roll2_1 <- left_join(area_raw_110000_roll2_1, area_raw_110000_roll2_etc)\n\n\narea_raw_110000_roll2_1$h12[is.na(area_raw_110000_roll2_1$h12)] <- 0\narea_raw_110000_roll2_1$h24[is.na(area_raw_110000_roll2_1$h24)] <- 0\narea_raw_110000_roll2_1$h36[is.na(area_raw_110000_roll2_1$h36)] <- 0\narea_raw_110000_roll2_1$h48[is.na(area_raw_110000_roll2_1$h48)] <- 0\narea_raw_110000_roll2_1$etc[is.na(area_raw_110000_roll2_1$etc)] <- 0\n\narea_raw_110000_roll2_h2436 <- area_raw_110000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_110000_roll2_1<-left_join(area_raw_110000_roll2_1, area_raw_110000_roll2_h2436)\narea_raw_110000_roll2_h3648 <- area_raw_110000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_110000_roll2_1<-left_join(area_raw_110000_roll2_1, area_raw_110000_roll2_h3648)\narea_raw_110000_roll2_h2448 <- area_raw_110000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_110000_roll2_1<-left_join(area_raw_110000_roll2_1, area_raw_110000_roll2_h2448)\n\narea_raw_110000_roll2_mean <- area_raw_110000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_110000_roll2_1<-left_join(area_raw_110000_roll2_1, area_raw_110000_roll2_mean)\n\narea_raw_110000_roll2_rate <- area_raw_110000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_110000_roll2_1<-left_join(area_raw_110000_roll2_1, area_raw_110000_roll2_rate)\n\narea_raw_110000_roll2_1$rate[is.nan(area_raw_110000_roll2_1$rate) | is.infinite(area_raw_110000_roll2_1$rate)] <- 0\n\narea_raw_110000_roll2_opening<-area_raw_110000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_110000_roll2_final <- left_join(area_raw_110000_roll2_opening, area_raw_110000_roll2_1)\narea_raw_110000_roll2_final<-unique(area_raw_110000_roll2_final)\n\nrm(list=c('area_raw_110000_roll2_1','area_raw_110000_roll2_h12','area_raw_110000_roll2_h24','area_raw_110000_roll2_h36','area_raw_110000_roll2_h48','area_raw_110000_roll2_h2436','area_raw_110000_roll2_h3648','area_raw_110000_roll2_h2448',\n          'area_raw_110000_roll2_mean','area_raw_110000_roll2_rate','area_raw_110000_roll2_opening'))\n\nwrite.csv(area_raw_110000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_110000_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\narea_raw_111000_2<- left_join(area_raw_111000, area_recruit_sub)\n\narea_raw_111000_2$date_new <- as.POSIXct(area_raw_111000_2$date)\n\narea_raw_111000_2$diff <- (area_raw_111000_2$date_new - area_raw_111000_2$opening_dt_new)\narea_raw_111000_2 <- area_raw_111000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_111000_2$opening_dt_new\narea_raw_111000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_111000_roll2<- area_raw_111000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_111000_roll1<- area_raw_111000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_111000_roll1_1 <- area_raw_111000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_111000_roll1_h12 <- area_raw_111000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_111000_roll1_1 <- left_join(area_raw_111000_roll1_1, area_raw_111000_roll1_h12)\narea_raw_111000_roll1_h24 <- area_raw_111000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_111000_roll1_1 <- left_join(area_raw_111000_roll1_1, area_raw_111000_roll1_h24)\narea_raw_111000_roll1_h36 <- area_raw_111000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_111000_roll1_1 <- left_join(area_raw_111000_roll1_1, area_raw_111000_roll1_h36)\narea_raw_111000_roll1_h48 <- area_raw_111000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_111000_roll1_1 <- left_join(area_raw_111000_roll1_1, area_raw_111000_roll1_h48)\narea_raw_111000_roll1_etc <- area_raw_111000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_111000_roll1_1 <- left_join(area_raw_111000_roll1_1, area_raw_111000_roll1_etc)\n\n\narea_raw_111000_roll1_1$h12[is.na(area_raw_111000_roll1_1$h12)] <- 0\narea_raw_111000_roll1_1$h24[is.na(area_raw_111000_roll1_1$h24)] <- 0\narea_raw_111000_roll1_1$h36[is.na(area_raw_111000_roll1_1$h36)] <- 0\narea_raw_111000_roll1_1$h48[is.na(area_raw_111000_roll1_1$h48)] <- 0\narea_raw_111000_roll1_1$etc[is.na(area_raw_111000_roll1_1$etc)] <- 0\n\narea_raw_111000_roll1_h2436 <- area_raw_111000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_111000_roll1_1<-left_join(area_raw_111000_roll1_1, area_raw_111000_roll1_h2436)\narea_raw_111000_roll1_h3648 <- area_raw_111000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_111000_roll1_1<-left_join(area_raw_111000_roll1_1, area_raw_111000_roll1_h3648)\narea_raw_111000_roll1_h2448 <- area_raw_111000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_111000_roll1_1<-left_join(area_raw_111000_roll1_1, area_raw_111000_roll1_h2448)\n\narea_raw_111000_roll1_mean <- area_raw_111000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_111000_roll1_1<-left_join(area_raw_111000_roll1_1, area_raw_111000_roll1_mean)\n\narea_raw_111000_roll1_rate <- area_raw_111000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_111000_roll1_1<-left_join(area_raw_111000_roll1_1, area_raw_111000_roll1_rate)\n\narea_raw_111000_roll1_1$rate[is.nan(area_raw_111000_roll1_1$rate) | is.infinite(area_raw_111000_roll1_1$rate)] <- 0\n\n\narea_raw_111000_roll1_opening<-area_raw_111000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_111000_roll1_final <- left_join(area_raw_111000_roll1_opening, area_raw_111000_roll1_1)\narea_raw_111000_roll1_final<-unique(area_raw_111000_roll1_final)\n\nrm(list=c('area_raw_111000_roll1_1','area_raw_111000_roll1_h12','area_raw_111000_roll1_h24','area_raw_111000_roll1_h36','area_raw_111000_roll1_h48','area_raw_111000_roll1_h2436','area_raw_111000_roll1_h3648','area_raw_111000_roll1_h2448',\n          'area_raw_111000_roll1_mean','area_raw_111000_roll1_rate','area_raw_111000_roll1_opening'))\n\nwrite.csv(area_raw_111000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_111000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_111000_roll2_1 <- area_raw_111000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_111000_roll2_h12 <- area_raw_111000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_111000_roll2_1 <- left_join(area_raw_111000_roll2_1, area_raw_111000_roll2_h12)\narea_raw_111000_roll2_h24 <- area_raw_111000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_111000_roll2_1 <- left_join(area_raw_111000_roll2_1, area_raw_111000_roll2_h24)\narea_raw_111000_roll2_h36 <- area_raw_111000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_111000_roll2_1 <- left_join(area_raw_111000_roll2_1, area_raw_111000_roll2_h36)\narea_raw_111000_roll2_h48 <- area_raw_111000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_111000_roll2_1 <- left_join(area_raw_111000_roll2_1, area_raw_111000_roll2_h48)\narea_raw_111000_roll2_etc <- area_raw_111000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_111000_roll2_1 <- left_join(area_raw_111000_roll2_1, area_raw_111000_roll2_etc)\n\narea_raw_111000_roll2_1$h12[is.na(area_raw_111000_roll2_1$h12)] <- 0\narea_raw_111000_roll2_1$h24[is.na(area_raw_111000_roll2_1$h24)] <- 0\narea_raw_111000_roll2_1$h36[is.na(area_raw_111000_roll2_1$h36)] <- 0\narea_raw_111000_roll2_1$h48[is.na(area_raw_111000_roll2_1$h48)] <- 0\narea_raw_111000_roll2_1$etc[is.na(area_raw_111000_roll2_1$etc)] <- 0\n\narea_raw_111000_roll2_h2436 <- area_raw_111000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_111000_roll2_1<-left_join(area_raw_111000_roll2_1, area_raw_111000_roll2_h2436)\narea_raw_111000_roll2_h3648 <- area_raw_111000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_111000_roll2_1<-left_join(area_raw_111000_roll2_1, area_raw_111000_roll2_h3648)\narea_raw_111000_roll2_h2448 <- area_raw_111000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_111000_roll2_1<-left_join(area_raw_111000_roll2_1, area_raw_111000_roll2_h2448)\n\narea_raw_111000_roll2_mean <- area_raw_111000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_111000_roll2_1<-left_join(area_raw_111000_roll2_1, area_raw_111000_roll2_mean)\n\narea_raw_111000_roll2_rate <- area_raw_111000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_111000_roll2_1<-left_join(area_raw_111000_roll2_1, area_raw_111000_roll2_rate)\n\narea_raw_111000_roll2_1$rate[is.nan(area_raw_111000_roll2_1$rate) | is.infinite(area_raw_111000_roll2_1$rate)] <- 0\n\narea_raw_111000_roll2_opening<-area_raw_111000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_111000_roll2_final <- left_join(area_raw_111000_roll2_opening, area_raw_111000_roll2_1)\narea_raw_111000_roll2_final<-unique(area_raw_111000_roll2_final)\n\nrm(list=c('area_raw_111000_roll2_1','area_raw_111000_roll2_h12','area_raw_111000_roll2_h24','area_raw_111000_roll2_h36','area_raw_111000_roll2_h48','area_raw_111000_roll2_h2436','area_raw_111000_roll2_h3648','area_raw_111000_roll2_h2448',\n          'area_raw_111000_roll2_mean','area_raw_111000_roll2_rate','area_raw_111000_roll2_opening'))\n\nwrite.csv(area_raw_111000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_111000_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\narea_raw_112000_2<- left_join(area_raw_112000, area_recruit_sub)\n\narea_raw_112000_2$date_new <- as.POSIXct(area_raw_112000_2$date)\n\narea_raw_112000_2$diff <- (area_raw_112000_2$date_new - area_raw_112000_2$opening_dt_new)*60\narea_raw_112000_2 <- area_raw_112000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_112000_2$opening_dt_new\narea_raw_112000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_112000_roll2<- area_raw_112000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_112000_roll1<- area_raw_112000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_112000_roll1_1 <- area_raw_112000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_112000_roll1_h12 <- area_raw_112000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_112000_roll1_1 <- left_join(area_raw_112000_roll1_1, area_raw_112000_roll1_h12)\narea_raw_112000_roll1_h24 <- area_raw_112000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_112000_roll1_1 <- left_join(area_raw_112000_roll1_1, area_raw_112000_roll1_h24)\narea_raw_112000_roll1_h36 <- area_raw_112000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_112000_roll1_1 <- left_join(area_raw_112000_roll1_1, area_raw_112000_roll1_h36)\narea_raw_112000_roll1_h48 <- area_raw_112000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_112000_roll1_1 <- left_join(area_raw_112000_roll1_1, area_raw_112000_roll1_h48)\narea_raw_112000_roll1_etc <- area_raw_112000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_112000_roll1_1 <- left_join(area_raw_112000_roll1_1, area_raw_112000_roll1_etc)\n\narea_raw_112000_roll1_1$h12[is.na(area_raw_112000_roll1_1$h12)] <- 0\narea_raw_112000_roll1_1$h24[is.na(area_raw_112000_roll1_1$h24)] <- 0\narea_raw_112000_roll1_1$h36[is.na(area_raw_112000_roll1_1$h36)] <- 0\narea_raw_112000_roll1_1$h48[is.na(area_raw_112000_roll1_1$h48)] <- 0\narea_raw_112000_roll1_1$etc[is.na(area_raw_112000_roll1_1$etc)] <- 0\n\narea_raw_112000_roll1_h2436 <- area_raw_112000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_112000_roll1_1<-left_join(area_raw_112000_roll1_1, area_raw_112000_roll1_h2436)\narea_raw_112000_roll1_h3648 <- area_raw_112000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_112000_roll1_1<-left_join(area_raw_112000_roll1_1, area_raw_112000_roll1_h3648)\narea_raw_112000_roll1_h2448 <- area_raw_112000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_112000_roll1_1<-left_join(area_raw_112000_roll1_1, area_raw_112000_roll1_h2448)\n\narea_raw_112000_roll1_mean <- area_raw_112000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_112000_roll1_1<-left_join(area_raw_112000_roll1_1, area_raw_112000_roll1_mean)\n\narea_raw_112000_roll1_rate <- area_raw_112000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_112000_roll1_1<-left_join(area_raw_112000_roll1_1, area_raw_112000_roll1_rate)\n\narea_raw_112000_roll1_1$rate[is.nan(area_raw_112000_roll1_1$rate) | is.infinite(area_raw_112000_roll1_1$rate)] <- 0\n\n\narea_raw_112000_roll1_opening<-area_raw_112000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_112000_roll1_final <- left_join(area_raw_112000_roll1_opening, area_raw_112000_roll1_1)\narea_raw_112000_roll1_final<-unique(area_raw_112000_roll1_final)\n\nrm(list=c('area_raw_112000_roll1_1','area_raw_112000_roll1_h12','area_raw_112000_roll1_h24','area_raw_112000_roll1_h36','area_raw_112000_roll1_h48','area_raw_112000_roll1_h2436','area_raw_112000_roll1_h3648','area_raw_112000_roll1_h2448',\n          'area_raw_112000_roll1_mean','area_raw_112000_roll1_rate','area_raw_112000_roll1_opening'))\n\nwrite.csv(area_raw_112000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_112000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_112000_roll2_1 <- area_raw_112000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_112000_roll2_h12 <- area_raw_112000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_112000_roll2_1 <- left_join(area_raw_112000_roll2_1, area_raw_112000_roll2_h12)\narea_raw_112000_roll2_h24 <- area_raw_112000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_112000_roll2_1 <- left_join(area_raw_112000_roll2_1, area_raw_112000_roll2_h24)\narea_raw_112000_roll2_h36 <- area_raw_112000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_112000_roll2_1 <- left_join(area_raw_112000_roll2_1, area_raw_112000_roll2_h36)\narea_raw_112000_roll2_h48 <- area_raw_112000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_112000_roll2_1 <- left_join(area_raw_112000_roll2_1, area_raw_112000_roll2_h48)\narea_raw_112000_roll2_etc <- area_raw_112000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_112000_roll2_1 <- left_join(area_raw_112000_roll2_1, area_raw_112000_roll2_etc)\n\narea_raw_112000_roll2_1$h12[is.na(area_raw_112000_roll2_1$h12)] <- 0\narea_raw_112000_roll2_1$h24[is.na(area_raw_112000_roll2_1$h24)] <- 0\narea_raw_112000_roll2_1$h36[is.na(area_raw_112000_roll2_1$h36)] <- 0\narea_raw_112000_roll2_1$h48[is.na(area_raw_112000_roll2_1$h48)] <- 0\narea_raw_112000_roll2_1$etc[is.na(area_raw_112000_roll2_1$etc)] <- 0\n\narea_raw_112000_roll2_h2436 <- area_raw_112000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_112000_roll2_1<-left_join(area_raw_112000_roll2_1, area_raw_112000_roll2_h2436)\narea_raw_112000_roll2_h3648 <- area_raw_112000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_112000_roll2_1<-left_join(area_raw_112000_roll2_1, area_raw_112000_roll2_h3648)\narea_raw_112000_roll2_h2448 <- area_raw_112000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_112000_roll2_1<-left_join(area_raw_112000_roll2_1, area_raw_112000_roll2_h2448)\n\narea_raw_112000_roll2_mean <- area_raw_112000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_112000_roll2_1<-left_join(area_raw_112000_roll2_1, area_raw_112000_roll2_mean)\n\narea_raw_112000_roll2_rate <- area_raw_112000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_112000_roll2_1<-left_join(area_raw_112000_roll2_1, area_raw_112000_roll2_rate)\n\narea_raw_112000_roll2_1$rate[is.nan(area_raw_112000_roll2_1$rate) | is.infinite(area_raw_112000_roll2_1$rate)] <- 0\n\narea_raw_112000_roll2_opening<-area_raw_112000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_112000_roll2_final <- left_join(area_raw_112000_roll2_opening, area_raw_112000_roll2_1)\narea_raw_112000_roll2_final<-unique(area_raw_112000_roll2_final)\n\nrm(list=c('area_raw_112000_roll2_1','area_raw_112000_roll2_h12','area_raw_112000_roll2_h24','area_raw_112000_roll2_h36','area_raw_112000_roll2_h48','area_raw_112000_roll2_h2436','area_raw_112000_roll2_h3648','area_raw_112000_roll2_h2448',\n          'area_raw_112000_roll2_mean','area_raw_112000_roll2_rate','area_raw_112000_roll2_opening'))\n\nwrite.csv(area_raw_112000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_112000_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\narea_raw_113000_2<- left_join(area_raw_113000, area_recruit_sub)\n\narea_raw_113000_2$date_new <- as.POSIXct(area_raw_113000_2$date)\n\narea_raw_113000_2$diff <- (area_raw_113000_2$date_new - area_raw_113000_2$opening_dt_new)\narea_raw_113000_2 <- area_raw_113000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_113000_2$opening_dt_new\narea_raw_113000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_113000_roll2<- area_raw_113000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_113000_roll1<- area_raw_113000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_113000_roll1_1 <- area_raw_113000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_113000_roll1_h12 <- area_raw_113000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_113000_roll1_1 <- left_join(area_raw_113000_roll1_1, area_raw_113000_roll1_h12)\narea_raw_113000_roll1_h24 <- area_raw_113000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_113000_roll1_1 <- left_join(area_raw_113000_roll1_1, area_raw_113000_roll1_h24)\narea_raw_113000_roll1_h36 <- area_raw_113000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_113000_roll1_1 <- left_join(area_raw_113000_roll1_1, area_raw_113000_roll1_h36)\narea_raw_113000_roll1_h48 <- area_raw_113000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_113000_roll1_1 <- left_join(area_raw_113000_roll1_1, area_raw_113000_roll1_h48)\narea_raw_113000_roll1_etc <- area_raw_113000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_113000_roll1_1 <- left_join(area_raw_113000_roll1_1, area_raw_113000_roll1_etc)\n\narea_raw_113000_roll1_1$h12[is.na(area_raw_113000_roll1_1$h12)] <- 0\narea_raw_113000_roll1_1$h24[is.na(area_raw_113000_roll1_1$h24)] <- 0\narea_raw_113000_roll1_1$h36[is.na(area_raw_113000_roll1_1$h36)] <- 0\narea_raw_113000_roll1_1$h48[is.na(area_raw_113000_roll1_1$h48)] <- 0\narea_raw_113000_roll1_1$etc[is.na(area_raw_113000_roll1_1$etc)] <- 0\n\narea_raw_113000_roll1_h2436 <- area_raw_113000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_113000_roll1_1<-left_join(area_raw_113000_roll1_1, area_raw_113000_roll1_h2436)\narea_raw_113000_roll1_h3648 <- area_raw_113000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_113000_roll1_1<-left_join(area_raw_113000_roll1_1, area_raw_113000_roll1_h3648)\narea_raw_113000_roll1_h2448 <- area_raw_113000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_113000_roll1_1<-left_join(area_raw_113000_roll1_1, area_raw_113000_roll1_h2448)\n\narea_raw_113000_roll1_mean <- area_raw_113000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_113000_roll1_1<-left_join(area_raw_113000_roll1_1, area_raw_113000_roll1_mean)\n\narea_raw_113000_roll1_rate <- area_raw_113000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_113000_roll1_1<-left_join(area_raw_113000_roll1_1, area_raw_113000_roll1_rate)\n\narea_raw_113000_roll1_1$rate[is.nan(area_raw_113000_roll1_1$rate) | is.infinite(area_raw_113000_roll1_1$rate)] <- 0\n\n\narea_raw_113000_roll1_opening<-area_raw_113000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_113000_roll1_final <- left_join(area_raw_113000_roll1_opening, area_raw_113000_roll1_1)\narea_raw_113000_roll1_final<-unique(area_raw_113000_roll1_final)\n\nrm(list=c('area_raw_113000_roll1_1','area_raw_113000_roll1_h12','area_raw_113000_roll1_h24','area_raw_113000_roll1_h36','area_raw_113000_roll1_h48','area_raw_113000_roll1_h2436','area_raw_113000_roll1_h3648','area_raw_113000_roll1_h2448',\n          'area_raw_113000_roll1_mean','area_raw_113000_roll1_rate','area_raw_113000_roll1_opening'))\n\nwrite.csv(area_raw_113000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_113000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_113000_roll2_1 <- area_raw_113000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_113000_roll2_h12 <- area_raw_113000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_113000_roll2_1 <- left_join(area_raw_113000_roll2_1, area_raw_113000_roll2_h12)\narea_raw_113000_roll2_h24 <- area_raw_113000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_113000_roll2_1 <- left_join(area_raw_113000_roll2_1, area_raw_113000_roll2_h24)\narea_raw_113000_roll2_h36 <- area_raw_113000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_113000_roll2_1 <- left_join(area_raw_113000_roll2_1, area_raw_113000_roll2_h36)\narea_raw_113000_roll2_h48 <- area_raw_113000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_113000_roll2_1 <- left_join(area_raw_113000_roll2_1, area_raw_113000_roll2_h48)\narea_raw_113000_roll2_etc <- area_raw_113000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_113000_roll2_1 <- left_join(area_raw_113000_roll2_1, area_raw_113000_roll2_etc)\n\narea_raw_113000_roll2_1$h12[is.na(area_raw_113000_roll2_1$h12)] <- 0\narea_raw_113000_roll2_1$h24[is.na(area_raw_113000_roll2_1$h24)] <- 0\narea_raw_113000_roll2_1$h36[is.na(area_raw_113000_roll2_1$h36)] <- 0\narea_raw_113000_roll2_1$h48[is.na(area_raw_113000_roll2_1$h48)] <- 0\narea_raw_113000_roll2_1$etc[is.na(area_raw_113000_roll2_1$etc)] <- 0\n\narea_raw_113000_roll2_h2436 <- area_raw_113000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_113000_roll2_1<-left_join(area_raw_113000_roll2_1, area_raw_113000_roll2_h2436)\narea_raw_113000_roll2_h3648 <- area_raw_113000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_113000_roll2_1<-left_join(area_raw_113000_roll2_1, area_raw_113000_roll2_h3648)\narea_raw_113000_roll2_h2448 <- area_raw_113000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_113000_roll2_1<-left_join(area_raw_113000_roll2_1, area_raw_113000_roll2_h2448)\n\narea_raw_113000_roll2_mean <- area_raw_113000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_113000_roll2_1<-left_join(area_raw_113000_roll2_1, area_raw_113000_roll2_mean)\n\narea_raw_113000_roll2_rate <- area_raw_113000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_113000_roll2_1<-left_join(area_raw_113000_roll2_1, area_raw_113000_roll2_rate)\n\narea_raw_113000_roll2_1$rate[is.nan(area_raw_113000_roll2_1$rate) | is.infinite(area_raw_113000_roll2_1$rate)] <- 0\n\narea_raw_113000_roll2_opening<-area_raw_113000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_113000_roll2_final <- left_join(area_raw_113000_roll2_opening, area_raw_113000_roll2_1)\narea_raw_113000_roll2_final<-unique(area_raw_113000_roll2_final)\n\nrm(list=c('area_raw_113000_roll2_1','area_raw_113000_roll2_h12','area_raw_113000_roll2_h24','area_raw_113000_roll2_h36','area_raw_113000_roll2_h48','area_raw_113000_roll2_h2436','area_raw_113000_roll2_h3648','area_raw_113000_roll2_h2448',\n          'area_raw_113000_roll2_mean','area_raw_113000_roll2_rate','area_raw_113000_roll2_opening'))\n\nwrite.csv(area_raw_113000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_113000_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\narea_raw_114000_2<- left_join(area_raw_114000, area_recruit_sub)\n\narea_raw_114000_2$date_new <- as.POSIXct(area_raw_114000_2$date)\n\narea_raw_114000_2$diff <- (area_raw_114000_2$date_new - area_raw_114000_2$opening_dt_new)\narea_raw_114000_2 <- area_raw_114000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_114000_2$opening_dt_new\narea_raw_114000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_114000_roll2<- area_raw_114000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_114000_roll1<- area_raw_114000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_114000_roll1_1 <- area_raw_114000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_114000_roll1_h12 <- area_raw_114000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_114000_roll1_1 <- left_join(area_raw_114000_roll1_1, area_raw_114000_roll1_h12)\narea_raw_114000_roll1_h24 <- area_raw_114000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_114000_roll1_1 <- left_join(area_raw_114000_roll1_1, area_raw_114000_roll1_h24)\narea_raw_114000_roll1_h36 <- area_raw_114000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_114000_roll1_1 <- left_join(area_raw_114000_roll1_1, area_raw_114000_roll1_h36)\narea_raw_114000_roll1_h48 <- area_raw_114000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_114000_roll1_1 <- left_join(area_raw_114000_roll1_1, area_raw_114000_roll1_h48)\narea_raw_114000_roll1_etc <- area_raw_114000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_114000_roll1_1 <- left_join(area_raw_114000_roll1_1, area_raw_114000_roll1_etc)\n\n\narea_raw_114000_roll1_1$h12[is.na(area_raw_114000_roll1_1$h12)] <- 0\narea_raw_114000_roll1_1$h24[is.na(area_raw_114000_roll1_1$h24)] <- 0\narea_raw_114000_roll1_1$h36[is.na(area_raw_114000_roll1_1$h36)] <- 0\narea_raw_114000_roll1_1$h48[is.na(area_raw_114000_roll1_1$h48)] <- 0\narea_raw_114000_roll1_1$etc[is.na(area_raw_114000_roll1_1$etc)] <- 0\n\n\narea_raw_114000_roll1_h2436 <- area_raw_114000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_114000_roll1_1<-left_join(area_raw_114000_roll1_1, area_raw_114000_roll1_h2436)\narea_raw_114000_roll1_h3648 <- area_raw_114000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_114000_roll1_1<-left_join(area_raw_114000_roll1_1, area_raw_114000_roll1_h3648)\narea_raw_114000_roll1_h2448 <- area_raw_114000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_114000_roll1_1<-left_join(area_raw_114000_roll1_1, area_raw_114000_roll1_h2448)\n\narea_raw_114000_roll1_mean <- area_raw_114000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_114000_roll1_1<-left_join(area_raw_114000_roll1_1, area_raw_114000_roll1_mean)\n\narea_raw_114000_roll1_rate <- area_raw_114000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_114000_roll1_1<-left_join(area_raw_114000_roll1_1, area_raw_114000_roll1_rate)\n\narea_raw_114000_roll1_1$rate[is.nan(area_raw_114000_roll1_1$rate) | is.infinite(area_raw_114000_roll1_1$rate)] <- 0\n\n\narea_raw_114000_roll1_opening<-area_raw_114000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_114000_roll1_final <- left_join(area_raw_114000_roll1_opening, area_raw_114000_roll1_1)\narea_raw_114000_roll1_final<-unique(area_raw_114000_roll1_final)\n\nrm(list=c('area_raw_114000_roll1_1','area_raw_114000_roll1_h12','area_raw_114000_roll1_h24','area_raw_114000_roll1_h36','area_raw_114000_roll1_h48','area_raw_114000_roll1_h2436','area_raw_114000_roll1_h3648','area_raw_114000_roll1_h2448',\n          'area_raw_114000_roll1_mean','area_raw_114000_roll1_rate','area_raw_114000_roll1_opening'))\n\nwrite.csv(area_raw_114000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_114000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_114000_roll2_1 <- area_raw_114000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_114000_roll2_h12 <- area_raw_114000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_114000_roll2_1 <- left_join(area_raw_114000_roll2_1, area_raw_114000_roll2_h12)\narea_raw_114000_roll2_h24 <- area_raw_114000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_114000_roll2_1 <- left_join(area_raw_114000_roll2_1, area_raw_114000_roll2_h24)\narea_raw_114000_roll2_h36 <- area_raw_114000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_114000_roll2_1 <- left_join(area_raw_114000_roll2_1, area_raw_114000_roll2_h36)\narea_raw_114000_roll2_h48 <- area_raw_114000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_114000_roll2_1 <- left_join(area_raw_114000_roll2_1, area_raw_114000_roll2_h48)\narea_raw_114000_roll2_etc <- area_raw_114000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_114000_roll2_1 <- left_join(area_raw_114000_roll2_1, area_raw_114000_roll2_etc)\n\narea_raw_114000_roll2_1$h12[is.na(area_raw_114000_roll2_1$h12)] <- 0\narea_raw_114000_roll2_1$h24[is.na(area_raw_114000_roll2_1$h24)] <- 0\narea_raw_114000_roll2_1$h36[is.na(area_raw_114000_roll2_1$h36)] <- 0\narea_raw_114000_roll2_1$h48[is.na(area_raw_114000_roll2_1$h48)] <- 0\narea_raw_114000_roll2_1$etc[is.na(area_raw_114000_roll2_1$etc)] <- 0\n\narea_raw_114000_roll2_h2436 <- area_raw_114000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_114000_roll2_1<-left_join(area_raw_114000_roll2_1, area_raw_114000_roll2_h2436)\narea_raw_114000_roll2_h3648 <- area_raw_114000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_114000_roll2_1<-left_join(area_raw_114000_roll2_1, area_raw_114000_roll2_h3648)\narea_raw_114000_roll2_h2448 <- area_raw_114000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_114000_roll2_1<-left_join(area_raw_114000_roll2_1, area_raw_114000_roll2_h2448)\n\narea_raw_114000_roll2_mean <- area_raw_114000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_114000_roll2_1<-left_join(area_raw_114000_roll2_1, area_raw_114000_roll2_mean)\n\narea_raw_114000_roll2_rate <- area_raw_114000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_114000_roll2_1<-left_join(area_raw_114000_roll2_1, area_raw_114000_roll2_rate)\n\narea_raw_114000_roll2_1$rate[is.nan(area_raw_114000_roll2_1$rate) | is.infinite(area_raw_114000_roll2_1$rate)] <- 0\n\narea_raw_114000_roll2_opening<-area_raw_114000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_114000_roll2_final <- left_join(area_raw_114000_roll2_opening, area_raw_114000_roll2_1)\narea_raw_114000_roll2_final<-unique(area_raw_114000_roll2_final)\n\nrm(list=c('area_raw_114000_roll2_1','area_raw_114000_roll2_h12','area_raw_114000_roll2_h24','area_raw_114000_roll2_h36','area_raw_114000_roll2_h48','area_raw_114000_roll2_h2436','area_raw_114000_roll2_h3648','area_raw_114000_roll2_h2448',\n          'area_raw_114000_roll2_mean','area_raw_114000_roll2_rate','area_raw_114000_roll2_opening'))\n\nwrite.csv(area_raw_114000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_114000_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\narea_raw_115000_2<- left_join(area_raw_115000, area_recruit_sub)\n\narea_raw_115000_2$date_new <- as.POSIXct(area_raw_115000_2$date)\n\narea_raw_115000_2$diff <- (area_raw_115000_2$date_new - area_raw_115000_2$opening_dt_new)*60\narea_raw_115000_2 <- area_raw_115000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_115000_2$opening_dt_new\narea_raw_115000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_115000_roll2<- area_raw_115000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_115000_roll1<- area_raw_115000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_115000_roll1_1 <- area_raw_115000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_115000_roll1_h12 <- area_raw_115000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_115000_roll1_1 <- left_join(area_raw_115000_roll1_1, area_raw_115000_roll1_h12)\narea_raw_115000_roll1_h24 <- area_raw_115000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_115000_roll1_1 <- left_join(area_raw_115000_roll1_1, area_raw_115000_roll1_h24)\narea_raw_115000_roll1_h36 <- area_raw_115000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_115000_roll1_1 <- left_join(area_raw_115000_roll1_1, area_raw_115000_roll1_h36)\narea_raw_115000_roll1_h48 <- area_raw_115000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_115000_roll1_1 <- left_join(area_raw_115000_roll1_1, area_raw_115000_roll1_h48)\narea_raw_115000_roll1_etc <- area_raw_115000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_115000_roll1_1 <- left_join(area_raw_115000_roll1_1, area_raw_115000_roll1_etc)\n\narea_raw_115000_roll1_1$h12[is.na(area_raw_115000_roll1_1$h12)] <- 0\narea_raw_115000_roll1_1$h24[is.na(area_raw_115000_roll1_1$h24)] <- 0\narea_raw_115000_roll1_1$h36[is.na(area_raw_115000_roll1_1$h36)] <- 0\narea_raw_115000_roll1_1$h48[is.na(area_raw_115000_roll1_1$h48)] <- 0\narea_raw_115000_roll1_1$etc[is.na(area_raw_115000_roll1_1$etc)] <- 0\n\narea_raw_115000_roll1_h2436 <- area_raw_115000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_115000_roll1_1<-left_join(area_raw_115000_roll1_1, area_raw_115000_roll1_h2436)\narea_raw_115000_roll1_h3648 <- area_raw_115000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_115000_roll1_1<-left_join(area_raw_115000_roll1_1, area_raw_115000_roll1_h3648)\narea_raw_115000_roll1_h2448 <- area_raw_115000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_115000_roll1_1<-left_join(area_raw_115000_roll1_1, area_raw_115000_roll1_h2448)\n\narea_raw_115000_roll1_mean <- area_raw_115000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_115000_roll1_1<-left_join(area_raw_115000_roll1_1, area_raw_115000_roll1_mean)\n\narea_raw_115000_roll1_rate <- area_raw_115000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_115000_roll1_1<-left_join(area_raw_115000_roll1_1, area_raw_115000_roll1_rate)\n\narea_raw_115000_roll1_1$rate[is.nan(area_raw_115000_roll1_1$rate) | is.infinite(area_raw_115000_roll1_1$rate)] <- 0\n\n\narea_raw_115000_roll1_opening<-area_raw_115000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_115000_roll1_final <- left_join(area_raw_115000_roll1_opening, area_raw_115000_roll1_1)\narea_raw_115000_roll1_final<-unique(area_raw_115000_roll1_final)\n\nrm(list=c('area_raw_115000_roll1_1','area_raw_115000_roll1_h12','area_raw_115000_roll1_h24','area_raw_115000_roll1_h36','area_raw_115000_roll1_h48','area_raw_115000_roll1_h2436','area_raw_115000_roll1_h3648','area_raw_115000_roll1_h2448',\n          'area_raw_115000_roll1_mean','area_raw_115000_roll1_rate','area_raw_115000_roll1_opening'))\n\nwrite.csv(area_raw_115000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_115000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_115000_roll2_1 <- area_raw_115000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_115000_roll2_h12 <- area_raw_115000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_115000_roll2_1 <- left_join(area_raw_115000_roll2_1, area_raw_115000_roll2_h12)\narea_raw_115000_roll2_h24 <- area_raw_115000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_115000_roll2_1 <- left_join(area_raw_115000_roll2_1, area_raw_115000_roll2_h24)\narea_raw_115000_roll2_h36 <- area_raw_115000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_115000_roll2_1 <- left_join(area_raw_115000_roll2_1, area_raw_115000_roll2_h36)\narea_raw_115000_roll2_h48 <- area_raw_115000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_115000_roll2_1 <- left_join(area_raw_115000_roll2_1, area_raw_115000_roll2_h48)\narea_raw_115000_roll2_etc <- area_raw_115000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_115000_roll2_1 <- left_join(area_raw_115000_roll2_1, area_raw_115000_roll2_etc)\n\narea_raw_115000_roll2_1$h12[is.na(area_raw_115000_roll2_1$h12)] <- 0\narea_raw_115000_roll2_1$h24[is.na(area_raw_115000_roll2_1$h24)] <- 0\narea_raw_115000_roll2_1$h36[is.na(area_raw_115000_roll2_1$h36)] <- 0\narea_raw_115000_roll2_1$h48[is.na(area_raw_115000_roll2_1$h48)] <- 0\narea_raw_115000_roll2_1$etc[is.na(area_raw_115000_roll2_1$etc)] <- 0\n\narea_raw_115000_roll2_h2436 <- area_raw_115000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_115000_roll2_1<-left_join(area_raw_115000_roll2_1, area_raw_115000_roll2_h2436)\narea_raw_115000_roll2_h3648 <- area_raw_115000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_115000_roll2_1<-left_join(area_raw_115000_roll2_1, area_raw_115000_roll2_h3648)\narea_raw_115000_roll2_h2448 <- area_raw_115000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_115000_roll2_1<-left_join(area_raw_115000_roll2_1, area_raw_115000_roll2_h2448)\n\narea_raw_115000_roll2_mean <- area_raw_115000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_115000_roll2_1<-left_join(area_raw_115000_roll2_1, area_raw_115000_roll2_mean)\n\narea_raw_115000_roll2_rate <- area_raw_115000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_115000_roll2_1<-left_join(area_raw_115000_roll2_1, area_raw_115000_roll2_rate)\n\narea_raw_115000_roll2_1$rate[is.nan(area_raw_115000_roll2_1$rate) | is.infinite(area_raw_115000_roll2_1$rate)] <- 0\n\narea_raw_115000_roll2_opening<-area_raw_115000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_115000_roll2_final <- left_join(area_raw_115000_roll2_opening, area_raw_115000_roll2_1)\narea_raw_115000_roll2_final<-unique(area_raw_115000_roll2_final)\n\nrm(list=c('area_raw_115000_roll2_1','area_raw_115000_roll2_h12','area_raw_115000_roll2_h24','area_raw_115000_roll2_h36','area_raw_115000_roll2_h48','area_raw_115000_roll2_h2436','area_raw_115000_roll2_h3648','area_raw_115000_roll2_h2448',\n          'area_raw_115000_roll2_mean','area_raw_115000_roll2_rate','area_raw_115000_roll2_opening'))\n\nwrite.csv(area_raw_115000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_115000_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\narea_raw_116000_2<- left_join(area_raw_116000, area_recruit_sub)\n\narea_raw_116000_2$date_new <- as.POSIXct(area_raw_116000_2$date)\n\narea_raw_116000_2$diff <- (area_raw_116000_2$date_new - area_raw_116000_2$opening_dt_new)\narea_raw_116000_2 <- area_raw_116000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_116000_2$opening_dt_new\narea_raw_116000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_116000_roll2<- area_raw_116000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_116000_roll1<- area_raw_116000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_116000_roll1_1 <- area_raw_116000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_116000_roll1_h12 <- area_raw_116000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_116000_roll1_1 <- left_join(area_raw_116000_roll1_1, area_raw_116000_roll1_h12)\narea_raw_116000_roll1_h24 <- area_raw_116000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_116000_roll1_1 <- left_join(area_raw_116000_roll1_1, area_raw_116000_roll1_h24)\narea_raw_116000_roll1_h36 <- area_raw_116000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_116000_roll1_1 <- left_join(area_raw_116000_roll1_1, area_raw_116000_roll1_h36)\narea_raw_116000_roll1_h48 <- area_raw_116000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_116000_roll1_1 <- left_join(area_raw_116000_roll1_1, area_raw_116000_roll1_h48)\narea_raw_116000_roll1_etc <- area_raw_116000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_116000_roll1_1 <- left_join(area_raw_116000_roll1_1, area_raw_116000_roll1_etc)\n\n\narea_raw_116000_roll1_1$h12[is.na(area_raw_116000_roll1_1$h12)] <- 0\narea_raw_116000_roll1_1$h24[is.na(area_raw_116000_roll1_1$h24)] <- 0\narea_raw_116000_roll1_1$h36[is.na(area_raw_116000_roll1_1$h36)] <- 0\narea_raw_116000_roll1_1$h48[is.na(area_raw_116000_roll1_1$h48)] <- 0\narea_raw_116000_roll1_1$etc[is.na(area_raw_116000_roll1_1$etc)] <- 0\n\narea_raw_116000_roll1_h2436 <- area_raw_116000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_116000_roll1_1<-left_join(area_raw_116000_roll1_1, area_raw_116000_roll1_h2436)\narea_raw_116000_roll1_h3648 <- area_raw_116000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_116000_roll1_1<-left_join(area_raw_116000_roll1_1, area_raw_116000_roll1_h3648)\narea_raw_116000_roll1_h2448 <- area_raw_116000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_116000_roll1_1<-left_join(area_raw_116000_roll1_1, area_raw_116000_roll1_h2448)\n\narea_raw_116000_roll1_mean <- area_raw_116000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_116000_roll1_1<-left_join(area_raw_116000_roll1_1, area_raw_116000_roll1_mean)\n\narea_raw_116000_roll1_rate <- area_raw_116000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_116000_roll1_1<-left_join(area_raw_116000_roll1_1, area_raw_116000_roll1_rate)\n\narea_raw_116000_roll1_1$rate[is.nan(area_raw_116000_roll1_1$rate) | is.infinite(area_raw_116000_roll1_1$rate)] <- 0\n\n\narea_raw_116000_roll1_opening<-area_raw_116000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_116000_roll1_final <- left_join(area_raw_116000_roll1_opening, area_raw_116000_roll1_1)\narea_raw_116000_roll1_final<-unique(area_raw_116000_roll1_final)\n\nrm(list=c('area_raw_116000_roll1_1','area_raw_116000_roll1_h12','area_raw_116000_roll1_h24','area_raw_116000_roll1_h36','area_raw_116000_roll1_h48','area_raw_116000_roll1_h2436','area_raw_116000_roll1_h3648','area_raw_116000_roll1_h2448',\n          'area_raw_116000_roll1_mean','area_raw_116000_roll1_rate','area_raw_116000_roll1_opening'))\n\nwrite.csv(area_raw_116000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_116000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_116000_roll2_1 <- area_raw_116000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_116000_roll2_h12 <- area_raw_116000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_116000_roll2_1 <- left_join(area_raw_116000_roll2_1, area_raw_116000_roll2_h12)\narea_raw_116000_roll2_h24 <- area_raw_116000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_116000_roll2_1 <- left_join(area_raw_116000_roll2_1, area_raw_116000_roll2_h24)\narea_raw_116000_roll2_h36 <- area_raw_116000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_116000_roll2_1 <- left_join(area_raw_116000_roll2_1, area_raw_116000_roll2_h36)\narea_raw_116000_roll2_h48 <- area_raw_116000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_116000_roll2_1 <- left_join(area_raw_116000_roll2_1, area_raw_116000_roll2_h48)\narea_raw_116000_roll2_etc <- area_raw_116000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_116000_roll2_1 <- left_join(area_raw_116000_roll2_1, area_raw_116000_roll2_etc)\n\n\narea_raw_116000_roll2_1$h12[is.na(area_raw_116000_roll2_1$h12)] <- 0\narea_raw_116000_roll2_1$h24[is.na(area_raw_116000_roll2_1$h24)] <- 0\narea_raw_116000_roll2_1$h36[is.na(area_raw_116000_roll2_1$h36)] <- 0\narea_raw_116000_roll2_1$h48[is.na(area_raw_116000_roll2_1$h48)] <- 0\narea_raw_116000_roll2_1$etc[is.na(area_raw_116000_roll2_1$etc)] <- 0\n\narea_raw_116000_roll2_h2436 <- area_raw_116000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_116000_roll2_1<-left_join(area_raw_116000_roll2_1, area_raw_116000_roll2_h2436)\narea_raw_116000_roll2_h3648 <- area_raw_116000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_116000_roll2_1<-left_join(area_raw_116000_roll2_1, area_raw_116000_roll2_h3648)\narea_raw_116000_roll2_h2448 <- area_raw_116000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_116000_roll2_1<-left_join(area_raw_116000_roll2_1, area_raw_116000_roll2_h2448)\n\narea_raw_116000_roll2_mean <- area_raw_116000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_116000_roll2_1<-left_join(area_raw_116000_roll2_1, area_raw_116000_roll2_mean)\n\narea_raw_116000_roll2_rate <- area_raw_116000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_116000_roll2_1<-left_join(area_raw_116000_roll2_1, area_raw_116000_roll2_rate)\n\narea_raw_116000_roll2_1$rate[is.nan(area_raw_116000_roll2_1$rate) | is.infinite(area_raw_116000_roll2_1$rate)] <- 0\n\narea_raw_116000_roll2_opening<-area_raw_116000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_116000_roll2_final <- left_join(area_raw_116000_roll2_opening, area_raw_116000_roll2_1)\narea_raw_116000_roll2_final<-unique(area_raw_116000_roll2_final)\n\nrm(list=c('area_raw_116000_roll2_1','area_raw_116000_roll2_h12','area_raw_116000_roll2_h24','area_raw_116000_roll2_h36','area_raw_116000_roll2_h48','area_raw_116000_roll2_h2436','area_raw_116000_roll2_h3648','area_raw_116000_roll2_h2448',\n          'area_raw_116000_roll2_mean','area_raw_116000_roll2_rate','area_raw_116000_roll2_opening'))\n\nwrite.csv(area_raw_116000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_116000_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\narea_raw_117000_2<- left_join(area_raw_117000, area_recruit_sub)\n\narea_raw_117000_2$date_new <- as.POSIXct(area_raw_117000_2$date)\n\narea_raw_117000_2$diff <- (area_raw_117000_2$date_new - area_raw_117000_2$opening_dt_new)*60\narea_raw_117000_2 <- area_raw_117000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_117000_2$opening_dt_new\narea_raw_117000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_117000_roll2<- area_raw_117000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_117000_roll1<- area_raw_117000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_117000_roll1_1 <- area_raw_117000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_117000_roll1_h12 <- area_raw_117000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_117000_roll1_1 <- left_join(area_raw_117000_roll1_1, area_raw_117000_roll1_h12)\narea_raw_117000_roll1_h24 <- area_raw_117000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_117000_roll1_1 <- left_join(area_raw_117000_roll1_1, area_raw_117000_roll1_h24)\narea_raw_117000_roll1_h36 <- area_raw_117000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_117000_roll1_1 <- left_join(area_raw_117000_roll1_1, area_raw_117000_roll1_h36)\narea_raw_117000_roll1_h48 <- area_raw_117000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_117000_roll1_1 <- left_join(area_raw_117000_roll1_1, area_raw_117000_roll1_h48)\narea_raw_117000_roll1_etc <- area_raw_117000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_117000_roll1_1 <- left_join(area_raw_117000_roll1_1, area_raw_117000_roll1_etc)\n\narea_raw_117000_roll1_1$h12[is.na(area_raw_117000_roll1_1$h12)] <- 0\narea_raw_117000_roll1_1$h24[is.na(area_raw_117000_roll1_1$h24)] <- 0\narea_raw_117000_roll1_1$h36[is.na(area_raw_117000_roll1_1$h36)] <- 0\narea_raw_117000_roll1_1$h48[is.na(area_raw_117000_roll1_1$h48)] <- 0\narea_raw_117000_roll1_1$etc[is.na(area_raw_117000_roll1_1$etc)] <- 0\n\narea_raw_117000_roll1_h2436 <- area_raw_117000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_117000_roll1_1<-left_join(area_raw_117000_roll1_1, area_raw_117000_roll1_h2436)\narea_raw_117000_roll1_h3648 <- area_raw_117000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_117000_roll1_1<-left_join(area_raw_117000_roll1_1, area_raw_117000_roll1_h3648)\narea_raw_117000_roll1_h2448 <- area_raw_117000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_117000_roll1_1<-left_join(area_raw_117000_roll1_1, area_raw_117000_roll1_h2448)\n\narea_raw_117000_roll1_mean <- area_raw_117000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_117000_roll1_1<-left_join(area_raw_117000_roll1_1, area_raw_117000_roll1_mean)\n\narea_raw_117000_roll1_rate <- area_raw_117000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_117000_roll1_1<-left_join(area_raw_117000_roll1_1, area_raw_117000_roll1_rate)\n\narea_raw_117000_roll1_1$rate[is.nan(area_raw_117000_roll1_1$rate) | is.infinite(area_raw_117000_roll1_1$rate)] <- 0\n\n\narea_raw_117000_roll1_opening<-area_raw_117000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_117000_roll1_final <- left_join(area_raw_117000_roll1_opening, area_raw_117000_roll1_1)\narea_raw_117000_roll1_final<-unique(area_raw_117000_roll1_final)\n\nrm(list=c('area_raw_117000_roll1_1','area_raw_117000_roll1_h12','area_raw_117000_roll1_h24','area_raw_117000_roll1_h36','area_raw_117000_roll1_h48','area_raw_117000_roll1_h2436','area_raw_117000_roll1_h3648','area_raw_117000_roll1_h2448',\n          'area_raw_117000_roll1_mean','area_raw_117000_roll1_rate','area_raw_117000_roll1_opening'))\n\nwrite.csv(area_raw_117000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_117000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_117000_roll2_1 <- area_raw_117000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_117000_roll2_h12 <- area_raw_117000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_117000_roll2_1 <- left_join(area_raw_117000_roll2_1, area_raw_117000_roll2_h12)\narea_raw_117000_roll2_h24 <- area_raw_117000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_117000_roll2_1 <- left_join(area_raw_117000_roll2_1, area_raw_117000_roll2_h24)\narea_raw_117000_roll2_h36 <- area_raw_117000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_117000_roll2_1 <- left_join(area_raw_117000_roll2_1, area_raw_117000_roll2_h36)\narea_raw_117000_roll2_h48 <- area_raw_117000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_117000_roll2_1 <- left_join(area_raw_117000_roll2_1, area_raw_117000_roll2_h48)\narea_raw_117000_roll2_etc <- area_raw_117000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_117000_roll2_1 <- left_join(area_raw_117000_roll2_1, area_raw_117000_roll2_etc)\n\narea_raw_117000_roll2_1$h12[is.na(area_raw_117000_roll2_1$h12)] <- 0\narea_raw_117000_roll2_1$h24[is.na(area_raw_117000_roll2_1$h24)] <- 0\narea_raw_117000_roll2_1$h36[is.na(area_raw_117000_roll2_1$h36)] <- 0\narea_raw_117000_roll2_1$h48[is.na(area_raw_117000_roll2_1$h48)] <- 0\narea_raw_117000_roll2_1$etc[is.na(area_raw_117000_roll2_1$etc)] <- 0\n\narea_raw_117000_roll2_h2436 <- area_raw_117000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_117000_roll2_1<-left_join(area_raw_117000_roll2_1, area_raw_117000_roll2_h2436)\narea_raw_117000_roll2_h3648 <- area_raw_117000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_117000_roll2_1<-left_join(area_raw_117000_roll2_1, area_raw_117000_roll2_h3648)\narea_raw_117000_roll2_h2448 <- area_raw_117000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_117000_roll2_1<-left_join(area_raw_117000_roll2_1, area_raw_117000_roll2_h2448)\n\narea_raw_117000_roll2_mean <- area_raw_117000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_117000_roll2_1<-left_join(area_raw_117000_roll2_1, area_raw_117000_roll2_mean)\n\narea_raw_117000_roll2_rate <- area_raw_117000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_117000_roll2_1<-left_join(area_raw_117000_roll2_1, area_raw_117000_roll2_rate)\n\narea_raw_117000_roll2_1$rate[is.nan(area_raw_117000_roll2_1$rate) | is.infinite(area_raw_117000_roll2_1$rate)] <- 0\n\narea_raw_117000_roll2_opening<-area_raw_117000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_117000_roll2_final <- left_join(area_raw_117000_roll2_opening, area_raw_117000_roll2_1)\narea_raw_117000_roll2_final<-unique(area_raw_117000_roll2_final)\n\nrm(list=c('area_raw_117000_roll2_1','area_raw_117000_roll2_h12','area_raw_117000_roll2_h24','area_raw_117000_roll2_h36','area_raw_117000_roll2_h48','area_raw_117000_roll2_h2436','area_raw_117000_roll2_h3648','area_raw_117000_roll2_h2448',\n          'area_raw_117000_roll2_mean','area_raw_117000_roll2_rate','area_raw_117000_roll2_opening'))\n\nwrite.csv(area_raw_117000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_117000_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\narea_raw_118000_2<- left_join(area_raw_118000, area_recruit_sub)\n\narea_raw_118000_2$date_new <- as.POSIXct(area_raw_118000_2$date)\n\narea_raw_118000_2$diff <- (area_raw_118000_2$date_new - area_raw_118000_2$opening_dt_new)*60\narea_raw_118000_2 <- area_raw_118000_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-area_raw_118000_2$opening_dt_new\narea_raw_118000_2$dtparts <- format(as, \"%H:%M:%S\")\narea_raw_118000_roll2<- area_raw_118000_2 %>% filter(dtparts>=\"12:00:00\")\narea_raw_118000_roll1<- area_raw_118000_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\narea_raw_118000_roll1_1 <- area_raw_118000_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_118000_roll1_h12 <- area_raw_118000_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_118000_roll1_1 <- left_join(area_raw_118000_roll1_1, area_raw_118000_roll1_h12)\narea_raw_118000_roll1_h24 <- area_raw_118000_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_118000_roll1_1 <- left_join(area_raw_118000_roll1_1, area_raw_118000_roll1_h24)\narea_raw_118000_roll1_h36 <- area_raw_118000_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_118000_roll1_1 <- left_join(area_raw_118000_roll1_1, area_raw_118000_roll1_h36)\narea_raw_118000_roll1_h48 <- area_raw_118000_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_118000_roll1_1 <- left_join(area_raw_118000_roll1_1, area_raw_118000_roll1_h48)\narea_raw_118000_roll1_etc <- area_raw_118000_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_118000_roll1_1 <- left_join(area_raw_118000_roll1_1, area_raw_118000_roll1_etc)\n\narea_raw_118000_roll1_1$h12[is.na(area_raw_118000_roll1_1$h12)] <- 0\narea_raw_118000_roll1_1$h24[is.na(area_raw_118000_roll1_1$h24)] <- 0\narea_raw_118000_roll1_1$h36[is.na(area_raw_118000_roll1_1$h36)] <- 0\narea_raw_118000_roll1_1$h48[is.na(area_raw_118000_roll1_1$h48)] <- 0\narea_raw_118000_roll1_1$etc[is.na(area_raw_118000_roll1_1$etc)] <- 0\n\narea_raw_118000_roll1_h2436 <- area_raw_118000_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_118000_roll1_1<-left_join(area_raw_118000_roll1_1, area_raw_118000_roll1_h2436)\narea_raw_118000_roll1_h3648 <- area_raw_118000_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_118000_roll1_1<-left_join(area_raw_118000_roll1_1, area_raw_118000_roll1_h3648)\narea_raw_118000_roll1_h2448 <- area_raw_118000_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_118000_roll1_1<-left_join(area_raw_118000_roll1_1, area_raw_118000_roll1_h2448)\n\narea_raw_118000_roll1_mean <- area_raw_118000_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\narea_raw_118000_roll1_1<-left_join(area_raw_118000_roll1_1, area_raw_118000_roll1_mean)\n\narea_raw_118000_roll1_rate <- area_raw_118000_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_118000_roll1_1<-left_join(area_raw_118000_roll1_1, area_raw_118000_roll1_rate)\n\narea_raw_118000_roll1_1$rate[is.nan(area_raw_118000_roll1_1$rate) | is.infinite(area_raw_118000_roll1_1$rate)] <- 0\n\n\narea_raw_118000_roll1_opening<-area_raw_118000_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_118000_roll1_final <- left_join(area_raw_118000_roll1_opening, area_raw_118000_roll1_1)\narea_raw_118000_roll1_final<-unique(area_raw_118000_roll1_final)\n\nrm(list=c('area_raw_118000_roll1_1','area_raw_118000_roll1_h12','area_raw_118000_roll1_h24','area_raw_118000_roll1_h36','area_raw_118000_roll1_h48','area_raw_118000_roll1_h2436','area_raw_118000_roll1_h3648','area_raw_118000_roll1_h2448',\n          'area_raw_118000_roll1_mean','area_raw_118000_roll1_rate','area_raw_118000_roll1_opening'))\n\nwrite.csv(area_raw_118000_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_118000_roll1_final.csv\")     \n\n\n# roll 2\narea_raw_118000_roll2_1 <- area_raw_118000_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\narea_raw_118000_roll2_h12 <- area_raw_118000_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\narea_raw_118000_roll2_1 <- left_join(area_raw_118000_roll2_1, area_raw_118000_roll2_h12)\narea_raw_118000_roll2_h24 <- area_raw_118000_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\narea_raw_118000_roll2_1 <- left_join(area_raw_118000_roll2_1, area_raw_118000_roll2_h24)\narea_raw_118000_roll2_h36 <- area_raw_118000_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\narea_raw_118000_roll2_1 <- left_join(area_raw_118000_roll2_1, area_raw_118000_roll2_h36)\narea_raw_118000_roll2_h48 <- area_raw_118000_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\narea_raw_118000_roll2_1 <- left_join(area_raw_118000_roll2_1, area_raw_118000_roll2_h48)\narea_raw_118000_roll2_etc <- area_raw_118000_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\narea_raw_118000_roll2_1 <- left_join(area_raw_118000_roll2_1, area_raw_118000_roll2_etc)\n\narea_raw_118000_roll2_1$h12[is.na(area_raw_118000_roll2_1$h12)] <- 0\narea_raw_118000_roll2_1$h24[is.na(area_raw_118000_roll2_1$h24)] <- 0\narea_raw_118000_roll2_1$h36[is.na(area_raw_118000_roll2_1$h36)] <- 0\narea_raw_118000_roll2_1$h48[is.na(area_raw_118000_roll2_1$h48)] <- 0\narea_raw_118000_roll2_1$etc[is.na(area_raw_118000_roll2_1$etc)] <- 0\n\narea_raw_118000_roll2_h2436 <- area_raw_118000_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\narea_raw_118000_roll2_1<-left_join(area_raw_118000_roll2_1, area_raw_118000_roll2_h2436)\narea_raw_118000_roll2_h3648 <- area_raw_118000_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\narea_raw_118000_roll2_1<-left_join(area_raw_118000_roll2_1, area_raw_118000_roll2_h3648)\narea_raw_118000_roll2_h2448 <- area_raw_118000_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\narea_raw_118000_roll2_1<-left_join(area_raw_118000_roll2_1, area_raw_118000_roll2_h2448)\n\narea_raw_118000_roll2_mean <- area_raw_118000_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\narea_raw_118000_roll2_1<-left_join(area_raw_118000_roll2_1, area_raw_118000_roll2_mean)\n\narea_raw_118000_roll2_rate <- area_raw_118000_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\narea_raw_118000_roll2_1<-left_join(area_raw_118000_roll2_1, area_raw_118000_roll2_rate)\n\narea_raw_118000_roll2_1$rate[is.nan(area_raw_118000_roll2_1$rate) | is.infinite(area_raw_118000_roll2_1$rate)] <- 0\n\narea_raw_118000_roll2_opening<-area_raw_118000_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\narea_raw_118000_roll2_final <- left_join(area_raw_118000_roll2_opening, area_raw_118000_roll2_1)\narea_raw_118000_roll2_final<-unique(area_raw_118000_roll2_final)\n\nrm(list=c('area_raw_118000_roll2_1','area_raw_118000_roll2_h12','area_raw_118000_roll2_h24','area_raw_118000_roll2_h36','area_raw_118000_roll2_h48','area_raw_118000_roll2_h2436','area_raw_118000_roll2_h3648','area_raw_118000_roll2_h2448',\n          'area_raw_118000_roll2_mean','area_raw_118000_roll2_rate','area_raw_118000_roll2_opening'))\n\nwrite.csv(area_raw_118000_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/area_raw_118000_roll2_final.csv\")     \n\n\n##############################################################################################################################\n#                                                        ??Á¾(job)                                                           #\n##############################################################################################################################\n\n\njob_raw_7C1_2<- left_join(job_raw_7C1, job_recruit_sub)\n\njob_raw_7C1_2$date_new <- as.POSIXct(job_raw_7C1_2$date)\n\njob_raw_7C1_2$diff <- (job_raw_7C1_2$date_new - job_raw_7C1_2$opening_dt_new)\njob_raw_7C1_2 <- job_raw_7C1_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-job_raw_7C1_2$opening_dt_new\njob_raw_7C1_2$dtparts <- format(as, \"%H:%M:%S\")\njob_raw_7C1_roll2<- job_raw_7C1_2 %>% filter(dtparts>=\"12:00:00\")\njob_raw_7C1_roll1<- job_raw_7C1_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\njob_raw_7C1_roll1_1 <- job_raw_7C1_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C1_roll1_h12 <- job_raw_7C1_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C1_roll1_1 <- left_join(job_raw_7C1_roll1_1, job_raw_7C1_roll1_h12)\njob_raw_7C1_roll1_h24 <- job_raw_7C1_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C1_roll1_1 <- left_join(job_raw_7C1_roll1_1, job_raw_7C1_roll1_h24)\njob_raw_7C1_roll1_h36 <- job_raw_7C1_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C1_roll1_1 <- left_join(job_raw_7C1_roll1_1, job_raw_7C1_roll1_h36)\njob_raw_7C1_roll1_h48 <- job_raw_7C1_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C1_roll1_1 <- left_join(job_raw_7C1_roll1_1, job_raw_7C1_roll1_h48)\njob_raw_7C1_roll1_etc <- job_raw_7C1_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C1_roll1_1 <- left_join(job_raw_7C1_roll1_1, job_raw_7C1_roll1_etc)\n\njob_raw_7C1_roll1_1$h12[is.na(job_raw_7C1_roll1_1$h12)] <- 0\njob_raw_7C1_roll1_1$h24[is.na(job_raw_7C1_roll1_1$h24)] <- 0\njob_raw_7C1_roll1_1$h36[is.na(job_raw_7C1_roll1_1$h36)] <- 0\njob_raw_7C1_roll1_1$h48[is.na(job_raw_7C1_roll1_1$h48)] <- 0\njob_raw_7C1_roll1_1$etc[is.na(job_raw_7C1_roll1_1$etc)] <- 0\n\njob_raw_7C1_roll1_h2436 <- job_raw_7C1_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C1_roll1_1<-left_join(job_raw_7C1_roll1_1, job_raw_7C1_roll1_h2436)\njob_raw_7C1_roll1_h3648 <- job_raw_7C1_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C1_roll1_1<-left_join(job_raw_7C1_roll1_1, job_raw_7C1_roll1_h3648)\njob_raw_7C1_roll1_h2448 <- job_raw_7C1_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C1_roll1_1<-left_join(job_raw_7C1_roll1_1, job_raw_7C1_roll1_h2448)\n\njob_raw_7C1_roll1_mean <- job_raw_7C1_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\njob_raw_7C1_roll1_1<-left_join(job_raw_7C1_roll1_1, job_raw_7C1_roll1_mean)\n\njob_raw_7C1_roll1_rate <- job_raw_7C1_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C1_roll1_1<-left_join(job_raw_7C1_roll1_1, job_raw_7C1_roll1_rate)\n\njob_raw_7C1_roll1_1$rate[is.nan(job_raw_7C1_roll1_1$rate) | is.infinite(job_raw_7C1_roll1_1$rate)] <- 0\n\n\njob_raw_7C1_roll1_opening<-job_raw_7C1_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C1_roll1_final <- left_join(job_raw_7C1_roll1_opening, job_raw_7C1_roll1_1)\njob_raw_7C1_roll1_final<-unique(job_raw_7C1_roll1_final)\n\nrm(list=c('job_raw_7C1_roll1_1','job_raw_7C1_roll1_h12','job_raw_7C1_roll1_h24','job_raw_7C1_roll1_h36','job_raw_7C1_roll1_h48','job_raw_7C1_roll1_h2436','job_raw_7C1_roll1_h3648','job_raw_7C1_roll1_h2448',\n          'job_raw_7C1_roll1_mean','job_raw_7C1_roll1_rate','job_raw_7C1_roll1_opening'))\n\nwrite.csv(job_raw_7C1_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C1_roll1_final.csv\")     \n\n\n# roll 2\njob_raw_7C1_roll2_1 <- job_raw_7C1_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C1_roll2_h12 <- job_raw_7C1_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C1_roll2_1 <- left_join(job_raw_7C1_roll2_1, job_raw_7C1_roll2_h12)\njob_raw_7C1_roll2_h24 <- job_raw_7C1_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C1_roll2_1 <- left_join(job_raw_7C1_roll2_1, job_raw_7C1_roll2_h24)\njob_raw_7C1_roll2_h36 <- job_raw_7C1_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C1_roll2_1 <- left_join(job_raw_7C1_roll2_1, job_raw_7C1_roll2_h36)\njob_raw_7C1_roll2_h48 <- job_raw_7C1_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C1_roll2_1 <- left_join(job_raw_7C1_roll2_1, job_raw_7C1_roll2_h48)\njob_raw_7C1_roll2_etc <- job_raw_7C1_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C1_roll2_1 <- left_join(job_raw_7C1_roll2_1, job_raw_7C1_roll2_etc)\n\njob_raw_7C1_roll2_1$h12[is.na(job_raw_7C1_roll2_1$h12)] <- 0\njob_raw_7C1_roll2_1$h24[is.na(job_raw_7C1_roll2_1$h24)] <- 0\njob_raw_7C1_roll2_1$h36[is.na(job_raw_7C1_roll2_1$h36)] <- 0\njob_raw_7C1_roll2_1$h48[is.na(job_raw_7C1_roll2_1$h48)] <- 0\njob_raw_7C1_roll2_1$etc[is.na(job_raw_7C1_roll2_1$etc)] <- 0\n\njob_raw_7C1_roll2_h2436 <- job_raw_7C1_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C1_roll2_1<-left_join(job_raw_7C1_roll2_1, job_raw_7C1_roll2_h2436)\njob_raw_7C1_roll2_h3648 <- job_raw_7C1_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C1_roll2_1<-left_join(job_raw_7C1_roll2_1, job_raw_7C1_roll2_h3648)\njob_raw_7C1_roll2_h2448 <- job_raw_7C1_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C1_roll2_1<-left_join(job_raw_7C1_roll2_1, job_raw_7C1_roll2_h2448)\n\njob_raw_7C1_roll2_mean <- job_raw_7C1_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\njob_raw_7C1_roll2_1<-left_join(job_raw_7C1_roll2_1, job_raw_7C1_roll2_mean)\n\njob_raw_7C1_roll2_rate <- job_raw_7C1_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C1_roll2_1<-left_join(job_raw_7C1_roll2_1, job_raw_7C1_roll2_rate)\n\njob_raw_7C1_roll2_1$rate[is.nan(job_raw_7C1_roll2_1$rate) | is.infinite(job_raw_7C1_roll2_1$rate)] <- 0\n\njob_raw_7C1_roll2_opening<-job_raw_7C1_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C1_roll2_final <- left_join(job_raw_7C1_roll2_opening, job_raw_7C1_roll2_1)\njob_raw_7C1_roll2_final<-unique(job_raw_7C1_roll2_final)\n\nrm(list=c('job_raw_7C1_roll2_1','job_raw_7C1_roll2_h12','job_raw_7C1_roll2_h24','job_raw_7C1_roll2_h36','job_raw_7C1_roll2_h48','job_raw_7C1_roll2_h2436','job_raw_7C1_roll2_h3648','job_raw_7C1_roll2_h2448',\n          'job_raw_7C1_roll2_mean','job_raw_7C1_roll2_rate','job_raw_7C1_roll2_opening'))\n\n\nwrite.csv(job_raw_7C1_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C1_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\njob_raw_7C2_2<- left_join(job_raw_7C2, job_recruit_sub)\n\njob_raw_7C2_2$date_new <- as.POSIXct(job_raw_7C2_2$date)\n\njob_raw_7C2_2$diff <- (job_raw_7C2_2$date_new - job_raw_7C2_2$opening_dt_new)*60\njob_raw_7C2_2 <- job_raw_7C2_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-job_raw_7C2_2$opening_dt_new\njob_raw_7C2_2$dtparts <- format(as, \"%H:%M:%S\")\njob_raw_7C2_roll2<- job_raw_7C2_2 %>% filter(dtparts>=\"12:00:00\")\njob_raw_7C2_roll1<- job_raw_7C2_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\njob_raw_7C2_roll1_1 <- job_raw_7C2_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C2_roll1_h12 <- job_raw_7C2_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C2_roll1_1 <- left_join(job_raw_7C2_roll1_1, job_raw_7C2_roll1_h12)\njob_raw_7C2_roll1_h24 <- job_raw_7C2_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C2_roll1_1 <- left_join(job_raw_7C2_roll1_1, job_raw_7C2_roll1_h24)\njob_raw_7C2_roll1_h36 <- job_raw_7C2_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C2_roll1_1 <- left_join(job_raw_7C2_roll1_1, job_raw_7C2_roll1_h36)\njob_raw_7C2_roll1_h48 <- job_raw_7C2_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C2_roll1_1 <- left_join(job_raw_7C2_roll1_1, job_raw_7C2_roll1_h48)\njob_raw_7C2_roll1_etc <- job_raw_7C2_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C2_roll1_1 <- left_join(job_raw_7C2_roll1_1, job_raw_7C2_roll1_etc)\n\n\njob_raw_7C2_roll1_1$h12[is.na(job_raw_7C2_roll1_1$h12)] <- 0\njob_raw_7C2_roll1_1$h24[is.na(job_raw_7C2_roll1_1$h24)] <- 0\njob_raw_7C2_roll1_1$h36[is.na(job_raw_7C2_roll1_1$h36)] <- 0\njob_raw_7C2_roll1_1$h48[is.na(job_raw_7C2_roll1_1$h48)] <- 0\njob_raw_7C2_roll1_1$etc[is.na(job_raw_7C2_roll1_1$etc)] <- 0\n\n\njob_raw_7C2_roll1_h2436 <- job_raw_7C2_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C2_roll1_1<-left_join(job_raw_7C2_roll1_1, job_raw_7C2_roll1_h2436)\njob_raw_7C2_roll1_h3648 <- job_raw_7C2_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C2_roll1_1<-left_join(job_raw_7C2_roll1_1, job_raw_7C2_roll1_h3648)\njob_raw_7C2_roll1_h2448 <- job_raw_7C2_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C2_roll1_1<-left_join(job_raw_7C2_roll1_1, job_raw_7C2_roll1_h2448)\n\njob_raw_7C2_roll1_mean <- job_raw_7C2_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\njob_raw_7C2_roll1_1<-left_join(job_raw_7C2_roll1_1, job_raw_7C2_roll1_mean)\n\njob_raw_7C2_roll1_rate <- job_raw_7C2_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C2_roll1_1<-left_join(job_raw_7C2_roll1_1, job_raw_7C2_roll1_rate)\n\njob_raw_7C2_roll1_1$rate[is.nan(job_raw_7C2_roll1_1$rate) | is.infinite(job_raw_7C2_roll1_1$rate)] <- 0\n\n\njob_raw_7C2_roll1_opening<-job_raw_7C2_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C2_roll1_final <- left_join(job_raw_7C2_roll1_opening, job_raw_7C2_roll1_1)\njob_raw_7C2_roll1_final<-unique(job_raw_7C2_roll1_final)\n\nrm(list=c('job_raw_7C2_roll1_1','job_raw_7C2_roll1_h12','job_raw_7C2_roll1_h24','job_raw_7C2_roll1_h36','job_raw_7C2_roll1_h48','job_raw_7C2_roll1_h2436','job_raw_7C2_roll1_h3648','job_raw_7C2_roll1_h2448',\n          'job_raw_7C2_roll1_mean','job_raw_7C2_roll1_rate','job_raw_7C2_roll1_opening'))\n\nwrite.csv(job_raw_7C2_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C2_roll1_final.csv\")     \n\n\n# roll 2\njob_raw_7C2_roll2_1 <- job_raw_7C2_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C2_roll2_h12 <- job_raw_7C2_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C2_roll2_1 <- left_join(job_raw_7C2_roll2_1, job_raw_7C2_roll2_h12)\njob_raw_7C2_roll2_h24 <- job_raw_7C2_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C2_roll2_1 <- left_join(job_raw_7C2_roll2_1, job_raw_7C2_roll2_h24)\njob_raw_7C2_roll2_h36 <- job_raw_7C2_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C2_roll2_1 <- left_join(job_raw_7C2_roll2_1, job_raw_7C2_roll2_h36)\njob_raw_7C2_roll2_h48 <- job_raw_7C2_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C2_roll2_1 <- left_join(job_raw_7C2_roll2_1, job_raw_7C2_roll2_h48)\njob_raw_7C2_roll2_etc <- job_raw_7C2_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C2_roll2_1 <- left_join(job_raw_7C2_roll2_1, job_raw_7C2_roll2_etc)\n\njob_raw_7C2_roll2_1$h12[is.na(job_raw_7C2_roll2_1$h12)] <- 0\njob_raw_7C2_roll2_1$h24[is.na(job_raw_7C2_roll2_1$h24)] <- 0\njob_raw_7C2_roll2_1$h36[is.na(job_raw_7C2_roll2_1$h36)] <- 0\njob_raw_7C2_roll2_1$h48[is.na(job_raw_7C2_roll2_1$h48)] <- 0\njob_raw_7C2_roll2_1$etc[is.na(job_raw_7C2_roll2_1$etc)] <- 0\n\njob_raw_7C2_roll2_h2436 <- job_raw_7C2_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C2_roll2_1<-left_join(job_raw_7C2_roll2_1, job_raw_7C2_roll2_h2436)\njob_raw_7C2_roll2_h3648 <- job_raw_7C2_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C2_roll2_1<-left_join(job_raw_7C2_roll2_1, job_raw_7C2_roll2_h3648)\njob_raw_7C2_roll2_h2448 <- job_raw_7C2_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C2_roll2_1<-left_join(job_raw_7C2_roll2_1, job_raw_7C2_roll2_h2448)\n\njob_raw_7C2_roll2_mean <- job_raw_7C2_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\njob_raw_7C2_roll2_1<-left_join(job_raw_7C2_roll2_1, job_raw_7C2_roll2_mean)\n\njob_raw_7C2_roll2_rate <- job_raw_7C2_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C2_roll2_1<-left_join(job_raw_7C2_roll2_1, job_raw_7C2_roll2_rate)\n\njob_raw_7C2_roll2_1$rate[is.nan(job_raw_7C2_roll2_1$rate) | is.infinite(job_raw_7C2_roll2_1$rate)] <- 0\n\njob_raw_7C2_roll2_opening<-job_raw_7C2_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C2_roll2_final <- left_join(job_raw_7C2_roll2_opening, job_raw_7C2_roll2_1)\njob_raw_7C2_roll2_final<-unique(job_raw_7C2_roll2_final)\n\n\nrm(list=c('job_raw_7C2_roll2_1','job_raw_7C2_roll2_h12','job_raw_7C2_roll2_h24','job_raw_7C2_roll2_h36','job_raw_7C2_roll2_h48','job_raw_7C2_roll2_h2436','job_raw_7C2_roll2_h3648','job_raw_7C2_roll2_h2448',\n          'job_raw_7C2_roll2_mean','job_raw_7C2_roll2_rate','job_raw_7C2_roll2_opening'))\n\nwrite.csv(job_raw_7C2_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C2_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\n\njob_raw_7C3_2<- left_join(job_raw_7C3, job_recruit_sub)\n\njob_raw_7C3_2$date_new <- as.POSIXct(job_raw_7C3_2$date)\n\njob_raw_7C3_2$diff <- (job_raw_7C3_2$date_new - job_raw_7C3_2$opening_dt_new)*60\njob_raw_7C3_2 <- job_raw_7C3_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-job_raw_7C3_2$opening_dt_new\njob_raw_7C3_2$dtparts <- format(as, \"%H:%M:%S\")\njob_raw_7C3_roll2<- job_raw_7C3_2 %>% filter(dtparts>=\"12:00:00\")\njob_raw_7C3_roll1<- job_raw_7C3_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\njob_raw_7C3_roll1_1 <- job_raw_7C3_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C3_roll1_h12 <- job_raw_7C3_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C3_roll1_1 <- left_join(job_raw_7C3_roll1_1, job_raw_7C3_roll1_h12)\njob_raw_7C3_roll1_h24 <- job_raw_7C3_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C3_roll1_1 <- left_join(job_raw_7C3_roll1_1, job_raw_7C3_roll1_h24)\njob_raw_7C3_roll1_h36 <- job_raw_7C3_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C3_roll1_1 <- left_join(job_raw_7C3_roll1_1, job_raw_7C3_roll1_h36)\njob_raw_7C3_roll1_h48 <- job_raw_7C3_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C3_roll1_1 <- left_join(job_raw_7C3_roll1_1, job_raw_7C3_roll1_h48)\njob_raw_7C3_roll1_etc <- job_raw_7C3_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C3_roll1_1 <- left_join(job_raw_7C3_roll1_1, job_raw_7C3_roll1_etc)\n\njob_raw_7C3_roll1_1$h12[is.na(job_raw_7C3_roll1_1$h12)] <- 0\njob_raw_7C3_roll1_1$h24[is.na(job_raw_7C3_roll1_1$h24)] <- 0\njob_raw_7C3_roll1_1$h36[is.na(job_raw_7C3_roll1_1$h36)] <- 0\njob_raw_7C3_roll1_1$h48[is.na(job_raw_7C3_roll1_1$h48)] <- 0\njob_raw_7C3_roll1_1$etc[is.na(job_raw_7C3_roll1_1$etc)] <- 0\n\njob_raw_7C3_roll1_h2436 <- job_raw_7C3_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C3_roll1_1<-left_join(job_raw_7C3_roll1_1, job_raw_7C3_roll1_h2436)\njob_raw_7C3_roll1_h3648 <- job_raw_7C3_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C3_roll1_1<-left_join(job_raw_7C3_roll1_1, job_raw_7C3_roll1_h3648)\njob_raw_7C3_roll1_h2448 <- job_raw_7C3_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C3_roll1_1<-left_join(job_raw_7C3_roll1_1, job_raw_7C3_roll1_h2448)\n\njob_raw_7C3_roll1_mean <- job_raw_7C3_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\njob_raw_7C3_roll1_1<-left_join(job_raw_7C3_roll1_1, job_raw_7C3_roll1_mean)\n\njob_raw_7C3_roll1_rate <- job_raw_7C3_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C3_roll1_1<-left_join(job_raw_7C3_roll1_1, job_raw_7C3_roll1_rate)\n\njob_raw_7C3_roll1_1$rate[is.nan(job_raw_7C3_roll1_1$rate) | is.infinite(job_raw_7C3_roll1_1$rate)] <- 0\n\n\njob_raw_7C3_roll1_opening<-job_raw_7C3_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C3_roll1_final <- left_join(job_raw_7C3_roll1_opening, job_raw_7C3_roll1_1)\njob_raw_7C3_roll1_final<-unique(job_raw_7C3_roll1_final)\n\nrm(list=c('job_raw_7C3_roll1_1','job_raw_7C3_roll1_h12','job_raw_7C3_roll1_h24','job_raw_7C3_roll1_h36','job_raw_7C3_roll1_h48','job_raw_7C3_roll1_h2436','job_raw_7C3_roll1_h3648','job_raw_7C3_roll1_h2448',\n          'job_raw_7C3_roll1_mean','job_raw_7C3_roll1_rate','job_raw_7C3_roll1_opening'))\n\nwrite.csv(job_raw_7C3_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C3_roll1_final.csv\")     \n\n\n# roll 2\njob_raw_7C3_roll2_1 <- job_raw_7C3_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C3_roll2_h12 <- job_raw_7C3_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C3_roll2_1 <- left_join(job_raw_7C3_roll2_1, job_raw_7C3_roll2_h12)\njob_raw_7C3_roll2_h24 <- job_raw_7C3_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C3_roll2_1 <- left_join(job_raw_7C3_roll2_1, job_raw_7C3_roll2_h24)\njob_raw_7C3_roll2_h36 <- job_raw_7C3_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C3_roll2_1 <- left_join(job_raw_7C3_roll2_1, job_raw_7C3_roll2_h36)\njob_raw_7C3_roll2_h48 <- job_raw_7C3_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C3_roll2_1 <- left_join(job_raw_7C3_roll2_1, job_raw_7C3_roll2_h48)\njob_raw_7C3_roll2_etc <- job_raw_7C3_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C3_roll2_1 <- left_join(job_raw_7C3_roll2_1, job_raw_7C3_roll2_etc)\n\n\njob_raw_7C3_roll2_1$h12[is.na(job_raw_7C3_roll2_1$h12)] <- 0\njob_raw_7C3_roll2_1$h24[is.na(job_raw_7C3_roll2_1$h24)] <- 0\njob_raw_7C3_roll2_1$h36[is.na(job_raw_7C3_roll2_1$h36)] <- 0\njob_raw_7C3_roll2_1$h48[is.na(job_raw_7C3_roll2_1$h48)] <- 0\njob_raw_7C3_roll2_1$etc[is.na(job_raw_7C3_roll2_1$etc)] <- 0\n\njob_raw_7C3_roll2_h2436 <- job_raw_7C3_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C3_roll2_1<-left_join(job_raw_7C3_roll2_1, job_raw_7C3_roll2_h2436)\njob_raw_7C3_roll2_h3648 <- job_raw_7C3_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C3_roll2_1<-left_join(job_raw_7C3_roll2_1, job_raw_7C3_roll2_h3648)\njob_raw_7C3_roll2_h2448 <- job_raw_7C3_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C3_roll2_1<-left_join(job_raw_7C3_roll2_1, job_raw_7C3_roll2_h2448)\n\njob_raw_7C3_roll2_mean <- job_raw_7C3_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\njob_raw_7C3_roll2_1<-left_join(job_raw_7C3_roll2_1, job_raw_7C3_roll2_mean)\n\njob_raw_7C3_roll2_rate <- job_raw_7C3_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C3_roll2_1<-left_join(job_raw_7C3_roll2_1, job_raw_7C3_roll2_rate)\n\njob_raw_7C3_roll2_1$rate[is.nan(job_raw_7C3_roll2_1$rate) | is.infinite(job_raw_7C3_roll2_1$rate)] <- 0\n\njob_raw_7C3_roll2_opening<-job_raw_7C3_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C3_roll2_final <- left_join(job_raw_7C3_roll2_opening, job_raw_7C3_roll2_1)\njob_raw_7C3_roll2_final<-unique(job_raw_7C3_roll2_final)\n\n\nrm(list=c('job_raw_7C3_roll2_1','job_raw_7C3_roll2_h12','job_raw_7C3_roll2_h24','job_raw_7C3_roll2_h36','job_raw_7C3_roll2_h48','job_raw_7C3_roll2_h2436','job_raw_7C3_roll2_h3648','job_raw_7C3_roll2_h2448',\n          'job_raw_7C3_roll2_mean','job_raw_7C3_roll2_rate','job_raw_7C3_roll2_opening'))\n\nwrite.csv(job_raw_7C3_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C3_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\njob_raw_7C4_2<- left_join(job_raw_7C4, job_recruit_sub)\n\njob_raw_7C4_2$date_new <- as.POSIXct(job_raw_7C4_2$date)\n\njob_raw_7C4_2$diff <- (job_raw_7C4_2$date_new - job_raw_7C4_2$opening_dt_new)*60\njob_raw_7C4_2 <- job_raw_7C4_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-job_raw_7C4_2$opening_dt_new\njob_raw_7C4_2$dtparts <- format(as, \"%H:%M:%S\")\njob_raw_7C4_roll2<- job_raw_7C4_2 %>% filter(dtparts>=\"12:00:00\")\njob_raw_7C4_roll1<- job_raw_7C4_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\njob_raw_7C4_roll1_1 <- job_raw_7C4_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C4_roll1_h12 <- job_raw_7C4_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C4_roll1_1 <- left_join(job_raw_7C4_roll1_1, job_raw_7C4_roll1_h12)\njob_raw_7C4_roll1_h24 <- job_raw_7C4_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C4_roll1_1 <- left_join(job_raw_7C4_roll1_1, job_raw_7C4_roll1_h24)\njob_raw_7C4_roll1_h36 <- job_raw_7C4_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C4_roll1_1 <- left_join(job_raw_7C4_roll1_1, job_raw_7C4_roll1_h36)\njob_raw_7C4_roll1_h48 <- job_raw_7C4_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C4_roll1_1 <- left_join(job_raw_7C4_roll1_1, job_raw_7C4_roll1_h48)\njob_raw_7C4_roll1_etc <- job_raw_7C4_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C4_roll1_1 <- left_join(job_raw_7C4_roll1_1, job_raw_7C4_roll1_etc)\n\njob_raw_7C4_roll1_1$h12[is.na(job_raw_7C4_roll1_1$h12)] <- 0\njob_raw_7C4_roll1_1$h24[is.na(job_raw_7C4_roll1_1$h24)] <- 0\njob_raw_7C4_roll1_1$h36[is.na(job_raw_7C4_roll1_1$h36)] <- 0\njob_raw_7C4_roll1_1$h48[is.na(job_raw_7C4_roll1_1$h48)] <- 0\njob_raw_7C4_roll1_1$etc[is.na(job_raw_7C4_roll1_1$etc)] <- 0\n\njob_raw_7C4_roll1_h2436 <- job_raw_7C4_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C4_roll1_1<-left_join(job_raw_7C4_roll1_1, job_raw_7C4_roll1_h2436)\njob_raw_7C4_roll1_h3648 <- job_raw_7C4_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C4_roll1_1<-left_join(job_raw_7C4_roll1_1, job_raw_7C4_roll1_h3648)\njob_raw_7C4_roll1_h2448 <- job_raw_7C4_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C4_roll1_1<-left_join(job_raw_7C4_roll1_1, job_raw_7C4_roll1_h2448)\n\njob_raw_7C4_roll1_mean <- job_raw_7C4_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\njob_raw_7C4_roll1_1<-left_join(job_raw_7C4_roll1_1, job_raw_7C4_roll1_mean)\n\njob_raw_7C4_roll1_rate <- job_raw_7C4_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C4_roll1_1<-left_join(job_raw_7C4_roll1_1, job_raw_7C4_roll1_rate)\n\njob_raw_7C4_roll1_1$rate[is.nan(job_raw_7C4_roll1_1$rate) | is.infinite(job_raw_7C4_roll1_1$rate)] <- 0\n\n\njob_raw_7C4_roll1_opening<-job_raw_7C4_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C4_roll1_final <- left_join(job_raw_7C4_roll1_opening, job_raw_7C4_roll1_1)\njob_raw_7C4_roll1_final<-unique(job_raw_7C4_roll1_final)\n\nrm(list=c('job_raw_7C4_roll1_1','job_raw_7C4_roll1_h12','job_raw_7C4_roll1_h24','job_raw_7C4_roll1_h36','job_raw_7C4_roll1_h48','job_raw_7C4_roll1_h2436','job_raw_7C4_roll1_h3648','job_raw_7C4_roll1_h2448',\n          'job_raw_7C4_roll1_mean','job_raw_7C4_roll1_rate','job_raw_7C4_roll1_opening'))\n\nwrite.csv(job_raw_7C4_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C4_roll1_final.csv\")     \n\n\n# roll 2\njob_raw_7C4_roll2_1 <- job_raw_7C4_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C4_roll2_h12 <- job_raw_7C4_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C4_roll2_1 <- left_join(job_raw_7C4_roll2_1, job_raw_7C4_roll2_h12)\njob_raw_7C4_roll2_h24 <- job_raw_7C4_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C4_roll2_1 <- left_join(job_raw_7C4_roll2_1, job_raw_7C4_roll2_h24)\njob_raw_7C4_roll2_h36 <- job_raw_7C4_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C4_roll2_1 <- left_join(job_raw_7C4_roll2_1, job_raw_7C4_roll2_h36)\njob_raw_7C4_roll2_h48 <- job_raw_7C4_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C4_roll2_1 <- left_join(job_raw_7C4_roll2_1, job_raw_7C4_roll2_h48)\njob_raw_7C4_roll2_etc <- job_raw_7C4_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C4_roll2_1 <- left_join(job_raw_7C4_roll2_1, job_raw_7C4_roll2_etc)\n\njob_raw_7C4_roll2_1$h12[is.na(job_raw_7C4_roll2_1$h12)] <- 0\njob_raw_7C4_roll2_1$h24[is.na(job_raw_7C4_roll2_1$h24)] <- 0\njob_raw_7C4_roll2_1$h36[is.na(job_raw_7C4_roll2_1$h36)] <- 0\njob_raw_7C4_roll2_1$h48[is.na(job_raw_7C4_roll2_1$h48)] <- 0\njob_raw_7C4_roll2_1$etc[is.na(job_raw_7C4_roll2_1$etc)] <- 0\n\njob_raw_7C4_roll2_h2436 <- job_raw_7C4_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C4_roll2_1<-left_join(job_raw_7C4_roll2_1, job_raw_7C4_roll2_h2436)\njob_raw_7C4_roll2_h3648 <- job_raw_7C4_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C4_roll2_1<-left_join(job_raw_7C4_roll2_1, job_raw_7C4_roll2_h3648)\njob_raw_7C4_roll2_h2448 <- job_raw_7C4_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C4_roll2_1<-left_join(job_raw_7C4_roll2_1, job_raw_7C4_roll2_h2448)\n\njob_raw_7C4_roll2_mean <- job_raw_7C4_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\njob_raw_7C4_roll2_1<-left_join(job_raw_7C4_roll2_1, job_raw_7C4_roll2_mean)\n\njob_raw_7C4_roll2_rate <- job_raw_7C4_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C4_roll2_1<-left_join(job_raw_7C4_roll2_1, job_raw_7C4_roll2_rate)\n\njob_raw_7C4_roll2_1$rate[is.nan(job_raw_7C4_roll2_1$rate) | is.infinite(job_raw_7C4_roll2_1$rate)] <- 0\n\njob_raw_7C4_roll2_opening<-job_raw_7C4_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C4_roll2_final <- left_join(job_raw_7C4_roll2_opening, job_raw_7C4_roll2_1)\njob_raw_7C4_roll2_final<-unique(job_raw_7C4_roll2_final)\n\n\nrm(list=c('job_raw_7C4_roll2_1','job_raw_7C4_roll2_h12','job_raw_7C4_roll2_h24','job_raw_7C4_roll2_h36','job_raw_7C4_roll2_h48','job_raw_7C4_roll2_h2436','job_raw_7C4_roll2_h3648','job_raw_7C4_roll2_h2448',\n          'job_raw_7C4_roll2_mean','job_raw_7C4_roll2_rate','job_raw_7C4_roll2_opening'))\n\nwrite.csv(job_raw_7C4_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C4_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\njob_raw_7C5_2<- left_join(job_raw_7C5, job_recruit_sub)\n\njob_raw_7C5_2$date_new <- as.POSIXct(job_raw_7C5_2$date)\n\njob_raw_7C5_2$diff <- (job_raw_7C5_2$date_new - job_raw_7C5_2$opening_dt_new)\njob_raw_7C5_2 <- job_raw_7C5_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-job_raw_7C5_2$opening_dt_new\njob_raw_7C5_2$dtparts <- format(as, \"%H:%M:%S\")\njob_raw_7C5_roll2<- job_raw_7C5_2 %>% filter(dtparts>=\"12:00:00\")\njob_raw_7C5_roll1<- job_raw_7C5_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\njob_raw_7C5_roll1_1 <- job_raw_7C5_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C5_roll1_h12 <- job_raw_7C5_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C5_roll1_1 <- left_join(job_raw_7C5_roll1_1, job_raw_7C5_roll1_h12)\njob_raw_7C5_roll1_h24 <- job_raw_7C5_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C5_roll1_1 <- left_join(job_raw_7C5_roll1_1, job_raw_7C5_roll1_h24)\njob_raw_7C5_roll1_h36 <- job_raw_7C5_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C5_roll1_1 <- left_join(job_raw_7C5_roll1_1, job_raw_7C5_roll1_h36)\njob_raw_7C5_roll1_h48 <- job_raw_7C5_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C5_roll1_1 <- left_join(job_raw_7C5_roll1_1, job_raw_7C5_roll1_h48)\njob_raw_7C5_roll1_etc <- job_raw_7C5_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C5_roll1_1 <- left_join(job_raw_7C5_roll1_1, job_raw_7C5_roll1_etc)\n\njob_raw_7C5_roll1_1$h12[is.na(job_raw_7C5_roll1_1$h12)] <- 0\njob_raw_7C5_roll1_1$h24[is.na(job_raw_7C5_roll1_1$h24)] <- 0\njob_raw_7C5_roll1_1$h36[is.na(job_raw_7C5_roll1_1$h36)] <- 0\njob_raw_7C5_roll1_1$h48[is.na(job_raw_7C5_roll1_1$h48)] <- 0\njob_raw_7C5_roll1_1$etc[is.na(job_raw_7C5_roll1_1$etc)] <- 0\n\njob_raw_7C5_roll1_h2436 <- job_raw_7C5_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C5_roll1_1<-left_join(job_raw_7C5_roll1_1, job_raw_7C5_roll1_h2436)\njob_raw_7C5_roll1_h3648 <- job_raw_7C5_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C5_roll1_1<-left_join(job_raw_7C5_roll1_1, job_raw_7C5_roll1_h3648)\njob_raw_7C5_roll1_h2448 <- job_raw_7C5_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C5_roll1_1<-left_join(job_raw_7C5_roll1_1, job_raw_7C5_roll1_h2448)\n\njob_raw_7C5_roll1_mean <- job_raw_7C5_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\njob_raw_7C5_roll1_1<-left_join(job_raw_7C5_roll1_1, job_raw_7C5_roll1_mean)\n\njob_raw_7C5_roll1_rate <- job_raw_7C5_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C5_roll1_1<-left_join(job_raw_7C5_roll1_1, job_raw_7C5_roll1_rate)\n\njob_raw_7C5_roll1_1$rate[is.nan(job_raw_7C5_roll1_1$rate) | is.infinite(job_raw_7C5_roll1_1$rate)] <- 0\n\n\njob_raw_7C5_roll1_opening<-job_raw_7C5_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C5_roll1_final <- left_join(job_raw_7C5_roll1_opening, job_raw_7C5_roll1_1)\njob_raw_7C5_roll1_final<-unique(job_raw_7C5_roll1_final)\n\nrm(list=c('job_raw_7C5_roll1_1','job_raw_7C5_roll1_h12','job_raw_7C5_roll1_h24','job_raw_7C5_roll1_h36','job_raw_7C5_roll1_h48','job_raw_7C5_roll1_h2436','job_raw_7C5_roll1_h3648','job_raw_7C5_roll1_h2448',\n          'job_raw_7C5_roll1_mean','job_raw_7C5_roll1_rate','job_raw_7C5_roll1_opening'))\n\nwrite.csv(job_raw_7C5_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C5_roll1_final.csv\")     \n\n\n# roll 2\njob_raw_7C5_roll2_1 <- job_raw_7C5_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C5_roll2_h12 <- job_raw_7C5_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C5_roll2_1 <- left_join(job_raw_7C5_roll2_1, job_raw_7C5_roll2_h12)\njob_raw_7C5_roll2_h24 <- job_raw_7C5_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C5_roll2_1 <- left_join(job_raw_7C5_roll2_1, job_raw_7C5_roll2_h24)\njob_raw_7C5_roll2_h36 <- job_raw_7C5_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C5_roll2_1 <- left_join(job_raw_7C5_roll2_1, job_raw_7C5_roll2_h36)\njob_raw_7C5_roll2_h48 <- job_raw_7C5_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C5_roll2_1 <- left_join(job_raw_7C5_roll2_1, job_raw_7C5_roll2_h48)\njob_raw_7C5_roll2_etc <- job_raw_7C5_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C5_roll2_1 <- left_join(job_raw_7C5_roll2_1, job_raw_7C5_roll2_etc)\n\njob_raw_7C5_roll2_1$h12[is.na(job_raw_7C5_roll2_1$h12)] <- 0\njob_raw_7C5_roll2_1$h24[is.na(job_raw_7C5_roll2_1$h24)] <- 0\njob_raw_7C5_roll2_1$h36[is.na(job_raw_7C5_roll2_1$h36)] <- 0\njob_raw_7C5_roll2_1$h48[is.na(job_raw_7C5_roll2_1$h48)] <- 0\njob_raw_7C5_roll2_1$etc[is.na(job_raw_7C5_roll2_1$etc)] <- 0\n\njob_raw_7C5_roll2_h2436 <- job_raw_7C5_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C5_roll2_1<-left_join(job_raw_7C5_roll2_1, job_raw_7C5_roll2_h2436)\njob_raw_7C5_roll2_h3648 <- job_raw_7C5_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C5_roll2_1<-left_join(job_raw_7C5_roll2_1, job_raw_7C5_roll2_h3648)\njob_raw_7C5_roll2_h2448 <- job_raw_7C5_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C5_roll2_1<-left_join(job_raw_7C5_roll2_1, job_raw_7C5_roll2_h2448)\n\njob_raw_7C5_roll2_mean <- job_raw_7C5_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\njob_raw_7C5_roll2_1<-left_join(job_raw_7C5_roll2_1, job_raw_7C5_roll2_mean)\n\njob_raw_7C5_roll2_rate <- job_raw_7C5_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C5_roll2_1<-left_join(job_raw_7C5_roll2_1, job_raw_7C5_roll2_rate)\n\njob_raw_7C5_roll2_1$rate[is.nan(job_raw_7C5_roll2_1$rate) | is.infinite(job_raw_7C5_roll2_1$rate)] <- 0\n\njob_raw_7C5_roll2_opening<-job_raw_7C5_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C5_roll2_final <- left_join(job_raw_7C5_roll2_opening, job_raw_7C5_roll2_1)\njob_raw_7C5_roll2_final<-unique(job_raw_7C5_roll2_final)\n\n\nrm(list=c('job_raw_7C5_roll2_1','job_raw_7C5_roll2_h12','job_raw_7C5_roll2_h24','job_raw_7C5_roll2_h36','job_raw_7C5_roll2_h48','job_raw_7C5_roll2_h2436','job_raw_7C5_roll2_h3648','job_raw_7C5_roll2_h2448',\n          'job_raw_7C5_roll2_mean','job_raw_7C5_roll2_rate','job_raw_7C5_roll2_opening'))\n\nwrite.csv(job_raw_7C5_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C5_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\njob_raw_7C6_2<- left_join(job_raw_7C6, job_recruit_sub)\n\njob_raw_7C6_2$date_new <- as.POSIXct(job_raw_7C6_2$date)\n\njob_raw_7C6_2$diff <- (job_raw_7C6_2$date_new - job_raw_7C6_2$opening_dt_new)\njob_raw_7C6_2 <- job_raw_7C6_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-job_raw_7C6_2$opening_dt_new\njob_raw_7C6_2$dtparts <- format(as, \"%H:%M:%S\")\njob_raw_7C6_roll2<- job_raw_7C6_2 %>% filter(dtparts>=\"12:00:00\")\njob_raw_7C6_roll1<- job_raw_7C6_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\njob_raw_7C6_roll1_1 <- job_raw_7C6_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C6_roll1_h12 <- job_raw_7C6_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C6_roll1_1 <- left_join(job_raw_7C6_roll1_1, job_raw_7C6_roll1_h12)\njob_raw_7C6_roll1_h24 <- job_raw_7C6_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C6_roll1_1 <- left_join(job_raw_7C6_roll1_1, job_raw_7C6_roll1_h24)\njob_raw_7C6_roll1_h36 <- job_raw_7C6_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C6_roll1_1 <- left_join(job_raw_7C6_roll1_1, job_raw_7C6_roll1_h36)\njob_raw_7C6_roll1_h48 <- job_raw_7C6_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C6_roll1_1 <- left_join(job_raw_7C6_roll1_1, job_raw_7C6_roll1_h48)\njob_raw_7C6_roll1_etc <- job_raw_7C6_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C6_roll1_1 <- left_join(job_raw_7C6_roll1_1, job_raw_7C6_roll1_etc)\n\njob_raw_7C6_roll1_1$h12[is.na(job_raw_7C6_roll1_1$h12)] <- 0\njob_raw_7C6_roll1_1$h24[is.na(job_raw_7C6_roll1_1$h24)] <- 0\njob_raw_7C6_roll1_1$h36[is.na(job_raw_7C6_roll1_1$h36)] <- 0\njob_raw_7C6_roll1_1$h48[is.na(job_raw_7C6_roll1_1$h48)] <- 0\njob_raw_7C6_roll1_1$etc[is.na(job_raw_7C6_roll1_1$etc)] <- 0\n\njob_raw_7C6_roll1_h2436 <- job_raw_7C6_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C6_roll1_1<-left_join(job_raw_7C6_roll1_1, job_raw_7C6_roll1_h2436)\njob_raw_7C6_roll1_h3648 <- job_raw_7C6_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C6_roll1_1<-left_join(job_raw_7C6_roll1_1, job_raw_7C6_roll1_h3648)\njob_raw_7C6_roll1_h2448 <- job_raw_7C6_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C6_roll1_1<-left_join(job_raw_7C6_roll1_1, job_raw_7C6_roll1_h2448)\n\njob_raw_7C6_roll1_mean <- job_raw_7C6_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\njob_raw_7C6_roll1_1<-left_join(job_raw_7C6_roll1_1, job_raw_7C6_roll1_mean)\n\njob_raw_7C6_roll1_rate <- job_raw_7C6_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C6_roll1_1<-left_join(job_raw_7C6_roll1_1, job_raw_7C6_roll1_rate)\n\njob_raw_7C6_roll1_1$rate[is.nan(job_raw_7C6_roll1_1$rate) | is.infinite(job_raw_7C6_roll1_1$rate)] <- 0\n\n\njob_raw_7C6_roll1_opening<-job_raw_7C6_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C6_roll1_final <- left_join(job_raw_7C6_roll1_opening, job_raw_7C6_roll1_1)\njob_raw_7C6_roll1_final<-unique(job_raw_7C6_roll1_final)\n\nrm(list=c('job_raw_7C6_roll1_1','job_raw_7C6_roll1_h12','job_raw_7C6_roll1_h24','job_raw_7C6_roll1_h36','job_raw_7C6_roll1_h48','job_raw_7C6_roll1_h2436','job_raw_7C6_roll1_h3648','job_raw_7C6_roll1_h2448',\n          'job_raw_7C6_roll1_mean','job_raw_7C6_roll1_rate','job_raw_7C6_roll1_opening'))\n\nwrite.csv(job_raw_7C6_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C6_roll1_final.csv\")     \n\n\n# roll 2\njob_raw_7C6_roll2_1 <- job_raw_7C6_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C6_roll2_h12 <- job_raw_7C6_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C6_roll2_1 <- left_join(job_raw_7C6_roll2_1, job_raw_7C6_roll2_h12)\njob_raw_7C6_roll2_h24 <- job_raw_7C6_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C6_roll2_1 <- left_join(job_raw_7C6_roll2_1, job_raw_7C6_roll2_h24)\njob_raw_7C6_roll2_h36 <- job_raw_7C6_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C6_roll2_1 <- left_join(job_raw_7C6_roll2_1, job_raw_7C6_roll2_h36)\njob_raw_7C6_roll2_h48 <- job_raw_7C6_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C6_roll2_1 <- left_join(job_raw_7C6_roll2_1, job_raw_7C6_roll2_h48)\njob_raw_7C6_roll2_etc <- job_raw_7C6_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C6_roll2_1 <- left_join(job_raw_7C6_roll2_1, job_raw_7C6_roll2_etc)\n\njob_raw_7C6_roll2_1$h12[is.na(job_raw_7C6_roll2_1$h12)] <- 0\njob_raw_7C6_roll2_1$h24[is.na(job_raw_7C6_roll2_1$h24)] <- 0\njob_raw_7C6_roll2_1$h36[is.na(job_raw_7C6_roll2_1$h36)] <- 0\njob_raw_7C6_roll2_1$h48[is.na(job_raw_7C6_roll2_1$h48)] <- 0\njob_raw_7C6_roll2_1$etc[is.na(job_raw_7C6_roll2_1$etc)] <- 0\n\njob_raw_7C6_roll2_h2436 <- job_raw_7C6_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C6_roll2_1<-left_join(job_raw_7C6_roll2_1, job_raw_7C6_roll2_h2436)\njob_raw_7C6_roll2_h3648 <- job_raw_7C6_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C6_roll2_1<-left_join(job_raw_7C6_roll2_1, job_raw_7C6_roll2_h3648)\njob_raw_7C6_roll2_h2448 <- job_raw_7C6_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C6_roll2_1<-left_join(job_raw_7C6_roll2_1, job_raw_7C6_roll2_h2448)\n\njob_raw_7C6_roll2_mean <- job_raw_7C6_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\njob_raw_7C6_roll2_1<-left_join(job_raw_7C6_roll2_1, job_raw_7C6_roll2_mean)\n\njob_raw_7C6_roll2_rate <- job_raw_7C6_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C6_roll2_1<-left_join(job_raw_7C6_roll2_1, job_raw_7C6_roll2_rate)\n\njob_raw_7C6_roll2_1$rate[is.nan(job_raw_7C6_roll2_1$rate) | is.infinite(job_raw_7C6_roll2_1$rate)] <- 0\n\njob_raw_7C6_roll2_opening<-job_raw_7C6_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C6_roll2_final <- left_join(job_raw_7C6_roll2_opening, job_raw_7C6_roll2_1)\njob_raw_7C6_roll2_final<-unique(job_raw_7C6_roll2_final)\n\n\nrm(list=c('job_raw_7C6_roll2_1','job_raw_7C6_roll2_h12','job_raw_7C6_roll2_h24','job_raw_7C6_roll2_h36','job_raw_7C6_roll2_h48','job_raw_7C6_roll2_h2436','job_raw_7C6_roll2_h3648','job_raw_7C6_roll2_h2448',\n          'job_raw_7C6_roll2_mean','job_raw_7C6_roll2_rate','job_raw_7C6_roll2_opening'))\n\nwrite.csv(job_raw_7C6_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C6_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\njob_raw_7C7_2<- left_join(job_raw_7C7, job_recruit_sub)\n\njob_raw_7C7_2$date_new <- as.POSIXct(job_raw_7C7_2$date)\n\njob_raw_7C7_2$diff <- (job_raw_7C7_2$date_new - job_raw_7C7_2$opening_dt_new)\njob_raw_7C7_2 <- job_raw_7C7_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-job_raw_7C7_2$opening_dt_new\njob_raw_7C7_2$dtparts <- format(as, \"%H:%M:%S\")\njob_raw_7C7_roll2<- job_raw_7C7_2 %>% filter(dtparts>=\"12:00:00\")\njob_raw_7C7_roll1<- job_raw_7C7_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\njob_raw_7C7_roll1_1 <- job_raw_7C7_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C7_roll1_h12 <- job_raw_7C7_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C7_roll1_1 <- left_join(job_raw_7C7_roll1_1, job_raw_7C7_roll1_h12)\njob_raw_7C7_roll1_h24 <- job_raw_7C7_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C7_roll1_1 <- left_join(job_raw_7C7_roll1_1, job_raw_7C7_roll1_h24)\njob_raw_7C7_roll1_h36 <- job_raw_7C7_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C7_roll1_1 <- left_join(job_raw_7C7_roll1_1, job_raw_7C7_roll1_h36)\njob_raw_7C7_roll1_h48 <- job_raw_7C7_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C7_roll1_1 <- left_join(job_raw_7C7_roll1_1, job_raw_7C7_roll1_h48)\njob_raw_7C7_roll1_etc <- job_raw_7C7_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C7_roll1_1 <- left_join(job_raw_7C7_roll1_1, job_raw_7C7_roll1_etc)\n\njob_raw_7C7_roll1_1$h12[is.na(job_raw_7C7_roll1_1$h12)] <- 0\njob_raw_7C7_roll1_1$h24[is.na(job_raw_7C7_roll1_1$h24)] <- 0\njob_raw_7C7_roll1_1$h36[is.na(job_raw_7C7_roll1_1$h36)] <- 0\njob_raw_7C7_roll1_1$h48[is.na(job_raw_7C7_roll1_1$h48)] <- 0\njob_raw_7C7_roll1_1$etc[is.na(job_raw_7C7_roll1_1$etc)] <- 0\n\njob_raw_7C7_roll1_h2436 <- job_raw_7C7_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C7_roll1_1<-left_join(job_raw_7C7_roll1_1, job_raw_7C7_roll1_h2436)\njob_raw_7C7_roll1_h3648 <- job_raw_7C7_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C7_roll1_1<-left_join(job_raw_7C7_roll1_1, job_raw_7C7_roll1_h3648)\njob_raw_7C7_roll1_h2448 <- job_raw_7C7_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C7_roll1_1<-left_join(job_raw_7C7_roll1_1, job_raw_7C7_roll1_h2448)\n\njob_raw_7C7_roll1_mean <- job_raw_7C7_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\njob_raw_7C7_roll1_1<-left_join(job_raw_7C7_roll1_1, job_raw_7C7_roll1_mean)\n\njob_raw_7C7_roll1_rate <- job_raw_7C7_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C7_roll1_1<-left_join(job_raw_7C7_roll1_1, job_raw_7C7_roll1_rate)\n\njob_raw_7C7_roll1_1$rate[is.nan(job_raw_7C7_roll1_1$rate) | is.infinite(job_raw_7C7_roll1_1$rate)] <- 0\n\n\njob_raw_7C7_roll1_opening<-job_raw_7C7_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C7_roll1_final <- left_join(job_raw_7C7_roll1_opening, job_raw_7C7_roll1_1)\njob_raw_7C7_roll1_final<-unique(job_raw_7C7_roll1_final)\n\nrm(list=c('job_raw_7C7_roll1_1','job_raw_7C7_roll1_h12','job_raw_7C7_roll1_h24','job_raw_7C7_roll1_h36','job_raw_7C7_roll1_h48','job_raw_7C7_roll1_h2436','job_raw_7C7_roll1_h3648','job_raw_7C7_roll1_h2448',\n          'job_raw_7C7_roll1_mean','job_raw_7C7_roll1_rate','job_raw_7C7_roll1_opening'))\n\nwrite.csv(job_raw_7C7_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C7_roll1_final.csv\")     \n\n\n# roll 2\njob_raw_7C7_roll2_1 <- job_raw_7C7_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C7_roll2_h12 <- job_raw_7C7_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C7_roll2_1 <- left_join(job_raw_7C7_roll2_1, job_raw_7C7_roll2_h12)\njob_raw_7C7_roll2_h24 <- job_raw_7C7_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C7_roll2_1 <- left_join(job_raw_7C7_roll2_1, job_raw_7C7_roll2_h24)\njob_raw_7C7_roll2_h36 <- job_raw_7C7_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C7_roll2_1 <- left_join(job_raw_7C7_roll2_1, job_raw_7C7_roll2_h36)\njob_raw_7C7_roll2_h48 <- job_raw_7C7_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C7_roll2_1 <- left_join(job_raw_7C7_roll2_1, job_raw_7C7_roll2_h48)\njob_raw_7C7_roll2_etc <- job_raw_7C7_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C7_roll2_1 <- left_join(job_raw_7C7_roll2_1, job_raw_7C7_roll2_etc)\n\njob_raw_7C7_roll2_1$h12[is.na(job_raw_7C7_roll2_1$h12)] <- 0\njob_raw_7C7_roll2_1$h24[is.na(job_raw_7C7_roll2_1$h24)] <- 0\njob_raw_7C7_roll2_1$h36[is.na(job_raw_7C7_roll2_1$h36)] <- 0\njob_raw_7C7_roll2_1$h48[is.na(job_raw_7C7_roll2_1$h48)] <- 0\njob_raw_7C7_roll2_1$etc[is.na(job_raw_7C7_roll2_1$etc)] <- 0\n\njob_raw_7C7_roll2_h2436 <- job_raw_7C7_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C7_roll2_1<-left_join(job_raw_7C7_roll2_1, job_raw_7C7_roll2_h2436)\njob_raw_7C7_roll2_h3648 <- job_raw_7C7_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C7_roll2_1<-left_join(job_raw_7C7_roll2_1, job_raw_7C7_roll2_h3648)\njob_raw_7C7_roll2_h2448 <- job_raw_7C7_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C7_roll2_1<-left_join(job_raw_7C7_roll2_1, job_raw_7C7_roll2_h2448)\n\njob_raw_7C7_roll2_mean <- job_raw_7C7_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\njob_raw_7C7_roll2_1<-left_join(job_raw_7C7_roll2_1, job_raw_7C7_roll2_mean)\n\njob_raw_7C7_roll2_rate <- job_raw_7C7_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C7_roll2_1<-left_join(job_raw_7C7_roll2_1, job_raw_7C7_roll2_rate)\n\njob_raw_7C7_roll2_1$rate[is.nan(job_raw_7C7_roll2_1$rate) | is.infinite(job_raw_7C7_roll2_1$rate)] <- 0\n\njob_raw_7C7_roll2_opening<-job_raw_7C7_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C7_roll2_final <- left_join(job_raw_7C7_roll2_opening, job_raw_7C7_roll2_1)\njob_raw_7C7_roll2_final<-unique(job_raw_7C7_roll2_final)\n\n\nrm(list=c('job_raw_7C7_roll2_1','job_raw_7C7_roll2_h12','job_raw_7C7_roll2_h24','job_raw_7C7_roll2_h36','job_raw_7C7_roll2_h48','job_raw_7C7_roll2_h2436','job_raw_7C7_roll2_h3648','job_raw_7C7_roll2_h2448',\n          'job_raw_7C7_roll2_mean','job_raw_7C7_roll2_rate','job_raw_7C7_roll2_opening'))\n\nwrite.csv(job_raw_7C7_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C7_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\njob_raw_7C8_2<- left_join(job_raw_7C8, job_recruit_sub)\n\njob_raw_7C8_2$date_new <- as.POSIXct(job_raw_7C8_2$date)\n\njob_raw_7C8_2$diff <- (job_raw_7C8_2$date_new - job_raw_7C8_2$opening_dt_new)\njob_raw_7C8_2 <- job_raw_7C8_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-job_raw_7C8_2$opening_dt_new\njob_raw_7C8_2$dtparts <- format(as, \"%H:%M:%S\")\njob_raw_7C8_roll2<- job_raw_7C8_2 %>% filter(dtparts>=\"12:00:00\")\njob_raw_7C8_roll1<- job_raw_7C8_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\njob_raw_7C8_roll1_1 <- job_raw_7C8_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C8_roll1_h12 <- job_raw_7C8_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C8_roll1_1 <- left_join(job_raw_7C8_roll1_1, job_raw_7C8_roll1_h12)\njob_raw_7C8_roll1_h24 <- job_raw_7C8_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C8_roll1_1 <- left_join(job_raw_7C8_roll1_1, job_raw_7C8_roll1_h24)\njob_raw_7C8_roll1_h36 <- job_raw_7C8_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C8_roll1_1 <- left_join(job_raw_7C8_roll1_1, job_raw_7C8_roll1_h36)\njob_raw_7C8_roll1_h48 <- job_raw_7C8_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C8_roll1_1 <- left_join(job_raw_7C8_roll1_1, job_raw_7C8_roll1_h48)\njob_raw_7C8_roll1_etc <- job_raw_7C8_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C8_roll1_1 <- left_join(job_raw_7C8_roll1_1, job_raw_7C8_roll1_etc)\n\njob_raw_7C8_roll1_1$h12[is.na(job_raw_7C8_roll1_1$h12)] <- 0\njob_raw_7C8_roll1_1$h24[is.na(job_raw_7C8_roll1_1$h24)] <- 0\njob_raw_7C8_roll1_1$h36[is.na(job_raw_7C8_roll1_1$h36)] <- 0\njob_raw_7C8_roll1_1$h48[is.na(job_raw_7C8_roll1_1$h48)] <- 0\njob_raw_7C8_roll1_1$etc[is.na(job_raw_7C8_roll1_1$etc)] <- 0\n\njob_raw_7C8_roll1_h2436 <- job_raw_7C8_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C8_roll1_1<-left_join(job_raw_7C8_roll1_1, job_raw_7C8_roll1_h2436)\njob_raw_7C8_roll1_h3648 <- job_raw_7C8_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C8_roll1_1<-left_join(job_raw_7C8_roll1_1, job_raw_7C8_roll1_h3648)\njob_raw_7C8_roll1_h2448 <- job_raw_7C8_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C8_roll1_1<-left_join(job_raw_7C8_roll1_1, job_raw_7C8_roll1_h2448)\n\njob_raw_7C8_roll1_mean <- job_raw_7C8_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\njob_raw_7C8_roll1_1<-left_join(job_raw_7C8_roll1_1, job_raw_7C8_roll1_mean)\n\njob_raw_7C8_roll1_rate <- job_raw_7C8_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C8_roll1_1<-left_join(job_raw_7C8_roll1_1, job_raw_7C8_roll1_rate)\n\njob_raw_7C8_roll1_1$rate[is.nan(job_raw_7C8_roll1_1$rate) | is.infinite(job_raw_7C8_roll1_1$rate)] <- 0\n\n\njob_raw_7C8_roll1_opening<-job_raw_7C8_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C8_roll1_final <- left_join(job_raw_7C8_roll1_opening, job_raw_7C8_roll1_1)\njob_raw_7C8_roll1_final<-unique(job_raw_7C8_roll1_final)\n\nrm(list=c('job_raw_7C8_roll1_1','job_raw_7C8_roll1_h12','job_raw_7C8_roll1_h24','job_raw_7C8_roll1_h36','job_raw_7C8_roll1_h48','job_raw_7C8_roll1_h2436','job_raw_7C8_roll1_h3648','job_raw_7C8_roll1_h2448',\n          'job_raw_7C8_roll1_mean','job_raw_7C8_roll1_rate','job_raw_7C8_roll1_opening'))\n\nwrite.csv(job_raw_7C8_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C8_roll1_final.csv\")     \n\n\n# roll 2\njob_raw_7C8_roll2_1 <- job_raw_7C8_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C8_roll2_h12 <- job_raw_7C8_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C8_roll2_1 <- left_join(job_raw_7C8_roll2_1, job_raw_7C8_roll2_h12)\njob_raw_7C8_roll2_h24 <- job_raw_7C8_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C8_roll2_1 <- left_join(job_raw_7C8_roll2_1, job_raw_7C8_roll2_h24)\njob_raw_7C8_roll2_h36 <- job_raw_7C8_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C8_roll2_1 <- left_join(job_raw_7C8_roll2_1, job_raw_7C8_roll2_h36)\njob_raw_7C8_roll2_h48 <- job_raw_7C8_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C8_roll2_1 <- left_join(job_raw_7C8_roll2_1, job_raw_7C8_roll2_h48)\njob_raw_7C8_roll2_etc <- job_raw_7C8_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C8_roll2_1 <- left_join(job_raw_7C8_roll2_1, job_raw_7C8_roll2_etc)\n\njob_raw_7C8_roll2_1$h12[is.na(job_raw_7C8_roll2_1$h12)] <- 0\njob_raw_7C8_roll2_1$h24[is.na(job_raw_7C8_roll2_1$h24)] <- 0\njob_raw_7C8_roll2_1$h36[is.na(job_raw_7C8_roll2_1$h36)] <- 0\njob_raw_7C8_roll2_1$h48[is.na(job_raw_7C8_roll2_1$h48)] <- 0\njob_raw_7C8_roll2_1$etc[is.na(job_raw_7C8_roll2_1$etc)] <- 0\n\njob_raw_7C8_roll2_h2436 <- job_raw_7C8_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C8_roll2_1<-left_join(job_raw_7C8_roll2_1, job_raw_7C8_roll2_h2436)\njob_raw_7C8_roll2_h3648 <- job_raw_7C8_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C8_roll2_1<-left_join(job_raw_7C8_roll2_1, job_raw_7C8_roll2_h3648)\njob_raw_7C8_roll2_h2448 <- job_raw_7C8_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C8_roll2_1<-left_join(job_raw_7C8_roll2_1, job_raw_7C8_roll2_h2448)\n\njob_raw_7C8_roll2_mean <- job_raw_7C8_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\njob_raw_7C8_roll2_1<-left_join(job_raw_7C8_roll2_1, job_raw_7C8_roll2_mean)\n\njob_raw_7C8_roll2_rate <- job_raw_7C8_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C8_roll2_1<-left_join(job_raw_7C8_roll2_1, job_raw_7C8_roll2_rate)\n\njob_raw_7C8_roll2_1$rate[is.nan(job_raw_7C8_roll2_1$rate) | is.infinite(job_raw_7C8_roll2_1$rate)] <- 0\n\njob_raw_7C8_roll2_opening<-job_raw_7C8_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C8_roll2_final <- left_join(job_raw_7C8_roll2_opening, job_raw_7C8_roll2_1)\njob_raw_7C8_roll2_final<-unique(job_raw_7C8_roll2_final)\n\n\nrm(list=c('job_raw_7C8_roll2_1','job_raw_7C8_roll2_h12','job_raw_7C8_roll2_h24','job_raw_7C8_roll2_h36','job_raw_7C8_roll2_h48','job_raw_7C8_roll2_h2436','job_raw_7C8_roll2_h3648','job_raw_7C8_roll2_h2448',\n          'job_raw_7C8_roll2_mean','job_raw_7C8_roll2_rate','job_raw_7C8_roll2_opening'))\n\nwrite.csv(job_raw_7C8_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C8_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\njob_raw_7C9_2<- left_join(job_raw_7C9, job_recruit_sub)\n\njob_raw_7C9_2$date_new <- as.POSIXct(job_raw_7C9_2$date)\n\njob_raw_7C9_2$diff <- (job_raw_7C9_2$date_new - job_raw_7C9_2$opening_dt_new)\njob_raw_7C9_2 <- job_raw_7C9_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-job_raw_7C9_2$opening_dt_new\njob_raw_7C9_2$dtparts <- format(as, \"%H:%M:%S\")\njob_raw_7C9_roll2<- job_raw_7C9_2 %>% filter(dtparts>=\"12:00:00\")\njob_raw_7C9_roll1<- job_raw_7C9_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\njob_raw_7C9_roll1_1 <- job_raw_7C9_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C9_roll1_h12 <- job_raw_7C9_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C9_roll1_1 <- left_join(job_raw_7C9_roll1_1, job_raw_7C9_roll1_h12)\njob_raw_7C9_roll1_h24 <- job_raw_7C9_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C9_roll1_1 <- left_join(job_raw_7C9_roll1_1, job_raw_7C9_roll1_h24)\njob_raw_7C9_roll1_h36 <- job_raw_7C9_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C9_roll1_1 <- left_join(job_raw_7C9_roll1_1, job_raw_7C9_roll1_h36)\njob_raw_7C9_roll1_h48 <- job_raw_7C9_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C9_roll1_1 <- left_join(job_raw_7C9_roll1_1, job_raw_7C9_roll1_h48)\njob_raw_7C9_roll1_etc <- job_raw_7C9_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C9_roll1_1 <- left_join(job_raw_7C9_roll1_1, job_raw_7C9_roll1_etc)\n\njob_raw_7C9_roll1_1$h12[is.na(job_raw_7C9_roll1_1$h12)] <- 0\njob_raw_7C9_roll1_1$h24[is.na(job_raw_7C9_roll1_1$h24)] <- 0\njob_raw_7C9_roll1_1$h36[is.na(job_raw_7C9_roll1_1$h36)] <- 0\njob_raw_7C9_roll1_1$h48[is.na(job_raw_7C9_roll1_1$h48)] <- 0\njob_raw_7C9_roll1_1$etc[is.na(job_raw_7C9_roll1_1$etc)] <- 0\n\njob_raw_7C9_roll1_h2436 <- job_raw_7C9_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C9_roll1_1<-left_join(job_raw_7C9_roll1_1, job_raw_7C9_roll1_h2436)\njob_raw_7C9_roll1_h3648 <- job_raw_7C9_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C9_roll1_1<-left_join(job_raw_7C9_roll1_1, job_raw_7C9_roll1_h3648)\njob_raw_7C9_roll1_h2448 <- job_raw_7C9_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C9_roll1_1<-left_join(job_raw_7C9_roll1_1, job_raw_7C9_roll1_h2448)\n\njob_raw_7C9_roll1_mean <- job_raw_7C9_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\njob_raw_7C9_roll1_1<-left_join(job_raw_7C9_roll1_1, job_raw_7C9_roll1_mean)\n\njob_raw_7C9_roll1_rate <- job_raw_7C9_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C9_roll1_1<-left_join(job_raw_7C9_roll1_1, job_raw_7C9_roll1_rate)\n\njob_raw_7C9_roll1_1$rate[is.nan(job_raw_7C9_roll1_1$rate) | is.infinite(job_raw_7C9_roll1_1$rate)] <- 0\n\n\njob_raw_7C9_roll1_opening<-job_raw_7C9_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C9_roll1_final <- left_join(job_raw_7C9_roll1_opening, job_raw_7C9_roll1_1)\njob_raw_7C9_roll1_final<-unique(job_raw_7C9_roll1_final)\n\nrm(list=c('job_raw_7C9_roll1_1','job_raw_7C9_roll1_h12','job_raw_7C9_roll1_h24','job_raw_7C9_roll1_h36','job_raw_7C9_roll1_h48','job_raw_7C9_roll1_h2436','job_raw_7C9_roll1_h3648','job_raw_7C9_roll1_h2448',\n          'job_raw_7C9_roll1_mean','job_raw_7C9_roll1_rate','job_raw_7C9_roll1_opening'))\n\nwrite.csv(job_raw_7C9_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C9_roll1_final.csv\")     \n\n\n# roll 2\njob_raw_7C9_roll2_1 <- job_raw_7C9_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C9_roll2_h12 <- job_raw_7C9_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C9_roll2_1 <- left_join(job_raw_7C9_roll2_1, job_raw_7C9_roll2_h12)\njob_raw_7C9_roll2_h24 <- job_raw_7C9_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C9_roll2_1 <- left_join(job_raw_7C9_roll2_1, job_raw_7C9_roll2_h24)\njob_raw_7C9_roll2_h36 <- job_raw_7C9_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C9_roll2_1 <- left_join(job_raw_7C9_roll2_1, job_raw_7C9_roll2_h36)\njob_raw_7C9_roll2_h48 <- job_raw_7C9_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C9_roll2_1 <- left_join(job_raw_7C9_roll2_1, job_raw_7C9_roll2_h48)\njob_raw_7C9_roll2_etc <- job_raw_7C9_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C9_roll2_1 <- left_join(job_raw_7C9_roll2_1, job_raw_7C9_roll2_etc)\n\njob_raw_7C9_roll2_1$h12[is.na(job_raw_7C9_roll2_1$h12)] <- 0\njob_raw_7C9_roll2_1$h24[is.na(job_raw_7C9_roll2_1$h24)] <- 0\njob_raw_7C9_roll2_1$h36[is.na(job_raw_7C9_roll2_1$h36)] <- 0\njob_raw_7C9_roll2_1$h48[is.na(job_raw_7C9_roll2_1$h48)] <- 0\njob_raw_7C9_roll2_1$etc[is.na(job_raw_7C9_roll2_1$etc)] <- 0\n\njob_raw_7C9_roll2_h2436 <- job_raw_7C9_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C9_roll2_1<-left_join(job_raw_7C9_roll2_1, job_raw_7C9_roll2_h2436)\njob_raw_7C9_roll2_h3648 <- job_raw_7C9_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C9_roll2_1<-left_join(job_raw_7C9_roll2_1, job_raw_7C9_roll2_h3648)\njob_raw_7C9_roll2_h2448 <- job_raw_7C9_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C9_roll2_1<-left_join(job_raw_7C9_roll2_1, job_raw_7C9_roll2_h2448)\n\njob_raw_7C9_roll2_mean <- job_raw_7C9_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\njob_raw_7C9_roll2_1<-left_join(job_raw_7C9_roll2_1, job_raw_7C9_roll2_mean)\n\njob_raw_7C9_roll2_rate <- job_raw_7C9_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C9_roll2_1<-left_join(job_raw_7C9_roll2_1, job_raw_7C9_roll2_rate)\n\njob_raw_7C9_roll2_1$rate[is.nan(job_raw_7C9_roll2_1$rate) | is.infinite(job_raw_7C9_roll2_1$rate)] <- 0\n\njob_raw_7C9_roll2_opening<-job_raw_7C9_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C9_roll2_final <- left_join(job_raw_7C9_roll2_opening, job_raw_7C9_roll2_1)\njob_raw_7C9_roll2_final<-unique(job_raw_7C9_roll2_final)\n\n\nrm(list=c('job_raw_7C9_roll2_1','job_raw_7C9_roll2_h12','job_raw_7C9_roll2_h24','job_raw_7C9_roll2_h36','job_raw_7C9_roll2_h48','job_raw_7C9_roll2_h2436','job_raw_7C9_roll2_h3648','job_raw_7C9_roll2_h2448',\n          'job_raw_7C9_roll2_mean','job_raw_7C9_roll2_rate','job_raw_7C9_roll2_opening'))\n\nwrite.csv(job_raw_7C9_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C9_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\njob_raw_7C10_2<- left_join(job_raw_7C10, job_recruit_sub)\n\njob_raw_7C10_2$date_new <- as.POSIXct(job_raw_7C10_2$date)\n\njob_raw_7C10_2$diff <- (job_raw_7C10_2$date_new - job_raw_7C10_2$opening_dt_new)\njob_raw_7C10_2 <- job_raw_7C10_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-job_raw_7C10_2$opening_dt_new\njob_raw_7C10_2$dtparts <- format(as, \"%H:%M:%S\")\njob_raw_7C10_roll2<- job_raw_7C10_2 %>% filter(dtparts>=\"12:00:00\")\njob_raw_7C10_roll1<- job_raw_7C10_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\njob_raw_7C10_roll1_1 <- job_raw_7C10_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C10_roll1_h12 <- job_raw_7C10_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C10_roll1_1 <- left_join(job_raw_7C10_roll1_1, job_raw_7C10_roll1_h12)\njob_raw_7C10_roll1_h24 <- job_raw_7C10_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C10_roll1_1 <- left_join(job_raw_7C10_roll1_1, job_raw_7C10_roll1_h24)\njob_raw_7C10_roll1_h36 <- job_raw_7C10_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C10_roll1_1 <- left_join(job_raw_7C10_roll1_1, job_raw_7C10_roll1_h36)\njob_raw_7C10_roll1_h48 <- job_raw_7C10_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C10_roll1_1 <- left_join(job_raw_7C10_roll1_1, job_raw_7C10_roll1_h48)\njob_raw_7C10_roll1_etc <- job_raw_7C10_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C10_roll1_1 <- left_join(job_raw_7C10_roll1_1, job_raw_7C10_roll1_etc)\n\n\njob_raw_7C10_roll1_1$h12[is.na(job_raw_7C10_roll1_1$h12)] <- 0\njob_raw_7C10_roll1_1$h24[is.na(job_raw_7C10_roll1_1$h24)] <- 0\njob_raw_7C10_roll1_1$h36[is.na(job_raw_7C10_roll1_1$h36)] <- 0\njob_raw_7C10_roll1_1$h48[is.na(job_raw_7C10_roll1_1$h48)] <- 0\njob_raw_7C10_roll1_1$etc[is.na(job_raw_7C10_roll1_1$etc)] <- 0\n\njob_raw_7C10_roll1_h2436 <- job_raw_7C10_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C10_roll1_1<-left_join(job_raw_7C10_roll1_1, job_raw_7C10_roll1_h2436)\njob_raw_7C10_roll1_h3648 <- job_raw_7C10_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C10_roll1_1<-left_join(job_raw_7C10_roll1_1, job_raw_7C10_roll1_h3648)\njob_raw_7C10_roll1_h2448 <- job_raw_7C10_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C10_roll1_1<-left_join(job_raw_7C10_roll1_1, job_raw_7C10_roll1_h2448)\n\njob_raw_7C10_roll1_mean <- job_raw_7C10_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\njob_raw_7C10_roll1_1<-left_join(job_raw_7C10_roll1_1, job_raw_7C10_roll1_mean)\n\njob_raw_7C10_roll1_rate <- job_raw_7C10_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C10_roll1_1<-left_join(job_raw_7C10_roll1_1, job_raw_7C10_roll1_rate)\n\njob_raw_7C10_roll1_1$rate[is.nan(job_raw_7C10_roll1_1$rate) | is.infinite(job_raw_7C10_roll1_1$rate)] <- 0\n\n\njob_raw_7C10_roll1_opening<-job_raw_7C10_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C10_roll1_final <- left_join(job_raw_7C10_roll1_opening, job_raw_7C10_roll1_1)\njob_raw_7C10_roll1_final<-unique(job_raw_7C10_roll1_final)\n\nrm(list=c('job_raw_7C10_roll1_1','job_raw_7C10_roll1_h12','job_raw_7C10_roll1_h24','job_raw_7C10_roll1_h36','job_raw_7C10_roll1_h48','job_raw_7C10_roll1_h2436','job_raw_7C10_roll1_h3648','job_raw_7C10_roll1_h2448',\n          'job_raw_7C10_roll1_mean','job_raw_7C10_roll1_rate','job_raw_7C10_roll1_opening'))\n\nwrite.csv(job_raw_7C10_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C10_roll1_final.csv\")     \n\n\n# roll 2\njob_raw_7C10_roll2_1 <- job_raw_7C10_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C10_roll2_h12 <- job_raw_7C10_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C10_roll2_1 <- left_join(job_raw_7C10_roll2_1, job_raw_7C10_roll2_h12)\njob_raw_7C10_roll2_h24 <- job_raw_7C10_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C10_roll2_1 <- left_join(job_raw_7C10_roll2_1, job_raw_7C10_roll2_h24)\njob_raw_7C10_roll2_h36 <- job_raw_7C10_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C10_roll2_1 <- left_join(job_raw_7C10_roll2_1, job_raw_7C10_roll2_h36)\njob_raw_7C10_roll2_h48 <- job_raw_7C10_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C10_roll2_1 <- left_join(job_raw_7C10_roll2_1, job_raw_7C10_roll2_h48)\njob_raw_7C10_roll2_etc <- job_raw_7C10_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C10_roll2_1 <- left_join(job_raw_7C10_roll2_1, job_raw_7C10_roll2_etc)\n\njob_raw_7C10_roll2_1$h12[is.na(job_raw_7C10_roll2_1$h12)] <- 0\njob_raw_7C10_roll2_1$h24[is.na(job_raw_7C10_roll2_1$h24)] <- 0\njob_raw_7C10_roll2_1$h36[is.na(job_raw_7C10_roll2_1$h36)] <- 0\njob_raw_7C10_roll2_1$h48[is.na(job_raw_7C10_roll2_1$h48)] <- 0\njob_raw_7C10_roll2_1$etc[is.na(job_raw_7C10_roll2_1$etc)] <- 0\n\njob_raw_7C10_roll2_h2436 <- job_raw_7C10_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C10_roll2_1<-left_join(job_raw_7C10_roll2_1, job_raw_7C10_roll2_h2436)\njob_raw_7C10_roll2_h3648 <- job_raw_7C10_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C10_roll2_1<-left_join(job_raw_7C10_roll2_1, job_raw_7C10_roll2_h3648)\njob_raw_7C10_roll2_h2448 <- job_raw_7C10_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C10_roll2_1<-left_join(job_raw_7C10_roll2_1, job_raw_7C10_roll2_h2448)\n\njob_raw_7C10_roll2_mean <- job_raw_7C10_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\njob_raw_7C10_roll2_1<-left_join(job_raw_7C10_roll2_1, job_raw_7C10_roll2_mean)\n\njob_raw_7C10_roll2_rate <- job_raw_7C10_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C10_roll2_1<-left_join(job_raw_7C10_roll2_1, job_raw_7C10_roll2_rate)\n\njob_raw_7C10_roll2_1$rate[is.nan(job_raw_7C10_roll2_1$rate) | is.infinite(job_raw_7C10_roll2_1$rate)] <- 0\n\njob_raw_7C10_roll2_opening<-job_raw_7C10_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C10_roll2_final <- left_join(job_raw_7C10_roll2_opening, job_raw_7C10_roll2_1)\njob_raw_7C10_roll2_final<-unique(job_raw_7C10_roll2_final)\n\n\nrm(list=c('job_raw_7C10_roll2_1','job_raw_7C10_roll2_h12','job_raw_7C10_roll2_h24','job_raw_7C10_roll2_h36','job_raw_7C10_roll2_h48','job_raw_7C10_roll2_h2436','job_raw_7C10_roll2_h3648','job_raw_7C10_roll2_h2448',\n          'job_raw_7C10_roll2_mean','job_raw_7C10_roll2_rate','job_raw_7C10_roll2_opening'))\n\nwrite.csv(job_raw_7C10_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C10_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\njob_raw_7C11_2<- left_join(job_raw_7C11, job_recruit_sub)\n\njob_raw_7C11_2$date_new <- as.POSIXct(job_raw_7C11_2$date)\n\njob_raw_7C11_2$diff <- (job_raw_7C11_2$date_new - job_raw_7C11_2$opening_dt_new)*60\njob_raw_7C11_2 <- job_raw_7C11_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-job_raw_7C11_2$opening_dt_new\njob_raw_7C11_2$dtparts <- format(as, \"%H:%M:%S\")\njob_raw_7C11_roll2<- job_raw_7C11_2 %>% filter(dtparts>=\"12:00:00\")\njob_raw_7C11_roll1<- job_raw_7C11_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\njob_raw_7C11_roll1_1 <- job_raw_7C11_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C11_roll1_h12 <- job_raw_7C11_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C11_roll1_1 <- left_join(job_raw_7C11_roll1_1, job_raw_7C11_roll1_h12)\njob_raw_7C11_roll1_h24 <- job_raw_7C11_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C11_roll1_1 <- left_join(job_raw_7C11_roll1_1, job_raw_7C11_roll1_h24)\njob_raw_7C11_roll1_h36 <- job_raw_7C11_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C11_roll1_1 <- left_join(job_raw_7C11_roll1_1, job_raw_7C11_roll1_h36)\njob_raw_7C11_roll1_h48 <- job_raw_7C11_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C11_roll1_1 <- left_join(job_raw_7C11_roll1_1, job_raw_7C11_roll1_h48)\njob_raw_7C11_roll1_etc <- job_raw_7C11_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C11_roll1_1 <- left_join(job_raw_7C11_roll1_1, job_raw_7C11_roll1_etc)\n\njob_raw_7C11_roll1_1$h12[is.na(job_raw_7C11_roll1_1$h12)] <- 0\njob_raw_7C11_roll1_1$h24[is.na(job_raw_7C11_roll1_1$h24)] <- 0\njob_raw_7C11_roll1_1$h36[is.na(job_raw_7C11_roll1_1$h36)] <- 0\njob_raw_7C11_roll1_1$h48[is.na(job_raw_7C11_roll1_1$h48)] <- 0\njob_raw_7C11_roll1_1$etc[is.na(job_raw_7C11_roll1_1$etc)] <- 0\n\njob_raw_7C11_roll1_h2436 <- job_raw_7C11_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C11_roll1_1<-left_join(job_raw_7C11_roll1_1, job_raw_7C11_roll1_h2436)\njob_raw_7C11_roll1_h3648 <- job_raw_7C11_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C11_roll1_1<-left_join(job_raw_7C11_roll1_1, job_raw_7C11_roll1_h3648)\njob_raw_7C11_roll1_h2448 <- job_raw_7C11_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C11_roll1_1<-left_join(job_raw_7C11_roll1_1, job_raw_7C11_roll1_h2448)\n\njob_raw_7C11_roll1_mean <- job_raw_7C11_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\njob_raw_7C11_roll1_1<-left_join(job_raw_7C11_roll1_1, job_raw_7C11_roll1_mean)\n\njob_raw_7C11_roll1_rate <- job_raw_7C11_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C11_roll1_1<-left_join(job_raw_7C11_roll1_1, job_raw_7C11_roll1_rate)\n\njob_raw_7C11_roll1_1$rate[is.nan(job_raw_7C11_roll1_1$rate) | is.infinite(job_raw_7C11_roll1_1$rate)] <- 0\n\n\njob_raw_7C11_roll1_opening<-job_raw_7C11_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C11_roll1_final <- left_join(job_raw_7C11_roll1_opening, job_raw_7C11_roll1_1)\njob_raw_7C11_roll1_final<-unique(job_raw_7C11_roll1_final)\n\nrm(list=c('job_raw_7C11_roll1_1','job_raw_7C11_roll1_h12','job_raw_7C11_roll1_h24','job_raw_7C11_roll1_h36','job_raw_7C11_roll1_h48','job_raw_7C11_roll1_h2436','job_raw_7C11_roll1_h3648','job_raw_7C11_roll1_h2448',\n          'job_raw_7C11_roll1_mean','job_raw_7C11_roll1_rate','job_raw_7C11_roll1_opening'))\n\nwrite.csv(job_raw_7C11_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C11_roll1_final.csv\")     \n\n\n# roll 2\njob_raw_7C11_roll2_1 <- job_raw_7C11_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C11_roll2_h12 <- job_raw_7C11_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C11_roll2_1 <- left_join(job_raw_7C11_roll2_1, job_raw_7C11_roll2_h12)\njob_raw_7C11_roll2_h24 <- job_raw_7C11_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C11_roll2_1 <- left_join(job_raw_7C11_roll2_1, job_raw_7C11_roll2_h24)\njob_raw_7C11_roll2_h36 <- job_raw_7C11_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C11_roll2_1 <- left_join(job_raw_7C11_roll2_1, job_raw_7C11_roll2_h36)\njob_raw_7C11_roll2_h48 <- job_raw_7C11_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C11_roll2_1 <- left_join(job_raw_7C11_roll2_1, job_raw_7C11_roll2_h48)\njob_raw_7C11_roll2_etc <- job_raw_7C11_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C11_roll2_1 <- left_join(job_raw_7C11_roll2_1, job_raw_7C11_roll2_etc)\n\njob_raw_7C11_roll2_1$h12[is.na(job_raw_7C11_roll2_1$h12)] <- 0\njob_raw_7C11_roll2_1$h24[is.na(job_raw_7C11_roll2_1$h24)] <- 0\njob_raw_7C11_roll2_1$h36[is.na(job_raw_7C11_roll2_1$h36)] <- 0\njob_raw_7C11_roll2_1$h48[is.na(job_raw_7C11_roll2_1$h48)] <- 0\njob_raw_7C11_roll2_1$etc[is.na(job_raw_7C11_roll2_1$etc)] <- 0\n\njob_raw_7C11_roll2_h2436 <- job_raw_7C11_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C11_roll2_1<-left_join(job_raw_7C11_roll2_1, job_raw_7C11_roll2_h2436)\njob_raw_7C11_roll2_h3648 <- job_raw_7C11_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C11_roll2_1<-left_join(job_raw_7C11_roll2_1, job_raw_7C11_roll2_h3648)\njob_raw_7C11_roll2_h2448 <- job_raw_7C11_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C11_roll2_1<-left_join(job_raw_7C11_roll2_1, job_raw_7C11_roll2_h2448)\n\njob_raw_7C11_roll2_mean <- job_raw_7C11_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\njob_raw_7C11_roll2_1<-left_join(job_raw_7C11_roll2_1, job_raw_7C11_roll2_mean)\n\njob_raw_7C11_roll2_rate <- job_raw_7C11_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C11_roll2_1<-left_join(job_raw_7C11_roll2_1, job_raw_7C11_roll2_rate)\n\njob_raw_7C11_roll2_1$rate[is.nan(job_raw_7C11_roll2_1$rate) | is.infinite(job_raw_7C11_roll2_1$rate)] <- 0\n\njob_raw_7C11_roll2_opening<-job_raw_7C11_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C11_roll2_final <- left_join(job_raw_7C11_roll2_opening, job_raw_7C11_roll2_1)\njob_raw_7C11_roll2_final<-unique(job_raw_7C11_roll2_final)\n\n\nrm(list=c('job_raw_7C11_roll2_1','job_raw_7C11_roll2_h12','job_raw_7C11_roll2_h24','job_raw_7C11_roll2_h36','job_raw_7C11_roll2_h48','job_raw_7C11_roll2_h2436','job_raw_7C11_roll2_h3648','job_raw_7C11_roll2_h2448',\n          'job_raw_7C11_roll2_mean','job_raw_7C11_roll2_rate','job_raw_7C11_roll2_opening'))\n\nwrite.csv(job_raw_7C11_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C11_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\njob_raw_7C12_2<- left_join(job_raw_7C12, job_recruit_sub)\n\njob_raw_7C12_2$date_new <- as.POSIXct(job_raw_7C12_2$date)\n\njob_raw_7C12_2$diff <- (job_raw_7C12_2$date_new - job_raw_7C12_2$opening_dt_new)*60\njob_raw_7C12_2 <- job_raw_7C12_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-job_raw_7C12_2$opening_dt_new\njob_raw_7C12_2$dtparts <- format(as, \"%H:%M:%S\")\njob_raw_7C12_roll2<- job_raw_7C12_2 %>% filter(dtparts>=\"12:00:00\")\njob_raw_7C12_roll1<- job_raw_7C12_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\njob_raw_7C12_roll1_1 <- job_raw_7C12_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C12_roll1_h12 <- job_raw_7C12_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C12_roll1_1 <- left_join(job_raw_7C12_roll1_1, job_raw_7C12_roll1_h12)\njob_raw_7C12_roll1_h24 <- job_raw_7C12_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C12_roll1_1 <- left_join(job_raw_7C12_roll1_1, job_raw_7C12_roll1_h24)\njob_raw_7C12_roll1_h36 <- job_raw_7C12_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C12_roll1_1 <- left_join(job_raw_7C12_roll1_1, job_raw_7C12_roll1_h36)\njob_raw_7C12_roll1_h48 <- job_raw_7C12_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C12_roll1_1 <- left_join(job_raw_7C12_roll1_1, job_raw_7C12_roll1_h48)\njob_raw_7C12_roll1_etc <- job_raw_7C12_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C12_roll1_1 <- left_join(job_raw_7C12_roll1_1, job_raw_7C12_roll1_etc)\n\njob_raw_7C12_roll1_1$h12[is.na(job_raw_7C12_roll1_1$h12)] <- 0\njob_raw_7C12_roll1_1$h24[is.na(job_raw_7C12_roll1_1$h24)] <- 0\njob_raw_7C12_roll1_1$h36[is.na(job_raw_7C12_roll1_1$h36)] <- 0\njob_raw_7C12_roll1_1$h48[is.na(job_raw_7C12_roll1_1$h48)] <- 0\njob_raw_7C12_roll1_1$etc[is.na(job_raw_7C12_roll1_1$etc)] <- 0\n\njob_raw_7C12_roll1_h2436 <- job_raw_7C12_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C12_roll1_1<-left_join(job_raw_7C12_roll1_1, job_raw_7C12_roll1_h2436)\njob_raw_7C12_roll1_h3648 <- job_raw_7C12_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C12_roll1_1<-left_join(job_raw_7C12_roll1_1, job_raw_7C12_roll1_h3648)\njob_raw_7C12_roll1_h2448 <- job_raw_7C12_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C12_roll1_1<-left_join(job_raw_7C12_roll1_1, job_raw_7C12_roll1_h2448)\n\njob_raw_7C12_roll1_mean <- job_raw_7C12_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\njob_raw_7C12_roll1_1<-left_join(job_raw_7C12_roll1_1, job_raw_7C12_roll1_mean)\n\njob_raw_7C12_roll1_rate <- job_raw_7C12_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C12_roll1_1<-left_join(job_raw_7C12_roll1_1, job_raw_7C12_roll1_rate)\n\njob_raw_7C12_roll1_1$rate[is.nan(job_raw_7C12_roll1_1$rate) | is.infinite(job_raw_7C12_roll1_1$rate)] <- 0\n\n\njob_raw_7C12_roll1_opening<-job_raw_7C12_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C12_roll1_final <- left_join(job_raw_7C12_roll1_opening, job_raw_7C12_roll1_1)\njob_raw_7C12_roll1_final<-unique(job_raw_7C12_roll1_final)\n\nrm(list=c('job_raw_7C12_roll1_1','job_raw_7C12_roll1_h12','job_raw_7C12_roll1_h24','job_raw_7C12_roll1_h36','job_raw_7C12_roll1_h48','job_raw_7C12_roll1_h2436','job_raw_7C12_roll1_h3648','job_raw_7C12_roll1_h2448',\n          'job_raw_7C12_roll1_mean','job_raw_7C12_roll1_rate','job_raw_7C12_roll1_opening'))\n\nwrite.csv(job_raw_7C12_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C12_roll1_final.csv\")     \n\n\n# roll 2\njob_raw_7C12_roll2_1 <- job_raw_7C12_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C12_roll2_h12 <- job_raw_7C12_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C12_roll2_1 <- left_join(job_raw_7C12_roll2_1, job_raw_7C12_roll2_h12)\njob_raw_7C12_roll2_h24 <- job_raw_7C12_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C12_roll2_1 <- left_join(job_raw_7C12_roll2_1, job_raw_7C12_roll2_h24)\njob_raw_7C12_roll2_h36 <- job_raw_7C12_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C12_roll2_1 <- left_join(job_raw_7C12_roll2_1, job_raw_7C12_roll2_h36)\njob_raw_7C12_roll2_h48 <- job_raw_7C12_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C12_roll2_1 <- left_join(job_raw_7C12_roll2_1, job_raw_7C12_roll2_h48)\njob_raw_7C12_roll2_etc <- job_raw_7C12_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C12_roll2_1 <- left_join(job_raw_7C12_roll2_1, job_raw_7C12_roll2_etc)\n\njob_raw_7C12_roll2_1$h12[is.na(job_raw_7C12_roll2_1$h12)] <- 0\njob_raw_7C12_roll2_1$h24[is.na(job_raw_7C12_roll2_1$h24)] <- 0\njob_raw_7C12_roll2_1$h36[is.na(job_raw_7C12_roll2_1$h36)] <- 0\njob_raw_7C12_roll2_1$h48[is.na(job_raw_7C12_roll2_1$h48)] <- 0\njob_raw_7C12_roll2_1$etc[is.na(job_raw_7C12_roll2_1$etc)] <- 0\n\njob_raw_7C12_roll2_h2436 <- job_raw_7C12_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C12_roll2_1<-left_join(job_raw_7C12_roll2_1, job_raw_7C12_roll2_h2436)\njob_raw_7C12_roll2_h3648 <- job_raw_7C12_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C12_roll2_1<-left_join(job_raw_7C12_roll2_1, job_raw_7C12_roll2_h3648)\njob_raw_7C12_roll2_h2448 <- job_raw_7C12_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C12_roll2_1<-left_join(job_raw_7C12_roll2_1, job_raw_7C12_roll2_h2448)\n\njob_raw_7C12_roll2_mean <- job_raw_7C12_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\njob_raw_7C12_roll2_1<-left_join(job_raw_7C12_roll2_1, job_raw_7C12_roll2_mean)\n\njob_raw_7C12_roll2_rate <- job_raw_7C12_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C12_roll2_1<-left_join(job_raw_7C12_roll2_1, job_raw_7C12_roll2_rate)\n\njob_raw_7C12_roll2_1$rate[is.nan(job_raw_7C12_roll2_1$rate) | is.infinite(job_raw_7C12_roll2_1$rate)] <- 0\n\njob_raw_7C12_roll2_opening<-job_raw_7C12_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C12_roll2_final <- left_join(job_raw_7C12_roll2_opening, job_raw_7C12_roll2_1)\njob_raw_7C12_roll2_final<-unique(job_raw_7C12_roll2_final)\n\n\nrm(list=c('job_raw_7C12_roll2_1','job_raw_7C12_roll2_h12','job_raw_7C12_roll2_h24','job_raw_7C12_roll2_h36','job_raw_7C12_roll2_h48','job_raw_7C12_roll2_h2436','job_raw_7C12_roll2_h3648','job_raw_7C12_roll2_h2448',\n          'job_raw_7C12_roll2_mean','job_raw_7C12_roll2_rate','job_raw_7C12_roll2_opening'))\n\nwrite.csv(job_raw_7C12_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C12_roll2_final.csv\")     \n\n##############################################################################################################################\n\n\njob_raw_7C13_2<- left_join(job_raw_7C13, job_recruit_sub)\n\njob_raw_7C13_2$date_new <- as.POSIXct(job_raw_7C13_2$date)\n\njob_raw_7C13_2$diff <- (job_raw_7C13_2$date_new - job_raw_7C13_2$opening_dt_new)\njob_raw_7C13_2 <- job_raw_7C13_2 %>% filter(!(diff<0))\n\n#12?? ????À¸?? ?????? ???? (12?? ??...)\n\nas <-job_raw_7C13_2$opening_dt_new\njob_raw_7C13_2$dtparts <- format(as, \"%H:%M:%S\")\njob_raw_7C13_roll2<- job_raw_7C13_2 %>% filter(dtparts>=\"12:00:00\")\njob_raw_7C13_roll1<- job_raw_7C13_2 %>% filter(dtparts<\"12:00:00\")\n\n# 12?Ã°??? ???Î¿? ???? ????\n# roll 1\njob_raw_7C13_roll1_1 <- job_raw_7C13_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C13_roll1_h12 <- job_raw_7C13_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C13_roll1_1 <- left_join(job_raw_7C13_roll1_1, job_raw_7C13_roll1_h12)\njob_raw_7C13_roll1_h24 <- job_raw_7C13_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C13_roll1_1 <- left_join(job_raw_7C13_roll1_1, job_raw_7C13_roll1_h24)\njob_raw_7C13_roll1_h36 <- job_raw_7C13_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C13_roll1_1 <- left_join(job_raw_7C13_roll1_1, job_raw_7C13_roll1_h36)\njob_raw_7C13_roll1_h48 <- job_raw_7C13_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C13_roll1_1 <- left_join(job_raw_7C13_roll1_1, job_raw_7C13_roll1_h48)\njob_raw_7C13_roll1_etc <- job_raw_7C13_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C13_roll1_1 <- left_join(job_raw_7C13_roll1_1, job_raw_7C13_roll1_etc)\n\njob_raw_7C13_roll1_1$h12[is.na(job_raw_7C13_roll1_1$h12)] <- 0\njob_raw_7C13_roll1_1$h24[is.na(job_raw_7C13_roll1_1$h24)] <- 0\njob_raw_7C13_roll1_1$h36[is.na(job_raw_7C13_roll1_1$h36)] <- 0\njob_raw_7C13_roll1_1$h48[is.na(job_raw_7C13_roll1_1$h48)] <- 0\njob_raw_7C13_roll1_1$etc[is.na(job_raw_7C13_roll1_1$etc)] <- 0\n\njob_raw_7C13_roll1_h2436 <- job_raw_7C13_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C13_roll1_1<-left_join(job_raw_7C13_roll1_1, job_raw_7C13_roll1_h2436)\njob_raw_7C13_roll1_h3648 <- job_raw_7C13_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C13_roll1_1<-left_join(job_raw_7C13_roll1_1, job_raw_7C13_roll1_h3648)\njob_raw_7C13_roll1_h2448 <- job_raw_7C13_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C13_roll1_1<-left_join(job_raw_7C13_roll1_1, job_raw_7C13_roll1_h2448)\n\njob_raw_7C13_roll1_mean <- job_raw_7C13_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\njob_raw_7C13_roll1_1<-left_join(job_raw_7C13_roll1_1, job_raw_7C13_roll1_mean)\n\njob_raw_7C13_roll1_rate <- job_raw_7C13_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C13_roll1_1<-left_join(job_raw_7C13_roll1_1, job_raw_7C13_roll1_rate)\n\njob_raw_7C13_roll1_1$rate[is.nan(job_raw_7C13_roll1_1$rate) | is.infinite(job_raw_7C13_roll1_1$rate)] <- 0\n\n\njob_raw_7C13_roll1_opening<-job_raw_7C13_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C13_roll1_final <- left_join(job_raw_7C13_roll1_opening, job_raw_7C13_roll1_1)\njob_raw_7C13_roll1_final<-unique(job_raw_7C13_roll1_final)\n\nrm(list=c('job_raw_7C13_roll1_1','job_raw_7C13_roll1_h12','job_raw_7C13_roll1_h24','job_raw_7C13_roll1_h36','job_raw_7C13_roll1_h48','job_raw_7C13_roll1_h2436','job_raw_7C13_roll1_h3648','job_raw_7C13_roll1_h2448',\n          'job_raw_7C13_roll1_mean','job_raw_7C13_roll1_rate','job_raw_7C13_roll1_opening'))\n\nwrite.csv(job_raw_7C13_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C13_roll1_final.csv\")     \n\n\n# roll 2\njob_raw_7C13_roll2_1 <- job_raw_7C13_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\njob_raw_7C13_roll2_h12 <- job_raw_7C13_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\njob_raw_7C13_roll2_1 <- left_join(job_raw_7C13_roll2_1, job_raw_7C13_roll2_h12)\njob_raw_7C13_roll2_h24 <- job_raw_7C13_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\njob_raw_7C13_roll2_1 <- left_join(job_raw_7C13_roll2_1, job_raw_7C13_roll2_h24)\njob_raw_7C13_roll2_h36 <- job_raw_7C13_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\njob_raw_7C13_roll2_1 <- left_join(job_raw_7C13_roll2_1, job_raw_7C13_roll2_h36)\njob_raw_7C13_roll2_h48 <- job_raw_7C13_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\njob_raw_7C13_roll2_1 <- left_join(job_raw_7C13_roll2_1, job_raw_7C13_roll2_h48)\njob_raw_7C13_roll2_etc <- job_raw_7C13_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\njob_raw_7C13_roll2_1 <- left_join(job_raw_7C13_roll2_1, job_raw_7C13_roll2_etc)\n\njob_raw_7C13_roll2_1$h12[is.na(job_raw_7C13_roll2_1$h12)] <- 0\njob_raw_7C13_roll2_1$h24[is.na(job_raw_7C13_roll2_1$h24)] <- 0\njob_raw_7C13_roll2_1$h36[is.na(job_raw_7C13_roll2_1$h36)] <- 0\njob_raw_7C13_roll2_1$h48[is.na(job_raw_7C13_roll2_1$h48)] <- 0\njob_raw_7C13_roll2_1$etc[is.na(job_raw_7C13_roll2_1$etc)] <- 0\n\njob_raw_7C13_roll2_h2436 <- job_raw_7C13_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\njob_raw_7C13_roll2_1<-left_join(job_raw_7C13_roll2_1, job_raw_7C13_roll2_h2436)\njob_raw_7C13_roll2_h3648 <- job_raw_7C13_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\njob_raw_7C13_roll2_1<-left_join(job_raw_7C13_roll2_1, job_raw_7C13_roll2_h3648)\njob_raw_7C13_roll2_h2448 <- job_raw_7C13_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\njob_raw_7C13_roll2_1<-left_join(job_raw_7C13_roll2_1, job_raw_7C13_roll2_h2448)\n\njob_raw_7C13_roll2_mean <- job_raw_7C13_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\njob_raw_7C13_roll2_1<-left_join(job_raw_7C13_roll2_1, job_raw_7C13_roll2_mean)\n\njob_raw_7C13_roll2_rate <- job_raw_7C13_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C13_roll2_1<-left_join(job_raw_7C13_roll2_1, job_raw_7C13_roll2_rate)\n\njob_raw_7C13_roll2_1$rate[is.nan(job_raw_7C13_roll2_1$rate) | is.infinite(job_raw_7C13_roll2_1$rate)] <- 0\n\njob_raw_7C13_roll2_opening<-job_raw_7C13_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\njob_raw_7C13_roll2_final <- left_join(job_raw_7C13_roll2_opening, job_raw_7C13_roll2_1)\njob_raw_7C13_roll2_final<-unique(job_raw_7C13_roll2_final)\n\n\nrm(list=c('job_raw_7C13_roll2_1','job_raw_7C13_roll2_h12','job_raw_7C13_roll2_h24','job_raw_7C13_roll2_h36','job_raw_7C13_roll2_h48','job_raw_7C13_roll2_h2436','job_raw_7C13_roll2_h3648','job_raw_7C13_roll2_h2448',\n          'job_raw_7C13_roll2_mean','job_raw_7C13_roll2_rate','job_raw_7C13_roll2_opening'))\n\nwrite.csv(job_raw_7C13_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[job]?Ð¼? ??????/job_raw_7C13_roll2_final.csv\")     \n\n\n##############################################################################################################################\n#                                                                                                                            #\n#                                    ???? 12?Ã°? ???? ?Ñ¾??â°£ Á¶È¸?? ??????À² ???? (roll1 + roll2)                          #\n#                                                                                                                            #\n#         1. ???????? ????(roll1) + ???Äµ??? ????(roll2)                                                                     #\n#         2. ???? 12?Ã°? ???? ?Ñ¾??â°£ Á¶È¸?? ??????À² ????                                                                  #\n#         3. ???? 12?Ã°?(h12)?? 0?? ???? Á¦??                                                                                #\n#         4. 12/04 ???? ???Ï¸? ?Ð¼? ????                                                                                     #\n#           (closing_dt?? 1/1??À» ?Ñ¾î°¡?? ?Ê´? ?????Í¸? ???Ï±? À§??. ?? ??À¯?? 1/1 ?????? ?????Í´? ??À¯?Ï°? ???? ??À½)      #\n#                                                                                                                            #\n##############################################################################################################################\n\n##############################################################################################################################\n#                                                        ????(area)                                                          #\n##############################################################################################################################\n\n\narea_raw_101000_roll1_sub <- area_raw_101000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12, etc, rollup_total)\narea_raw_101000_roll2_sub <- area_raw_101000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc, rollup24_36)\ncolnames(area_raw_101000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\",  \"rollup_total\") \n\narea_raw_101000_total <- rbind(area_raw_101000_roll1_sub, area_raw_101000_roll2_sub)\n\narea_raw_101000_total_1 <- area_raw_101000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_101000_total <- left_join(area_raw_101000_total, area_raw_101000_total_1)\n\narea_raw_101000_total_2 <- area_raw_101000_total %>% filter(h12 != 0)\n\n\n\n#####\narea_raw_102000_roll1_sub <- area_raw_102000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_102000_roll2_sub <- area_raw_102000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_102000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\",  \"rollup_total\") \n\narea_raw_102000_total <- rbind(area_raw_102000_roll1_sub, area_raw_102000_roll2_sub)\n\narea_raw_102000_total_1 <- area_raw_102000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_102000_total <- left_join(area_raw_102000_total, area_raw_102000_total_1)\n\narea_raw_102000_total_2 <- area_raw_102000_total %>% filter(h12 != 0)\n\n#####\narea_raw_103000_roll1_sub <- area_raw_103000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_103000_roll2_sub <- area_raw_103000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_103000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_103000_total <- rbind(area_raw_103000_roll1_sub, area_raw_103000_roll2_sub)\n\narea_raw_103000_total_1 <- area_raw_103000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_103000_total <- left_join(area_raw_103000_total, area_raw_103000_total_1)\n\narea_raw_103000_total_2 <- area_raw_103000_total %>% filter(h12 != 0)\n\n\n\n#####\narea_raw_104000_roll1_sub <- area_raw_104000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_104000_roll2_sub <- area_raw_104000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_104000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_104000_total <- rbind(area_raw_104000_roll1_sub, area_raw_104000_roll2_sub)\n\narea_raw_104000_total_1 <- area_raw_104000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_104000_total <- left_join(area_raw_104000_total, area_raw_104000_total_1)\n\narea_raw_104000_total_2 <- area_raw_104000_total %>% filter(h12 != 0)\n\n\n#####\narea_raw_105000_roll1_sub <- area_raw_105000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_105000_roll2_sub <- area_raw_105000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_105000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_105000_total <- rbind(area_raw_105000_roll1_sub, area_raw_105000_roll2_sub)\n\narea_raw_105000_total_1 <- area_raw_105000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_105000_total <- left_join(area_raw_105000_total, area_raw_105000_total_1)\n\narea_raw_105000_total_2 <- area_raw_105000_total %>% filter(h12 != 0)\n\n\n#####\narea_raw_106000_roll1_sub <- area_raw_106000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_106000_roll2_sub <- area_raw_106000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_106000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_106000_total <- rbind(area_raw_106000_roll1_sub, area_raw_106000_roll2_sub)\n\narea_raw_106000_total_1 <- area_raw_106000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_106000_total <- left_join(area_raw_106000_total, area_raw_106000_total_1)\n\narea_raw_106000_total_2 <- area_raw_106000_total %>% filter(h12 != 0)\n\n\n#####\narea_raw_107000_roll1_sub <- area_raw_107000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_107000_roll2_sub <- area_raw_107000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_107000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_107000_total <- rbind(area_raw_107000_roll1_sub, area_raw_107000_roll2_sub)\n\narea_raw_107000_total_1 <- area_raw_107000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_107000_total <- left_join(area_raw_107000_total, area_raw_107000_total_1)\n\narea_raw_107000_total_2 <- area_raw_107000_total %>% filter(h12 != 0)\n\n#####\narea_raw_108000_roll1_sub <- area_raw_108000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_108000_roll2_sub <- area_raw_108000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_108000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_108000_total <- rbind(area_raw_108000_roll1_sub, area_raw_108000_roll2_sub)\n\narea_raw_108000_total_1 <- area_raw_108000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_108000_total <- left_join(area_raw_108000_total, area_raw_108000_total_1)\n\narea_raw_108000_total_2 <- area_raw_108000_total %>% filter(h12 != 0)\n\n\n#####\narea_raw_109000_roll1_sub <- area_raw_109000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_109000_roll2_sub <- area_raw_109000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_109000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_109000_total <- rbind(area_raw_109000_roll1_sub, area_raw_109000_roll2_sub)\n\narea_raw_109000_total_1 <- area_raw_109000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_109000_total <- left_join(area_raw_109000_total, area_raw_109000_total_1)\n\narea_raw_109000_total_2 <- area_raw_109000_total %>% filter(h12 != 0)\n\n\n#####\narea_raw_110000_roll1_sub <- area_raw_110000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_110000_roll2_sub <- area_raw_110000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_110000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_110000_total <- rbind(area_raw_110000_roll1_sub, area_raw_110000_roll2_sub)\n\narea_raw_110000_total_1 <- area_raw_110000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_110000_total <- left_join(area_raw_110000_total, area_raw_110000_total_1)\n\narea_raw_110000_total_2 <- area_raw_110000_total %>% filter(h12 != 0)\n\n\n#####\narea_raw_111000_roll1_sub <- area_raw_111000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_111000_roll2_sub <- area_raw_111000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_111000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_111000_total <- rbind(area_raw_111000_roll1_sub, area_raw_111000_roll2_sub)\n\narea_raw_111000_total_1 <- area_raw_111000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_111000_total <- left_join(area_raw_111000_total, area_raw_111000_total_1)\n\narea_raw_111000_total_2 <- area_raw_111000_total %>% filter(h12 != 0)\n\n\n#####\narea_raw_112000_roll1_sub <- area_raw_112000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_112000_roll2_sub <- area_raw_112000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_112000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_112000_total <- rbind(area_raw_112000_roll1_sub, area_raw_112000_roll2_sub)\n\narea_raw_112000_total_1 <- area_raw_112000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_112000_total <- left_join(area_raw_112000_total, area_raw_112000_total_1)\n\narea_raw_112000_total_2 <- area_raw_112000_total %>% filter(h12 != 0)\n\n\n#####\narea_raw_113000_roll1_sub <- area_raw_113000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_113000_roll2_sub <- area_raw_113000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_113000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_113000_total <- rbind(area_raw_113000_roll1_sub, area_raw_113000_roll2_sub)\n\narea_raw_113000_total_1 <- area_raw_113000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_113000_total <- left_join(area_raw_113000_total, area_raw_113000_total_1)\n\narea_raw_113000_total_2 <- area_raw_113000_total %>% filter(h12 != 0)\n\n\n#####\narea_raw_114000_roll1_sub <- area_raw_114000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_114000_roll2_sub <- area_raw_114000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_114000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_114000_total <- rbind(area_raw_114000_roll1_sub, area_raw_114000_roll2_sub)\n\narea_raw_114000_total_1 <- area_raw_114000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_114000_total <- left_join(area_raw_114000_total, area_raw_114000_total_1)\n\narea_raw_114000_total_2 <- area_raw_114000_total %>% filter(h12 != 0)\n\n\n#####\narea_raw_115000_roll1_sub <- area_raw_115000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_115000_roll2_sub <- area_raw_115000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_115000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_115000_total <- rbind(area_raw_115000_roll1_sub, area_raw_115000_roll2_sub)\n\narea_raw_115000_total_1 <- area_raw_115000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_115000_total <- left_join(area_raw_115000_total, area_raw_115000_total_1)\n\narea_raw_115000_total_2 <- area_raw_115000_total %>% filter(h12 != 0)\n\n\n#####\narea_raw_116000_roll1_sub <- area_raw_116000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_116000_roll2_sub <- area_raw_116000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_116000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_116000_total <- rbind(area_raw_116000_roll1_sub, area_raw_116000_roll2_sub)\n\narea_raw_116000_total_1 <- area_raw_116000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_116000_total <- left_join(area_raw_116000_total, area_raw_116000_total_1)\n\narea_raw_116000_total_2 <- area_raw_116000_total %>% filter(h12 != 0)\n\n\n#####\narea_raw_117000_roll1_sub <- area_raw_117000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_117000_roll2_sub <- area_raw_117000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_117000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_117000_total <- rbind(area_raw_117000_roll1_sub, area_raw_117000_roll2_sub)\n\narea_raw_117000_total_1 <- area_raw_117000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_117000_total <- left_join(area_raw_117000_total, area_raw_117000_total_1)\n\narea_raw_117000_total_2 <- area_raw_117000_total %>% filter(h12 != 0)\n\n#####\narea_raw_118000_roll1_sub <- area_raw_118000_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\narea_raw_118000_roll2_sub <- area_raw_118000_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(area_raw_118000_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\narea_raw_118000_total <- rbind(area_raw_118000_roll1_sub, area_raw_118000_roll2_sub)\n\narea_raw_118000_total_1 <- area_raw_118000_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\narea_raw_118000_total <- left_join(area_raw_118000_total, area_raw_118000_total_1)\n\narea_raw_118000_total_2 <- area_raw_118000_total %>% filter(h12 != 0)\n\n##### ~ 12/4 ??????\n\narea_raw_101000_total_3 <- area_raw_101000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_102000_total_3 <- area_raw_102000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_103000_total_3 <- area_raw_103000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_104000_total_3 <- area_raw_104000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_105000_total_3 <- area_raw_105000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_106000_total_3 <- area_raw_106000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_107000_total_3 <- area_raw_107000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_108000_total_3 <- area_raw_108000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_109000_total_3 <- area_raw_109000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_110000_total_3 <- area_raw_110000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_111000_total_3 <- area_raw_111000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_112000_total_3 <- area_raw_112000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_113000_total_3 <- area_raw_113000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_114000_total_3 <- area_raw_114000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_115000_total_3 <- area_raw_115000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_116000_total_3 <- area_raw_116000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_117000_total_3 <- area_raw_117000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\narea_raw_118000_total_3 <- area_raw_118000_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\n\n\n##### ?? ?????? Á¶È¸?? ??????À²(rate) ??????\nhist(area_raw_101000_total_3$rate, xlim=c(0,400), breaks=400, freq = T)\nhist(area_raw_102000_total_3$rate, xlim=c(0,400), breaks=400, freq = T)\nhist(area_raw_103000_total_3$rate, xlim=c(0,400), breaks=100, freq = T)\nhist(area_raw_104000_total_3$rate, xlim=c(0,400), breaks=400, freq = T)\nhist(area_raw_105000_total_3$rate, xlim=c(0,400), breaks=200, freq = T)\nhist(area_raw_106000_total_3$rate, xlim=c(0,400), breaks=800, freq = T)\nhist(area_raw_107000_total_3$rate, xlim=c(0,400), breaks=400, freq = T)\nhist(area_raw_108000_total_3$rate, xlim=c(0,400), breaks=200, freq = T)\nhist(area_raw_109000_total_3$rate, xlim=c(0,400), breaks=200, freq = T)\nhist(area_raw_110000_total_3$rate, xlim=c(0,400), breaks=200, freq = T)\nhist(area_raw_111000_total_3$rate, xlim=c(0,400), breaks=200, freq = T)\nhist(area_raw_112000_total_3$rate, xlim=c(0,400), breaks=200, freq = T)\nhist(area_raw_113000_total_3$rate, xlim=c(0,400), breaks=200, freq = T)\nhist(area_raw_114000_total_3$rate, xlim=c(0,400), breaks=200, freq = T)\nhist(area_raw_115000_total_3$rate, xlim=c(0,400), breaks=200, freq = T)\nhist(area_raw_116000_total_3$rate, xlim=c(0,400), breaks=100, freq = T)\nhist(area_raw_117000_total_3$rate, xlim=c(0,400), breaks=50, freq = T)\nhist(area_raw_118000_total_3$rate, xlim=c(0,400), breaks=200, freq = T)\npng()\ndev.off()\n\n##############################################################################################################################\n#                                                        ??Á¾(job)                                                           #\n##############################################################################################################################\n\njob_raw_7C1_roll1_sub <- job_raw_7C1_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\njob_raw_7C1_roll2_sub <- job_raw_7C1_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(job_raw_7C1_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\njob_raw_7C1_total <- rbind(job_raw_7C1_roll1_sub, job_raw_7C1_roll2_sub)\n\njob_raw_7C1_total_1 <- job_raw_7C1_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C1_total <- left_join(job_raw_7C1_total, job_raw_7C1_total_1)\n\njob_raw_7C1_total_2 <- job_raw_7C1_total %>% filter(h12 != 0)\n#####\njob_raw_7C2_roll1_sub <- job_raw_7C2_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\njob_raw_7C2_roll2_sub <- job_raw_7C2_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(job_raw_7C2_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\njob_raw_7C2_total <- rbind(job_raw_7C2_roll1_sub, job_raw_7C2_roll2_sub)\n\njob_raw_7C2_total_1 <- job_raw_7C2_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C2_total <- left_join(job_raw_7C2_total, job_raw_7C2_total_1)\n\njob_raw_7C2_total_2 <- job_raw_7C2_total %>% filter(h12 != 0)\n#####\njob_raw_7C3_roll1_sub <- job_raw_7C3_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\njob_raw_7C3_roll2_sub <- job_raw_7C3_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(job_raw_7C3_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\njob_raw_7C3_total <- rbind(job_raw_7C3_roll1_sub, job_raw_7C3_roll2_sub)\n\njob_raw_7C3_total_1 <- job_raw_7C3_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C3_total <- left_join(job_raw_7C3_total, job_raw_7C3_total_1)\n\njob_raw_7C3_total_2 <- job_raw_7C3_total %>% filter(h12 != 0)\n#####\njob_raw_7C4_roll1_sub <- job_raw_7C4_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\njob_raw_7C4_roll2_sub <- job_raw_7C4_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(job_raw_7C4_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\njob_raw_7C4_total <- rbind(job_raw_7C4_roll1_sub, job_raw_7C4_roll2_sub)\n\njob_raw_7C4_total_1 <- job_raw_7C4_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C4_total <- left_join(job_raw_7C4_total, job_raw_7C4_total_1)\n\njob_raw_7C4_total_2 <- job_raw_7C4_total %>% filter(h12 != 0)\n#####\njob_raw_7C5_roll1_sub <- job_raw_7C5_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\njob_raw_7C5_roll2_sub <- job_raw_7C5_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(job_raw_7C5_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\njob_raw_7C5_total <- rbind(job_raw_7C5_roll1_sub, job_raw_7C5_roll2_sub)\n\njob_raw_7C5_total_1 <- job_raw_7C5_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C5_total <- left_join(job_raw_7C5_total, job_raw_7C5_total_1)\n\njob_raw_7C5_total_2 <- job_raw_7C5_total %>% filter(h12 != 0)\n#####\njob_raw_7C6_roll1_sub <- job_raw_7C6_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\njob_raw_7C6_roll2_sub <- job_raw_7C6_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(job_raw_7C6_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\njob_raw_7C6_total <- rbind(job_raw_7C6_roll1_sub, job_raw_7C6_roll2_sub)\n\njob_raw_7C6_total_1 <- job_raw_7C6_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C6_total <- left_join(job_raw_7C6_total, job_raw_7C6_total_1)\n\njob_raw_7C6_total_2 <- job_raw_7C6_total %>% filter(h12 != 0)\n#####\njob_raw_7C7_roll1_sub <- job_raw_7C7_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\njob_raw_7C7_roll2_sub <- job_raw_7C7_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(job_raw_7C7_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\njob_raw_7C7_total <- rbind(job_raw_7C7_roll1_sub, job_raw_7C7_roll2_sub)\n\njob_raw_7C7_total_1 <- job_raw_7C7_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C7_total <- left_join(job_raw_7C7_total, job_raw_7C7_total_1)\n\njob_raw_7C7_total_2 <- job_raw_7C7_total %>% filter(h12 != 0)\n#####\njob_raw_7C8_roll1_sub <- job_raw_7C8_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\njob_raw_7C8_roll2_sub <- job_raw_7C8_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(job_raw_7C8_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\njob_raw_7C8_total <- rbind(job_raw_7C8_roll1_sub, job_raw_7C8_roll2_sub)\n\njob_raw_7C8_total_1 <- job_raw_7C8_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C8_total <- left_join(job_raw_7C8_total, job_raw_7C8_total_1)\n\njob_raw_7C8_total_2 <- job_raw_7C8_total %>% filter(h12 != 0)\n#####\njob_raw_7C9_roll1_sub <- job_raw_7C9_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\njob_raw_7C9_roll2_sub <- job_raw_7C9_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(job_raw_7C9_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\njob_raw_7C9_total <- rbind(job_raw_7C9_roll1_sub, job_raw_7C9_roll2_sub)\n\njob_raw_7C9_total_1 <- job_raw_7C9_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C9_total <- left_join(job_raw_7C9_total, job_raw_7C9_total_1)\n\njob_raw_7C9_total_2 <- job_raw_7C9_total %>% filter(h12 != 0)\n#####\njob_raw_7C10_roll1_sub <- job_raw_7C10_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\njob_raw_7C10_roll2_sub <- job_raw_7C10_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(job_raw_7C10_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\njob_raw_7C10_total <- rbind(job_raw_7C10_roll1_sub, job_raw_7C10_roll2_sub)\n\njob_raw_7C10_total_1 <- job_raw_7C10_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C10_total <- left_join(job_raw_7C10_total, job_raw_7C10_total_1)\n\njob_raw_7C10_total_2 <- job_raw_7C10_total %>% filter(h12 != 0)\n#####\njob_raw_7C11_roll1_sub <- job_raw_7C11_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\njob_raw_7C11_roll2_sub <- job_raw_7C11_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(job_raw_7C11_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\njob_raw_7C11_total <- rbind(job_raw_7C11_roll1_sub, job_raw_7C11_roll2_sub)\n\njob_raw_7C11_total_1 <- job_raw_7C11_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C11_total <- left_join(job_raw_7C11_total, job_raw_7C11_total_1)\n\njob_raw_7C11_total_2 <- job_raw_7C11_total %>% filter(h12 != 0)\n#####\njob_raw_7C12_roll1_sub <- job_raw_7C12_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\njob_raw_7C12_roll2_sub <- job_raw_7C12_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(job_raw_7C12_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\njob_raw_7C12_total <- rbind(job_raw_7C12_roll1_sub, job_raw_7C12_roll2_sub)\n\njob_raw_7C12_total_1 <- job_raw_7C12_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C12_total <- left_join(job_raw_7C12_total, job_raw_7C12_total_1)\n\njob_raw_7C12_total_2 <- job_raw_7C12_total %>% filter(h12 != 0)\n#####\njob_raw_7C13_roll1_sub <- job_raw_7C13_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup_total)\njob_raw_7C13_roll2_sub <- job_raw_7C13_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc,  rollup24_36)\ncolnames(job_raw_7C13_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\", \"rollup_total\") \n\njob_raw_7C13_total <- rbind(job_raw_7C13_roll1_sub, job_raw_7C13_roll2_sub)\n\njob_raw_7C13_total_1 <- job_raw_7C13_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\njob_raw_7C13_total <- left_join(job_raw_7C13_total, job_raw_7C13_total_1)\n\njob_raw_7C13_total_2 <- job_raw_7C13_total %>% filter(h12 != 0)\n\n###### rate 0~10%\n\nlength((area_raw_115000_total_3 %>% filter(rate==0))$rec_idx)\n\n\n\n\n##### ~ 12/4 ??????\n\njob_raw_7C1_total_3 <- job_raw_7C1_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\njob_raw_7C2_total_3 <- job_raw_7C2_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\njob_raw_7C3_total_3 <- job_raw_7C3_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\njob_raw_7C4_total_3 <- job_raw_7C4_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\njob_raw_7C5_total_3 <- job_raw_7C5_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\njob_raw_7C6_total_3 <- job_raw_7C6_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\njob_raw_7C7_total_3 <- job_raw_7C7_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\njob_raw_7C8_total_3 <- job_raw_7C8_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\njob_raw_7C9_total_3 <- job_raw_7C9_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\njob_raw_7C10_total_3 <- job_raw_7C10_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\njob_raw_7C11_total_3 <- job_raw_7C11_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\njob_raw_7C12_total_3 <- job_raw_7C12_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\njob_raw_7C13_total_3 <- job_raw_7C13_total_2 %>% filter(opening_dt_new <= '2014-12-04' )\n\n##### ?? ?????? Á¶È¸?? ??????À²(rate) ??????\nhist(job_raw_7C1_total_3$rate, xlim=c(0,400), breaks=800, freq = T)\nhist(job_raw_7C2_total_3$rate, xlim=c(0,400), breaks=200, freq = T)\nhist(job_raw_7C3_total_3$rate, xlim=c(0,400), breaks=400, freq = T)\nhist(job_raw_7C4_total_3$rate, xlim=c(0,400), breaks=400, freq = T)\nhist(job_raw_7C5_total_3$rate, xlim=c(0,400), breaks=200, freq = T)\nhist(job_raw_7C6_total_3$rate, xlim=c(0,400), breaks=400, freq = T)\nhist(job_raw_7C7_total_3$rate, xlim=c(0,400), breaks=400, freq = T)\nhist(job_raw_7C8_total_3$rate, xlim=c(0,400), breaks=200, freq = T)\nhist(job_raw_7C9_total_3$rate, xlim=c(0,400), breaks=400, freq = T)\nhist(job_raw_7C10_total_3$rate, xlim=c(0,400), breaks=800, freq = T)\nhist(job_raw_7C11_total_3$rate, xlim=c(0,400), breaks=400, freq = T)\nhist(job_raw_7C12_total_3$rate, xlim=c(0,400), breaks=400, freq = T)\nhist(job_raw_7C13_total_3$rate, xlim=c(0,400), breaks=400, freq = T)\npng()\ndev.off()\n##############################################################################################################################\n#                                                                                                                            #\n#                                    ?Ñ¾? È¿???? È®???Ï±? À§?? ???????è·® ???? (roll1 + roll2)                               #\n#                                                                                                                            #\n#         1. ????, Ç¥?????? (rate, h12, rollup_total, etc)                                                                   #\n#                                                                                                                            #\n##############################################################################################################################\n\narea_raw_101000_total_2$all_diff <- area_raw_101000_total_2$closing_dt_new - area_raw_101000_total_2$opening_dt_new \narea_raw_101000_total_2$etc_2 <- area_raw_101000_total_2$etc/((floor(as.numeric(area_raw_101000_total_2$all_diff/86400))-1)*2)\narea_raw_101000_total_2[area_raw_101000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_101000_total_2[area_raw_101000_total_2$etc_2==\"Inf\",]$etc\narea_raw_101000_total_2$etc_2 <- as.numeric(area_raw_101000_total_2$etc_2)\narea_raw_101000_total_2[is.na(area_raw_101000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_101000_total_2$etc <- area_raw_101000_total_2$etc_2 \n\narea_raw_102000_total_2$all_diff <- area_raw_102000_total_2$closing_dt_new - area_raw_102000_total_2$opening_dt_new \narea_raw_102000_total_2$etc_2 <- area_raw_102000_total_2$etc/((floor(as.numeric(area_raw_102000_total_2$all_diff/86400))-1)*2)\narea_raw_102000_total_2[area_raw_102000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_102000_total_2[area_raw_102000_total_2$etc_2==\"Inf\",]$etc\narea_raw_102000_total_2$etc_2 <- as.numeric(area_raw_102000_total_2$etc_2)\narea_raw_102000_total_2[is.na(area_raw_102000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_102000_total_2$etc <- area_raw_102000_total_2$etc_2 \n\narea_raw_103000_total_2$all_diff <- area_raw_103000_total_2$closing_dt_new - area_raw_103000_total_2$opening_dt_new \narea_raw_103000_total_2$etc_2 <- area_raw_103000_total_2$etc/((floor(as.numeric(area_raw_103000_total_2$all_diff/86400))-1)*2)\narea_raw_103000_total_2[area_raw_103000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_103000_total_2[area_raw_103000_total_2$etc_2==\"Inf\",]$etc\narea_raw_103000_total_2$etc_2 <- as.numeric(area_raw_103000_total_2$etc_2)\narea_raw_103000_total_2[is.na(area_raw_103000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_103000_total_2$etc <- area_raw_103000_total_2$etc_2 \n\narea_raw_104000_total_2$all_diff <- area_raw_104000_total_2$closing_dt_new - area_raw_104000_total_2$opening_dt_new \narea_raw_104000_total_2$etc_2 <- area_raw_104000_total_2$etc/((floor(as.numeric(area_raw_104000_total_2$all_diff/86400))-1)*2)\narea_raw_104000_total_2[area_raw_104000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_104000_total_2[area_raw_104000_total_2$etc_2==\"Inf\",]$etc\narea_raw_104000_total_2$etc_2 <- as.numeric(area_raw_104000_total_2$etc_2)\narea_raw_104000_total_2[is.na(area_raw_104000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_104000_total_2$etc <- area_raw_104000_total_2$etc_2 \n\narea_raw_105000_total_2$all_diff <- area_raw_105000_total_2$closing_dt_new - area_raw_105000_total_2$opening_dt_new \narea_raw_105000_total_2$etc_2 <- area_raw_105000_total_2$etc/((floor(as.numeric(area_raw_105000_total_2$all_diff/86400))-1)*2)\narea_raw_105000_total_2[area_raw_105000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_105000_total_2[area_raw_105000_total_2$etc_2==\"Inf\",]$etc\narea_raw_105000_total_2$etc_2 <- as.numeric(area_raw_105000_total_2$etc_2)\narea_raw_105000_total_2[is.na(area_raw_105000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_105000_total_2$etc <- area_raw_105000_total_2$etc_2 \n\narea_raw_106000_total_2$all_diff <- area_raw_106000_total_2$closing_dt_new - area_raw_106000_total_2$opening_dt_new \narea_raw_106000_total_2$etc_2 <- area_raw_106000_total_2$etc/((floor(as.numeric(area_raw_106000_total_2$all_diff/86400))-1)*2)\narea_raw_106000_total_2[area_raw_106000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_106000_total_2[area_raw_106000_total_2$etc_2==\"Inf\",]$etc\narea_raw_106000_total_2$etc_2 <- as.numeric(area_raw_106000_total_2$etc_2)\narea_raw_106000_total_2[is.na(area_raw_106000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_106000_total_2$etc <- area_raw_106000_total_2$etc_2 \n\narea_raw_107000_total_2$all_diff <- area_raw_107000_total_2$closing_dt_new - area_raw_107000_total_2$opening_dt_new \narea_raw_107000_total_2$etc_2 <- area_raw_107000_total_2$etc/((floor(as.numeric(area_raw_107000_total_2$all_diff/86400))-1)*2)\narea_raw_107000_total_2[area_raw_107000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_107000_total_2[area_raw_107000_total_2$etc_2==\"Inf\",]$etc\narea_raw_107000_total_2$etc_2 <- as.numeric(area_raw_107000_total_2$etc_2)\narea_raw_107000_total_2[is.na(area_raw_107000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_107000_total_2$etc <- area_raw_107000_total_2$etc_2 \n\narea_raw_108000_total_2$all_diff <- area_raw_108000_total_2$closing_dt_new - area_raw_108000_total_2$opening_dt_new \narea_raw_108000_total_2$etc_2 <- area_raw_108000_total_2$etc/((floor(as.numeric(area_raw_108000_total_2$all_diff/86400))-1)*2)\narea_raw_108000_total_2[area_raw_108000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_108000_total_2[area_raw_108000_total_2$etc_2==\"Inf\",]$etc\narea_raw_108000_total_2$etc_2 <- as.numeric(area_raw_108000_total_2$etc_2)\narea_raw_108000_total_2[is.na(area_raw_108000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_108000_total_2$etc <- area_raw_108000_total_2$etc_2 \n\narea_raw_109000_total_2$all_diff <- area_raw_109000_total_2$closing_dt_new - area_raw_109000_total_2$opening_dt_new \narea_raw_109000_total_2$etc_2 <- area_raw_109000_total_2$etc/((floor(as.numeric(area_raw_109000_total_2$all_diff/86400))-1)*2)\narea_raw_109000_total_2[area_raw_109000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_109000_total_2[area_raw_109000_total_2$etc_2==\"Inf\",]$etc\narea_raw_109000_total_2$etc_2 <- as.numeric(area_raw_109000_total_2$etc_2)\narea_raw_109000_total_2[is.na(area_raw_109000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_109000_total_2$etc <- area_raw_109000_total_2$etc_2 \n\narea_raw_110000_total_2$all_diff <- area_raw_110000_total_2$closing_dt_new - area_raw_110000_total_2$opening_dt_new \narea_raw_110000_total_2$etc_2 <- area_raw_110000_total_2$etc/((floor(as.numeric(area_raw_110000_total_2$all_diff/86400))-1)*2)\narea_raw_110000_total_2[area_raw_110000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_110000_total_2[area_raw_110000_total_2$etc_2==\"Inf\",]$etc\narea_raw_110000_total_2$etc_2 <- as.numeric(area_raw_110000_total_2$etc_2)\narea_raw_110000_total_2[is.na(area_raw_110000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_110000_total_2$etc <- area_raw_110000_total_2$etc_2 \n\narea_raw_111000_total_2$all_diff <- area_raw_111000_total_2$closing_dt_new - area_raw_111000_total_2$opening_dt_new \narea_raw_111000_total_2$etc_2 <- area_raw_111000_total_2$etc/((floor(as.numeric(area_raw_111000_total_2$all_diff/86400))-1)*2)\narea_raw_111000_total_2[area_raw_111000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_111000_total_2[area_raw_111000_total_2$etc_2==\"Inf\",]$etc\narea_raw_111000_total_2$etc_2 <- as.numeric(area_raw_111000_total_2$etc_2)\narea_raw_111000_total_2[is.na(area_raw_111000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_111000_total_2$etc <- area_raw_111000_total_2$etc_2 \n\narea_raw_112000_total_2$all_diff <- area_raw_112000_total_2$closing_dt_new - area_raw_112000_total_2$opening_dt_new \narea_raw_112000_total_2$etc_2 <- area_raw_112000_total_2$etc/((floor(as.numeric(area_raw_112000_total_2$all_diff/86400))-1)*2)\narea_raw_112000_total_2[area_raw_112000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_112000_total_2[area_raw_112000_total_2$etc_2==\"Inf\",]$etc\narea_raw_112000_total_2$etc_2 <- as.numeric(area_raw_112000_total_2$etc_2)\narea_raw_112000_total_2[is.na(area_raw_112000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_112000_total_2$etc <- area_raw_112000_total_2$etc_2 \n\narea_raw_113000_total_2$all_diff <- area_raw_113000_total_2$closing_dt_new - area_raw_113000_total_2$opening_dt_new \narea_raw_113000_total_2$etc_2 <- area_raw_113000_total_2$etc/((floor(as.numeric(area_raw_113000_total_2$all_diff/86400))-1)*2)\narea_raw_113000_total_2[area_raw_113000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_113000_total_2[area_raw_113000_total_2$etc_2==\"Inf\",]$etc\narea_raw_113000_total_2$etc_2 <- as.numeric(area_raw_113000_total_2$etc_2)\narea_raw_113000_total_2[is.na(area_raw_113000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_113000_total_2$etc <- area_raw_113000_total_2$etc_2 \n\narea_raw_114000_total_2$all_diff <- area_raw_114000_total_2$closing_dt_new - area_raw_114000_total_2$opening_dt_new \narea_raw_114000_total_2$etc_2 <- area_raw_114000_total_2$etc/((floor(as.numeric(area_raw_114000_total_2$all_diff/86400))-1)*2)\narea_raw_114000_total_2[area_raw_114000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_114000_total_2[area_raw_114000_total_2$etc_2==\"Inf\",]$etc\narea_raw_114000_total_2$etc_2 <- as.numeric(area_raw_114000_total_2$etc_2)\narea_raw_114000_total_2[is.na(area_raw_114000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_114000_total_2$etc <- area_raw_114000_total_2$etc_2 \n\narea_raw_115000_total_2$all_diff <- area_raw_115000_total_2$closing_dt_new - area_raw_115000_total_2$opening_dt_new \narea_raw_115000_total_2$etc_2 <- area_raw_115000_total_2$etc/((floor(as.numeric(area_raw_115000_total_2$all_diff/86400))-1)*2)\narea_raw_115000_total_2[area_raw_115000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_115000_total_2[area_raw_115000_total_2$etc_2==\"Inf\",]$etc\narea_raw_115000_total_2$etc_2 <- as.numeric(area_raw_115000_total_2$etc_2)\narea_raw_115000_total_2[is.na(area_raw_115000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_115000_total_2$etc <- area_raw_115000_total_2$etc_2 \n\narea_raw_116000_total_2$all_diff <- area_raw_116000_total_2$closing_dt_new - area_raw_116000_total_2$opening_dt_new \narea_raw_116000_total_2$etc_2 <- area_raw_116000_total_2$etc/((floor(as.numeric(area_raw_116000_total_2$all_diff/86400))-1)*2)\narea_raw_116000_total_2[area_raw_116000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_116000_total_2[area_raw_116000_total_2$etc_2==\"Inf\",]$etc\narea_raw_116000_total_2$etc_2 <- as.numeric(area_raw_116000_total_2$etc_2)\narea_raw_116000_total_2[is.na(area_raw_116000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_116000_total_2$etc <- area_raw_116000_total_2$etc_2 \n\narea_raw_117000_total_2$all_diff <- area_raw_117000_total_2$closing_dt_new - area_raw_117000_total_2$opening_dt_new \narea_raw_117000_total_2$etc_2 <- area_raw_117000_total_2$etc/((floor(as.numeric(area_raw_117000_total_2$all_diff/86400))-1)*2)\narea_raw_117000_total_2[area_raw_117000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_117000_total_2[area_raw_117000_total_2$etc_2==\"Inf\",]$etc\narea_raw_117000_total_2$etc_2 <- as.numeric(area_raw_117000_total_2$etc_2)\narea_raw_117000_total_2[is.na(area_raw_117000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_117000_total_2$etc <- area_raw_117000_total_2$etc_2 \n\narea_raw_118000_total_2$all_diff <- area_raw_118000_total_2$closing_dt_new - area_raw_118000_total_2$opening_dt_new \narea_raw_118000_total_2$etc_2 <- area_raw_118000_total_2$etc/((floor(as.numeric(area_raw_118000_total_2$all_diff/86400))-1)*2)\narea_raw_118000_total_2[area_raw_118000_total_2$etc_2==\"Inf\",]$etc_2 <- area_raw_118000_total_2[area_raw_118000_total_2$etc_2==\"Inf\",]$etc\narea_raw_118000_total_2$etc_2 <- as.numeric(area_raw_118000_total_2$etc_2)\narea_raw_118000_total_2[is.na(area_raw_118000_total_2$etc_2)==T,]$etc_2 <- c(0)\narea_raw_118000_total_2$etc <- area_raw_118000_total_2$etc_2 \n\n\n######\narea_raw_101000_total_2$rate[is.nan(area_raw_101000_total_2$rate) | is.infinite(area_raw_101000_total_2$rate)] <- 0\narea_raw_total <-area_raw_101000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=101000)\narea_raw_total$rec_idx_count<-length(unique(area_raw_101000_total_2$rec_idx))\n###\narea_raw_102000_total_2$rate[is.nan(area_raw_102000_total_2$rate) | is.infinite(area_raw_102000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_102000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=102000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_102000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_103000_total_2$rate[is.nan(area_raw_103000_total_2$rate) | is.infinite(area_raw_103000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_103000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=103000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_103000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_104000_total_2$rate[is.nan(area_raw_104000_total_2$rate) | is.infinite(area_raw_104000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_104000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=104000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_104000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_105000_total_2$rate[is.nan(area_raw_105000_total_2$rate) | is.infinite(area_raw_105000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_105000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=105000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_105000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_106000_total_2$rate[is.nan(area_raw_106000_total_2$rate) | is.infinite(area_raw_106000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_106000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=106000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_106000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_107000_total_2$rate[is.nan(area_raw_107000_total_2$rate) | is.infinite(area_raw_107000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_107000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=107000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_107000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_108000_total_2$rate[is.nan(area_raw_108000_total_2$rate) | is.infinite(area_raw_108000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_108000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=108000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_108000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_109000_total_2$rate[is.nan(area_raw_109000_total_2$rate) | is.infinite(area_raw_109000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_109000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=109000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_109000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_110000_total_2$rate[is.nan(area_raw_110000_total_2$rate) | is.infinite(area_raw_110000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_110000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=110000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_110000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_111000_total_2$rate[is.nan(area_raw_111000_total_2$rate) | is.infinite(area_raw_111000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_111000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=111000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_111000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_112000_total_2$rate[is.nan(area_raw_112000_total_2$rate) | is.infinite(area_raw_112000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_112000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=112000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_112000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_113000_total_2$rate[is.nan(area_raw_113000_total_2$rate) | is.infinite(area_raw_113000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_113000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=113000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_113000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_114000_total_2$rate[is.nan(area_raw_114000_total_2$rate) | is.infinite(area_raw_114000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_114000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=114000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_114000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_115000_total_2$rate[is.nan(area_raw_115000_total_2$rate) | is.infinite(area_raw_115000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_115000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=115000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_115000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_116000_total_2$rate[is.nan(area_raw_116000_total_2$rate) | is.infinite(area_raw_116000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_116000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=116000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_116000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_117000_total_2$rate[is.nan(area_raw_117000_total_2$rate) | is.infinite(area_raw_117000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_117000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=117000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_117000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\narea_raw_118000_total_2$rate[is.nan(area_raw_118000_total_2$rate) | is.infinite(area_raw_118000_total_2$rate)] <- 0\narea_raw_total_sub <-area_raw_118000_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=118000)\narea_raw_total_sub$rec_idx_count<-length(unique(area_raw_118000_total_2$rec_idx))\narea_raw_total <- rbind(area_raw_total, area_raw_total_sub)\n###\nwrite.csv(area_raw_total, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/???? ?Ð¼? ??????/area_raw_total.csv\") \n\n###########################\n\njob_raw_7C1_total_2$all_diff <- job_raw_7C1_total_2$closing_dt_new - job_raw_7C1_total_2$opening_dt_new \njob_raw_7C1_total_2$etc_2 <- job_raw_7C1_total_2$etc/((floor(as.numeric(job_raw_7C1_total_2$all_diff/86400))-1)*2)\njob_raw_7C1_total_2[job_raw_7C1_total_2$etc_2==\"Inf\",]$etc_2 <- job_raw_7C1_total_2[job_raw_7C1_total_2$etc_2==\"Inf\",]$etc\njob_raw_7C1_total_2$etc_2 <- as.numeric(job_raw_7C1_total_2$etc_2)\njob_raw_7C1_total_2[is.na(job_raw_7C1_total_2$etc_2)==T,]$etc_2 <- c(0)\njob_raw_7C1_total_2$etc <- job_raw_7C1_total_2$etc_2 \n\njob_raw_7C2_total_2$all_diff <- job_raw_7C2_total_2$closing_dt_new - job_raw_7C2_total_2$opening_dt_new \njob_raw_7C2_total_2$etc_2 <- job_raw_7C2_total_2$etc/((floor(as.numeric(job_raw_7C2_total_2$all_diff/86400))-1)*2)\njob_raw_7C2_total_2[job_raw_7C2_total_2$etc_2==\"Inf\",]$etc_2 <- job_raw_7C2_total_2[job_raw_7C2_total_2$etc_2==\"Inf\",]$etc\njob_raw_7C2_total_2$etc_2 <- as.numeric(job_raw_7C2_total_2$etc_2)\njob_raw_7C2_total_2[is.na(job_raw_7C2_total_2$etc_2)==T,]$etc_2 <- c(0)\njob_raw_7C2_total_2$etc <- job_raw_7C2_total_2$etc_2 \n\njob_raw_7C3_total_2$all_diff <- job_raw_7C3_total_2$closing_dt_new - job_raw_7C3_total_2$opening_dt_new \njob_raw_7C3_total_2$etc_2 <- job_raw_7C3_total_2$etc/((floor(as.numeric(job_raw_7C3_total_2$all_diff/86400))-1)*2)\njob_raw_7C3_total_2[job_raw_7C3_total_2$etc_2==\"Inf\",]$etc_2 <- job_raw_7C3_total_2[job_raw_7C3_total_2$etc_2==\"Inf\",]$etc\njob_raw_7C3_total_2$etc_2 <- as.numeric(job_raw_7C3_total_2$etc_2)\njob_raw_7C3_total_2[is.na(job_raw_7C3_total_2$etc_2)==T,]$etc_2 <- c(0)\njob_raw_7C3_total_2$etc <- job_raw_7C3_total_2$etc_2 \n\njob_raw_7C4_total_2$all_diff <- job_raw_7C4_total_2$closing_dt_new - job_raw_7C4_total_2$opening_dt_new \njob_raw_7C4_total_2$etc_2 <- job_raw_7C4_total_2$etc/((floor(as.numeric(job_raw_7C4_total_2$all_diff/86400))-1)*2)\njob_raw_7C4_total_2[job_raw_7C4_total_2$etc_2==\"Inf\",]$etc_2 <- job_raw_7C4_total_2[job_raw_7C4_total_2$etc_2==\"Inf\",]$etc\njob_raw_7C4_total_2$etc_2 <- as.numeric(job_raw_7C4_total_2$etc_2)\njob_raw_7C4_total_2[is.na(job_raw_7C4_total_2$etc_2)==T,]$etc_2 <- c(0)\njob_raw_7C4_total_2$etc <- job_raw_7C4_total_2$etc_2 \n\njob_raw_7C5_total_2$all_diff <- job_raw_7C5_total_2$closing_dt_new - job_raw_7C5_total_2$opening_dt_new \njob_raw_7C5_total_2$etc_2 <- job_raw_7C5_total_2$etc/((floor(as.numeric(job_raw_7C5_total_2$all_diff/86400))-1)*2)\njob_raw_7C5_total_2[job_raw_7C5_total_2$etc_2==\"Inf\",]$etc_2 <- job_raw_7C5_total_2[job_raw_7C5_total_2$etc_2==\"Inf\",]$etc\njob_raw_7C5_total_2$etc_2 <- as.numeric(job_raw_7C5_total_2$etc_2)\njob_raw_7C5_total_2[is.na(job_raw_7C5_total_2$etc_2)==T,]$etc_2 <- c(0)\njob_raw_7C5_total_2$etc <- job_raw_7C5_total_2$etc_2 \n\njob_raw_7C6_total_2$all_diff <- job_raw_7C6_total_2$closing_dt_new - job_raw_7C6_total_2$opening_dt_new \njob_raw_7C6_total_2$etc_2 <- job_raw_7C6_total_2$etc/((floor(as.numeric(job_raw_7C6_total_2$all_diff/86400))-1)*2)\njob_raw_7C6_total_2[job_raw_7C6_total_2$etc_2==\"Inf\",]$etc_2 <- job_raw_7C6_total_2[job_raw_7C6_total_2$etc_2==\"Inf\",]$etc\njob_raw_7C6_total_2$etc_2 <- as.numeric(job_raw_7C6_total_2$etc_2)\njob_raw_7C6_total_2[is.na(job_raw_7C6_total_2$etc_2)==T,]$etc_2 <- c(0)\njob_raw_7C6_total_2$etc <- job_raw_7C6_total_2$etc_2 \n\njob_raw_7C7_total_2$all_diff <- job_raw_7C7_total_2$closing_dt_new - job_raw_7C7_total_2$opening_dt_new \njob_raw_7C7_total_2$etc_2 <- job_raw_7C7_total_2$etc/((floor(as.numeric(job_raw_7C7_total_2$all_diff/86400))-1)*2)\njob_raw_7C7_total_2[job_raw_7C7_total_2$etc_2==\"Inf\",]$etc_2 <- job_raw_7C7_total_2[job_raw_7C7_total_2$etc_2==\"Inf\",]$etc\njob_raw_7C7_total_2$etc_2 <- as.numeric(job_raw_7C7_total_2$etc_2)\njob_raw_7C7_total_2[is.na(job_raw_7C7_total_2$etc_2)==T,]$etc_2 <- c(0)\njob_raw_7C7_total_2$etc <- job_raw_7C7_total_2$etc_2 \n\njob_raw_7C8_total_2$all_diff <- job_raw_7C8_total_2$closing_dt_new - job_raw_7C8_total_2$opening_dt_new \njob_raw_7C8_total_2$etc_2 <- job_raw_7C8_total_2$etc/((floor(as.numeric(job_raw_7C8_total_2$all_diff/86400))-1)*2)\njob_raw_7C8_total_2[job_raw_7C8_total_2$etc_2==\"Inf\",]$etc_2 <- job_raw_7C8_total_2[job_raw_7C8_total_2$etc_2==\"Inf\",]$etc\njob_raw_7C8_total_2$etc_2 <- as.numeric(job_raw_7C8_total_2$etc_2)\njob_raw_7C8_total_2[is.na(job_raw_7C8_total_2$etc_2)==T,]$etc_2 <- c(0)\njob_raw_7C8_total_2$etc <- job_raw_7C8_total_2$etc_2 \n\njob_raw_7C9_total_2$all_diff <- job_raw_7C9_total_2$closing_dt_new - job_raw_7C9_total_2$opening_dt_new \njob_raw_7C9_total_2$etc_2 <- job_raw_7C9_total_2$etc/((floor(as.numeric(job_raw_7C9_total_2$all_diff/86400))-1)*2)\njob_raw_7C9_total_2[job_raw_7C9_total_2$etc_2==\"Inf\",]$etc_2 <- job_raw_7C9_total_2[job_raw_7C9_total_2$etc_2==\"Inf\",]$etc\njob_raw_7C9_total_2$etc_2 <- as.numeric(job_raw_7C9_total_2$etc_2)\njob_raw_7C9_total_2[is.na(job_raw_7C9_total_2$etc_2)==T,]$etc_2 <- c(0)\njob_raw_7C9_total_2$etc <- job_raw_7C9_total_2$etc_2 \n\njob_raw_7C10_total_2$all_diff <- job_raw_7C10_total_2$closing_dt_new - job_raw_7C10_total_2$opening_dt_new \njob_raw_7C10_total_2$etc_2 <- job_raw_7C10_total_2$etc/((floor(as.numeric(job_raw_7C10_total_2$all_diff/86400))-1)*2)\njob_raw_7C10_total_2[job_raw_7C10_total_2$etc_2==\"Inf\",]$etc_2 <- job_raw_7C10_total_2[job_raw_7C10_total_2$etc_2==\"Inf\",]$etc\njob_raw_7C10_total_2$etc_2 <- as.numeric(job_raw_7C10_total_2$etc_2)\njob_raw_7C10_total_2[is.na(job_raw_7C10_total_2$etc_2)==T,]$etc_2 <- c(0)\njob_raw_7C10_total_2$etc <- job_raw_7C10_total_2$etc_2 \n\njob_raw_7C11_total_2$all_diff <- job_raw_7C11_total_2$closing_dt_new - job_raw_7C11_total_2$opening_dt_new \njob_raw_7C11_total_2$etc_2 <- job_raw_7C11_total_2$etc/((floor(as.numeric(job_raw_7C11_total_2$all_diff/86400))-1)*2)\njob_raw_7C11_total_2[job_raw_7C11_total_2$etc_2==\"Inf\",]$etc_2 <- job_raw_7C11_total_2[job_raw_7C11_total_2$etc_2==\"Inf\",]$etc\njob_raw_7C11_total_2$etc_2 <- as.numeric(job_raw_7C11_total_2$etc_2)\njob_raw_7C11_total_2[is.na(job_raw_7C11_total_2$etc_2)==T,]$etc_2 <- c(0)\njob_raw_7C11_total_2$etc <- job_raw_7C11_total_2$etc_2 \n\njob_raw_7C12_total_2$all_diff <- job_raw_7C12_total_2$closing_dt_new - job_raw_7C12_total_2$opening_dt_new \njob_raw_7C12_total_2$etc_2 <- job_raw_7C12_total_2$etc/((floor(as.numeric(job_raw_7C12_total_2$all_diff/86400))-1)*2)\njob_raw_7C12_total_2[job_raw_7C12_total_2$etc_2==\"Inf\",]$etc_2 <- job_raw_7C12_total_2[job_raw_7C12_total_2$etc_2==\"Inf\",]$etc\njob_raw_7C12_total_2$etc_2 <- as.numeric(job_raw_7C12_total_2$etc_2)\njob_raw_7C12_total_2[is.na(job_raw_7C12_total_2$etc_2)==T,]$etc_2 <- c(0)\njob_raw_7C12_total_2$etc <- job_raw_7C12_total_2$etc_2 \n\njob_raw_7C13_total_2$all_diff <- job_raw_7C13_total_2$closing_dt_new - job_raw_7C13_total_2$opening_dt_new \njob_raw_7C13_total_2$etc_2 <- job_raw_7C13_total_2$etc/((floor(as.numeric(job_raw_7C13_total_2$all_diff/86400))-1)*2)\njob_raw_7C13_total_2[job_raw_7C13_total_2$etc_2==\"Inf\",]$etc_2 <- job_raw_7C13_total_2[job_raw_7C13_total_2$etc_2==\"Inf\",]$etc\njob_raw_7C13_total_2$etc_2 <- as.numeric(job_raw_7C13_total_2$etc_2)\njob_raw_7C13_total_2[is.na(job_raw_7C13_total_2$etc_2)==T,]$etc_2 <- c(0)\njob_raw_7C13_total_2$etc <- job_raw_7C13_total_2$etc_2 \n\n\n\n\njob_raw_7C1_total_2$rate[is.nan(job_raw_7C1_total_2$rate) | is.infinite(job_raw_7C1_total_2$rate)] <- 0\njob_raw_total <-job_raw_7C1_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region='7C1')\njob_raw_total$rec_idx_count<-length(unique(job_raw_7C1_total_2$rec_idx))\n###\njob_raw_7C2_total_2$rate[is.nan(job_raw_7C2_total_2$rate) | is.infinite(job_raw_7C2_total_2$rate)] <- 0\njob_raw_total_sub <-job_raw_7C2_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region='7C2')\njob_raw_total_sub$rec_idx_count<-length(unique(job_raw_7C2_total_2$rec_idx))\njob_raw_total <- rbind(job_raw_total, job_raw_total_sub)\n###\njob_raw_7C3_total_2$rate[is.nan(job_raw_7C3_total_2$rate) | is.infinite(job_raw_7C3_total_2$rate)] <- 0\njob_raw_total_sub <-job_raw_7C3_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region='7C3')\njob_raw_total_sub$rec_idx_count<-length(unique(job_raw_7C3_total_2$rec_idx))\njob_raw_total <- rbind(job_raw_total, job_raw_total_sub)\n###\njob_raw_7C4_total_2$rate[is.nan(job_raw_7C4_total_2$rate) | is.infinite(job_raw_7C4_total_2$rate)] <- 0\njob_raw_total_sub <-job_raw_7C4_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region='7C4')\njob_raw_total_sub$rec_idx_count<-length(unique(job_raw_7C4_total_2$rec_idx))\njob_raw_total <- rbind(job_raw_total, job_raw_total_sub)\n###\njob_raw_7C5_total_2$rate[is.nan(job_raw_7C5_total_2$rate) | is.infinite(job_raw_7C5_total_2$rate)] <- 0\njob_raw_total_sub <-job_raw_7C5_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region='7C5')\njob_raw_total_sub$rec_idx_count<-length(unique(job_raw_7C5_total_2$rec_idx))\njob_raw_total <- rbind(job_raw_total, job_raw_total_sub)\n###\njob_raw_7C6_total_2$rate[is.nan(job_raw_7C6_total_2$rate) | is.infinite(job_raw_7C6_total_2$rate)] <- 0\njob_raw_total_sub <-job_raw_7C6_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region='7C6')\njob_raw_total_sub$rec_idx_count<-length(unique(job_raw_7C6_total_2$rec_idx))\njob_raw_total <- rbind(job_raw_total, job_raw_total_sub)\n###\njob_raw_7C7_total_2$rate[is.nan(job_raw_7C7_total_2$rate) | is.infinite(job_raw_7C7_total_2$rate)] <- 0\njob_raw_total_sub <-job_raw_7C7_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region='7C7')\njob_raw_total_sub$rec_idx_count<-length(unique(job_raw_7C7_total_2$rec_idx))\njob_raw_total <- rbind(job_raw_total, job_raw_total_sub)\n###\njob_raw_7C8_total_2$rate[is.nan(job_raw_7C8_total_2$rate) | is.infinite(job_raw_7C8_total_2$rate)] <- 0\njob_raw_total_sub <-job_raw_7C8_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region='7C8')\njob_raw_total_sub$rec_idx_count<-length(unique(job_raw_7C8_total_2$rec_idx))\njob_raw_total <- rbind(job_raw_total, job_raw_total_sub)\n###\njob_raw_7C9_total_2$rate[is.nan(job_raw_7C9_total_2$rate) | is.infinite(job_raw_7C9_total_2$rate)] <- 0\njob_raw_total_sub <-job_raw_7C9_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region='7C9')\njob_raw_total_sub$rec_idx_count<-length(unique(job_raw_7C9_total_2$rec_idx))\njob_raw_total <- rbind(job_raw_total, job_raw_total_sub)\n###\njob_raw_7C10_total_2$rate[is.nan(job_raw_7C10_total_2$rate) | is.infinite(job_raw_7C10_total_2$rate)] <- 0\njob_raw_total_sub <-job_raw_7C10_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region='7C10')\njob_raw_total_sub$rec_idx_count<-length(unique(job_raw_7C10_total_2$rec_idx))\njob_raw_total <- rbind(job_raw_total, job_raw_total_sub)\n###\njob_raw_7C11_total_2$rate[is.nan(job_raw_7C11_total_2$rate) | is.infinite(job_raw_7C11_total_2$rate)] <- 0\njob_raw_total_sub <-job_raw_7C11_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region='7C11')\njob_raw_total_sub$rec_idx_count<-length(unique(job_raw_7C11_total_2$rec_idx))\njob_raw_total <- rbind(job_raw_total, job_raw_total_sub)\n###\njob_raw_7C12_total_2$rate[is.nan(job_raw_7C12_total_2$rate) | is.infinite(job_raw_7C12_total_2$rate)] <- 0\njob_raw_total_sub <-job_raw_7C12_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region='7C12')\njob_raw_total_sub$rec_idx_count<-length(unique(job_raw_7C12_total_2$rec_idx))\njob_raw_total <- rbind(job_raw_total, job_raw_total_sub)\n###\njob_raw_7C13_total_2$rate[is.nan(job_raw_7C13_total_2$rate) | is.infinite(job_raw_7C13_total_2$rate)] <- 0\njob_raw_total_sub <-job_raw_7C13_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region='7C13')\njob_raw_total_sub$rec_idx_count<-length(unique(job_raw_7C13_total_2$rec_idx))\njob_raw_total <- rbind(job_raw_total, job_raw_total_sub)\n###\nwrite.csv(job_raw_total, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/???? ?Ð¼? ??????/job_raw_total.csv\") \n\n\n########## ??Ã¼\n\n\n\ntotal<-rbind(area_raw, job_raw)\ntotal_sub<-rbind(area_recruit_sub, job_recruit_sub)\n\nwrite.csv(total, file=\"C:/Users/user/Desktop/total.csv\")\nwrite.csv(total_sub, file=\"C:/Users/user/Desktop/total_sub.csv\")\n\ntotal<-tbl_df(read.csv(\"C:/Users/user/Desktop/total.csv\"))\ntotal_sub<-tbl_df(read.csv(\"C:/Users/user/Desktop/total_sub.csv\"))\nn_total<-total[,3:6]\nn_total_sub<-total_sub[,-1]\n\n#n_total_sub$opening_dt <- n_total_sub %>% filter(opening_dt_new != \"\")\n#n_total_sub$closing_dt <- n_total_sub %>% filter(opening_dt_new != \"\")\n\nn_total_sub$opening_dt_new <- as.POSIXct(n_total_sub$opening_dt_new)\nn_total_sub$closing_dt_new <- as.POSIXct(n_total_sub$closing_dt_new)\n\n\n\ntotal_2<- left_join(n_total, n_total_sub)\n\nrm(list=c('n_total', 'n_total_sub', 'total', 'total_sub'))\n\n#total_2 <- total_2 %>% filter(opening_dt_new != \"\")\n\n\ntotal_2$date_new <- as.POSIXct(total_2$date)\nclass(total_2$date_new)\ntotal_2$diff <- (total_2$date_new - total_2$opening_dt_new)\ntotal_2 <- total_2 %>% filter(!(diff<0))\n\n##### ????, ???Äµ??? ???? ????\n\nas <-total_2$opening_dt_new\ntotal_2$dtparts <- format(as, \"%H:%M:%S\")\ntotal_roll2<- total_2 %>% filter(dtparts>=\"12:00:00\")\ntotal_roll1<- total_2 %>% filter(dtparts<\"12:00:00\")\n\n##### ?Ñ¾? È¿?? ?Ð¼??? ?Ê¿??? ???? ????\n# roll 1\ntotal_roll1_1 <- total_roll1 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n())\n\ntotal_roll1_h12 <- total_roll1 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\ntotal_roll1_1 <- left_join(total_roll1_1, total_roll1_h12)\ntotal_roll1_h24 <- total_roll1 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\ntotal_roll1_1 <- left_join(total_roll1_1, total_roll1_h24)\ntotal_roll1_h36 <- total_roll1 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\ntotal_roll1_1 <- left_join(total_roll1_1, total_roll1_h36)\ntotal_roll1_h48 <- total_roll1 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\ntotal_roll1_1 <- left_join(total_roll1_1, total_roll1_h48)\ntotal_roll1_etc <- total_roll1 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\ntotal_roll1_1 <- left_join(total_roll1_1, total_roll1_etc)\n\ntotal_roll1_1$h12[is.na(total_roll1_1$h12)] <- 0\ntotal_roll1_1$h24[is.na(total_roll1_1$h24)] <- 0\ntotal_roll1_1$h36[is.na(total_roll1_1$h36)] <- 0\ntotal_roll1_1$h48[is.na(total_roll1_1$h48)] <- 0\ntotal_roll1_1$etc[is.na(total_roll1_1$etc)] <- 0\n\ntotal_roll1_h2436 <- total_roll1_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\ntotal_roll1_1<-left_join(total_roll1_1, total_roll1_h2436)\ntotal_roll1_h3648 <- total_roll1_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\ntotal_roll1_1<-left_join(total_roll1_1, total_roll1_h3648)\ntotal_roll1_h2448 <- total_roll1_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\ntotal_roll1_1<-left_join(total_roll1_1, total_roll1_h2448)\n\ntotal_roll1_mean <- total_roll1_1 %>% group_by() %>% mutate(mean=rollup_total/3) %>% select(rec_idx, mean)\ntotal_roll1_1<-left_join(total_roll1_1, total_roll1_mean)\n\ntotal_roll1_rate <- total_roll1_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\ntotal_roll1_1<-left_join(total_roll1_1, total_roll1_rate)\n\ntotal_roll1_1$rate[is.nan(total_roll1_1$rate) | is.infinite(total_roll1_1$rate)] <- 0\n\n\ntotal_roll1_opening<-total_roll1 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new,closing_dt_new)\n\ntotal_roll1_final <- left_join(total_roll1_opening, total_roll1_1)\ntotal_roll1_final<-unique(total_roll1_final)\n\nrm(list=c('total_roll1_1','total_roll1_h12','total_roll1_h24','total_roll1_h36','total_roll1_h48','total_roll1_h2436','total_roll1_h3648','total_roll1_h2448',\n          'total_roll1_mean','total_roll1_rate','total_roll1_opening'))\n\nwrite.csv(total_roll1_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/total_roll1_final.csv\")     \n\n\n# roll 2\ntotal_roll2_1 <- total_roll2 %>% group_by(rec_idx) %>% summarise(all_read_cnt=n()) \n\ntotal_roll2_h12 <- total_roll2 %>% filter(diff<43200) %>% group_by(rec_idx) %>% summarise(h12=n())\ntotal_roll2_1 <- left_join(total_roll2_1, total_roll2_h12)\ntotal_roll2_h24 <- total_roll2 %>% filter(diff>=43200 & diff<86400) %>% group_by(rec_idx) %>% summarise(h24=n())\ntotal_roll2_1 <- left_join(total_roll2_1, total_roll2_h24)\ntotal_roll2_h36 <- total_roll2 %>% filter(diff>=86400 & diff<129600) %>% group_by(rec_idx) %>% summarise(h36=n())\ntotal_roll2_1 <- left_join(total_roll2_1, total_roll2_h36)\ntotal_roll2_h48 <- total_roll2 %>% filter(diff>=129600 & diff<172800) %>% group_by(rec_idx) %>% summarise(h48=n())\ntotal_roll2_1 <- left_join(total_roll2_1, total_roll2_h48)\ntotal_roll2_etc <- total_roll2 %>% filter(diff>=172800) %>% group_by(rec_idx) %>% summarise(etc=n())\ntotal_roll2_1 <- left_join(total_roll2_1, total_roll2_etc)\n\ntotal_roll2_1$h12[is.na(total_roll2_1$h12)] <- 0\ntotal_roll2_1$h24[is.na(total_roll2_1$h24)] <- 0\ntotal_roll2_1$h36[is.na(total_roll2_1$h36)] <- 0\ntotal_roll2_1$h48[is.na(total_roll2_1$h48)] <- 0\ntotal_roll2_1$etc[is.na(total_roll2_1$etc)] <- 0\n\ntotal_roll2_h2436 <- total_roll2_1 %>% group_by() %>% mutate(rollup24_36=h24+h36) %>% select(rec_idx, rollup24_36)\ntotal_roll2_1<-left_join(total_roll2_1, total_roll2_h2436)\ntotal_roll2_h3648 <- total_roll2_1 %>% group_by() %>% mutate(rollup36_48=h36+h48) %>% select(rec_idx, rollup36_48)\ntotal_roll2_1<-left_join(total_roll2_1, total_roll2_h3648)\ntotal_roll2_h2448 <- total_roll2_1 %>% group_by() %>% mutate(rollup_total=h24+h36+h48) %>% select(rec_idx, rollup_total)\ntotal_roll2_1<-left_join(total_roll2_1, total_roll2_h2448)\n\ntotal_roll2_mean <- total_roll2_1 %>% group_by() %>% mutate(mean=rollup24_36/2) %>% select(rec_idx, mean)\ntotal_roll2_1<-left_join(total_roll2_1, total_roll2_mean)\n\ntotal_roll2_rate <- total_roll2_1 %>% group_by() %>% mutate(rate=(mean/h12)*100) %>% select(rec_idx, rate)\ntotal_roll2_1<-left_join(total_roll2_1, total_roll2_rate)\n\ntotal_roll2_1$rate[is.nan(total_roll2_1$rate) | is.infinite(total_roll2_1$rate)] <- 0\n\ntotal_roll2_opening<-total_roll2 %>% group_by(rec_idx, opening_dt_new, closing_dt_new) %>% select(opening_dt_new, closing_dt_new)\n\ntotal_roll2_final <- left_join(total_roll2_opening, total_roll2_1)\ntotal_roll2_final<-unique(total_roll2_final)\n\nrm(list=c('total_roll2_1','total_roll2_h12','total_roll2_h24','total_roll2_h36','total_roll2_h48','total_roll2_h2436','total_roll2_h3648','total_roll2_h2448',\n          'total_roll2_mean','total_roll2_rate','total_roll2_opening'))\n\nwrite.csv(total_roll2_final, file=\"D:/PJ_1_Á¶È¸??_????????_????_1505/[1]_rollupÈ¿???Ð¼?/[area]?Ð¼? ??????/total_roll2_final.csv\")     \n\n#####\ntotal_roll1_sub <- total_roll1_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12, etc, rollup_total)\ntotal_roll2_sub <- total_roll2_final %>% select(rec_idx, opening_dt_new, closing_dt_new, h12,etc, rollup24_36)\ncolnames(total_roll2_sub) <- c(\"rec_idx\", \"opening_dt_new\", \"closing_dt_new\", \"h12\",\"etc\",  \"rollup_total\") \n\ntotal_total <- rbind(total_roll1_sub, total_roll2_sub)\n\ntotal_total_1 <- total_total %>% group_by() %>% mutate(rate=(rollup_total/h12)*100) %>% select(rec_idx, rate)\ntotal_total <- left_join(total_total, total_total_1)\n\ntotal_total_2 <- total_total %>% filter(h12 != 0)\n\npng()\nhist(total_total_2$rate, xlim=c(0,400), breaks=800, freq = T)\ndev.off()\n\ntotal_total_2$all_diff <- total_total_2$closing_dt_new - total_total_2$opening_dt_new \ntotal_total_2$etc_2 <- total_total_2$etc/((floor(as.numeric(total_total_2$all_diff/86400))-1)*2)\ntotal_total_2[total_total_2$etc_2==\"Inf\",]$etc_2 <- total_total_2[total_total_2$etc_2==\"Inf\",]$etc\ntotal_total_2$etc_2 <- as.numeric(total_total_2$etc_2)\ntotal_total_2[is.na(total_total_2$etc_2)==T,]$etc_2 <- c(0)\ntotal_total_2$etc <- total_total_2$etc_2 \n\ntotal_total_2$rate[is.nan(total_total_2$rate) | is.infinite(total_total_2$rate)] <- 0\narea_raw_total <-total_total_2 %>% group_by() %>% summarise(rate_mean=mean(rate), rate_sd=sd(rate), h12_mean=mean(h12), h12_sd=sd(h12), rollup_total_mean=mean(rollup_total), rollup_total_sd=sd(rollup_total), etc_mean=mean(etc), etc_sd=sd(etc)) %>% mutate(region=101000)\narea_raw_total$rec_idx_count<-length(unique(total_total_2$rec_idx))\n",
    "created" : 1435040938282.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1221984960",
    "id" : "F8EF1C54",
    "lastKnownWriteTime" : 1434609789,
    "path" : "C:/Users/user/Desktop/Rollup_í¨ê³¼ë¶ì_20150618.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "type" : "r_source"
}